
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Baukis-Kai project.">
      
      
        <meta name="author" content="Project Team">
      
      
      
        <link rel="prev" href="../20170206/">
      
      
        <link rel="next" href="../20170209/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>20170207 - Baukis-Kai</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2017-02-07" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Baukis-Kai" class="md-header__button md-logo" aria-label="Baukis-Kai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Baukis-Kai
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              20170207
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/baukis-kai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    baukis-kai
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9/" class="md-tabs__link">
        
  
  
    
  
  UseCases

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E6%A6%82%E8%A6%81/" class="md-tabs__link">
        
  
  
    
  
  Architecture

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%AE%9F%E8%A3%85/" class="md-tabs__link">
        
  
  
    
  
  Implementation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E7%94%A8%E8%AA%9E%E9%9B%86/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../20170110/" class="md-tabs__link">
          
  
  
  Journal

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Baukis-Kai" class="md-nav__button md-logo" aria-label="Baukis-Kai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Baukis-Kai
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/baukis-kai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    baukis-kai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UseCases
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E6%A6%82%E8%A6%81/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%AE%9F%E8%A3%85/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%94%A8%E8%AA%9E%E9%9B%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Journal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Journal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170110
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170111/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170111
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170114/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170114
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170116/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170116
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170117/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170117
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170118/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170118
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170120/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170120
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170121/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170121
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170123/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170123
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170124/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170124
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170126/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170126
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170127/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170127
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170128/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170128
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170130/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170130
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170131/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170131
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170202
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170203
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170204
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170206/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170206
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    20170207
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    20170207
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      概要
    </span>
  </a>
  
    <nav class="md-nav" aria-label="概要">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      実装内容の説明
    </span>
  </a>
  
    <nav class="md-nav" aria-label="実装内容の説明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      顧客検索機能
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      検索条件の拡張
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      アーキテクチャとの関連
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      ユースケースとの関連
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4164c10" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 4164c10
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 4164c10">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#f613d25" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: f613d25
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: f613d25">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#47e1f46" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 47e1f46
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 47e1f46">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a474c1a" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: a474c1a
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: a474c1a">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c07f4d4" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: c07f4d4
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: c07f4d4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5d85223" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 5d85223
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 5d85223">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32560b5" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 32560b5
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 32560b5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#e18b0a1" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: e18b0a1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: e18b0a1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#be04433" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: be04433
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: be04433">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#e6b074a" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: e6b074a
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: e6b074a">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#419b461" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 419b461
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 419b461">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fe94bbc" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: fe94bbc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: fe94bbc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3d93787" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 3d93787
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 3d93787">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0322718" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 0322718
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 0322718">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1131f65" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 1131f65
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 1131f65">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ff3e2e2" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: ff3e2e2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: ff3e2e2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#20fc0ef" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 20fc0ef
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 20fc0ef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#052c0ad" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 052c0ad
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 052c0ad">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170209/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170209
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170210/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170210
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170213/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170213
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170214/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170214
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170216/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170216
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170220/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170220
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170317/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170317
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170318/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170318
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170325/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170325
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170327/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170327
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170328/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170328
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250424/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250424
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250510/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250510
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250607/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250607
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250608/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250608
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250609/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250609
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250610/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250610
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250611/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250611
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250612/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250612
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="2017-02-07">作業履歴 2017-02-07<a class="headerlink" href="#2017-02-07" title="Permanent link">&para;</a></h1>
<h2 id="_1">概要<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>2017-02-07の作業内容をまとめています。この日は主に「顧客検索機能」の実装を行いました。</p>
<h3 id="_2">実装内容の説明<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<h4 id="_3">顧客検索機能<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>職員が顧客情報を効率的に検索できるよう、複数の条件を組み合わせた検索機能を実装しました。検索条件には氏名、メールアドレス、電話番号、性別、郵便番号、住所などが含まれます。特に電話番号の下4桁による検索機能は、顧客からの問い合わせ時に素早く顧客を特定するのに役立ちます。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjY3NXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NjcwcHg7aGVpZ2h0OjY3NXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDY3MCA2NzUiIHdpZHRoPSI2NzBweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzkwMTU7JiMyMzQ1ODsmIzI2OTA4OyYjMzIwMzQ7JiMyNzIzMTsmIzMzMDIxOyYjMTIzOTg7JiMyMzQ1NTsmIzM1MDEzOzwvdGl0bGU+PGRlZnMvPjxnPjxnIGNsYXNzPSJ0aXRsZSIgZGF0YS1zb3VyY2UtbGluZT0iMSI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNS45OTk1IiB4PSIyNjUuNDc4NyIgeT0iMjIuOTk1MSI+JiMzOTAxNTsmIzIzNDU4OyYjMjY5MDg7JiMzMjAzNDsmIzI3MjMxOyYjMzMwMjE7JiMxMjM5ODsmIzIzNDU1OyYjMzUwMTM7PC90ZXh0PjwvZz48IS0tY2xhc3MgU3RhZmY6OkN1c3RvbWVyc0NvbnRyb2xsZXItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iU3RhZmYuLkN1c3RvbWVyc0NvbnRyb2xsZXIiIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iZW50aXR5X1N0YWZmLi5DdXN0b21lcnNDb250cm9sbGVyIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjgwLjU5MzgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjIxOC43MTY4IiB4PSIzMzEuODYiIHk9IjQ0LjI5NjkiLz48ZWxsaXBzZSBjeD0iMzQ2Ljg2IiBjeT0iNjAuMjk2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMzQ5LjgyODgsNjUuOTM3NSBRMzQ5LjI1MDYsNjYuMjM0NCAzNDguNjEsNjYuMzc1IFEzNDcuOTY5NCw2Ni41MzEzIDM0Ny4yNjYzLDY2LjUzMTMgUTM0NC43NjYzLDY2LjUzMTMgMzQzLjQzODEsNjQuODkwNiBRMzQyLjEyNTYsNjMuMjM0NCAzNDIuMTI1Niw2MC4xMDk0IFEzNDIuMTI1Niw1Ni45ODQ0IDM0My40MzgxLDU1LjMyODEgUTM0NC43NjYzLDUzLjY3MTkgMzQ3LjI2NjMsNTMuNjcxOSBRMzQ3Ljk2OTQsNTMuNjcxOSAzNDguNjEsNTMuODI4MSBRMzQ5LjI2NjMsNTMuOTg0NCAzNDkuODI4OCw1NC4yODEzIEwzNDkuODI4OCw1NyBRMzQ5LjIwMzgsNTYuNDIxOSAzNDguNjEsNTYuMTU2MyBRMzQ4LjAxNjMsNTUuODc1IDM0Ny4zOTEzLDU1Ljg3NSBRMzQ2LjA0NzUsNTUuODc1IDM0NS4zNiw1Ni45NTMxIFEzNDQuNjcyNSw1OC4wMTU2IDM0NC42NzI1LDYwLjEwOTQgUTM0NC42NzI1LDYyLjIwMzEgMzQ1LjM2LDYzLjI4MTMgUTM0Ni4wNDc1LDY0LjM0MzggMzQ3LjM5MTMsNjQuMzQzOCBRMzQ4LjAxNjMsNjQuMzQzOCAzNDguNjEsNjQuMDc4MSBRMzQ5LjIwMzgsNjMuNzk2OSAzNDkuODI4OCw2My4yMTg4IEwzNDkuODI4OCw2NS45Mzc1IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTg2LjcxNjgiIHg9IjM2MC44NiIgeT0iNjUuMTQzNiI+U3RhZmY6OkN1c3RvbWVyc0NvbnRyb2xsZXI8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMzMyLjg2IiB4Mj0iNTQ5LjU3NjgiIHkxPSI3Ni4yOTY5IiB5Mj0iNzYuMjk2OSIvPjxlbGxpcHNlIGN4PSIzNDIuODYiIGN5PSI4OS45NDUzIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzOC41NDc5IiB4PSIzNTEuODYiIHk9IjkzLjI5MiI+aW5kZXg8L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMzM5Ljg2IiB5PSIxMDMuMjQyMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNi41NDQ5IiB4PSIzNTEuODYiIHk9IjEwOS41ODg5Ij5zZWFyY2hfcGFyYW1zPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjMzMi44NiIgeDI9IjU0OS41NzY4IiB5MT0iMTE2Ljg5MDYiIHkyPSIxMTYuODkwNiIvPjwvZz48IS0tY2xhc3MgU3RhZmY6OkN1c3RvbWVyU2VhcmNoRm9ybS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJTdGFmZi4uQ3VzdG9tZXJTZWFyY2hGb3JtIiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9TdGFmZi4uQ3VzdG9tZXJTZWFyY2hGb3JtIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIxMC45Njg4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMjYuNjY3IiB4PSIzMjcuODkiIHk9IjIwMS44OTY5Ii8+PGVsbGlwc2UgY3g9IjM0Mi44OSIgY3k9IjIxNy44OTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0zNDUuODU4OCwyMjMuNTM3NSBRMzQ1LjI4MDYsMjIzLjgzNDQgMzQ0LjY0LDIyMy45NzUgUTM0My45OTk0LDIyNC4xMzEzIDM0My4yOTYzLDIyNC4xMzEzIFEzNDAuNzk2MywyMjQuMTMxMyAzMzkuNDY4MSwyMjIuNDkwNiBRMzM4LjE1NTYsMjIwLjgzNDQgMzM4LjE1NTYsMjE3LjcwOTQgUTMzOC4xNTU2LDIxNC41ODQ0IDMzOS40NjgxLDIxMi45MjgxIFEzNDAuNzk2MywyMTEuMjcxOSAzNDMuMjk2MywyMTEuMjcxOSBRMzQzLjk5OTQsMjExLjI3MTkgMzQ0LjY0LDIxMS40MjgxIFEzNDUuMjk2MywyMTEuNTg0NCAzNDUuODU4OCwyMTEuODgxMyBMMzQ1Ljg1ODgsMjE0LjYgUTM0NS4yMzM4LDIxNC4wMjE5IDM0NC42NCwyMTMuNzU2MyBRMzQ0LjA0NjMsMjEzLjQ3NSAzNDMuNDIxMywyMTMuNDc1IFEzNDIuMDc3NSwyMTMuNDc1IDM0MS4zOSwyMTQuNTUzMSBRMzQwLjcwMjUsMjE1LjYxNTYgMzQwLjcwMjUsMjE3LjcwOTQgUTM0MC43MDI1LDIxOS44MDMxIDM0MS4zOSwyMjAuODgxMyBRMzQyLjA3NzUsMjIxLjk0MzggMzQzLjQyMTMsMjIxLjk0MzggUTM0NC4wNDYzLDIyMS45NDM4IDM0NC42NCwyMjEuNjc4MSBRMzQ1LjIzMzgsMjIxLjM5NjkgMzQ1Ljg1ODgsMjIwLjgxODggTDM0NS44NTg4LDIyMy41Mzc1IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTk0LjY2NyIgeD0iMzU2Ljg5IiB5PSIyMjIuNzQzNiI+U3RhZmY6OkN1c3RvbWVyU2VhcmNoRm9ybTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzMjguODkiIHgyPSI1NTMuNTU3IiB5MT0iMjMzLjg5NjkiIHkyPSIyMzMuODk2OSIvPjxlbGxpcHNlIGN4PSIzMzguODkiIGN5PSIyNDcuNTQ1MyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODkuOTEzMSIgeD0iMzQ3Ljg5IiB5PSIyNTAuODkyIj5mYW1pbHlfbmFtZTwvdGV4dD48ZWxsaXBzZSBjeD0iMzM4Ljg5IiBjeT0iMjYzLjg0MjIiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg1LjI1MSIgeD0iMzQ3Ljg5IiB5PSIyNjcuMTg4OSI+Z2l2ZW5fbmFtZTwvdGV4dD48ZWxsaXBzZSBjeD0iMzM4Ljg5IiBjeT0iMjgwLjEzOTEiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMS4wNTE4IiB4PSIzNDcuODkiIHk9IjI4My40ODU3Ij5mYW1pbHlfbmFtZV9rYW5hPC90ZXh0PjxlbGxpcHNlIGN4PSIzMzguODkiIGN5PSIyOTYuNDM1OSIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI2LjM4OTYiIHg9IjM0Ny44OSIgeT0iMjk5Ljc4MjYiPmdpdmVuX25hbWVfa2FuYTwvdGV4dD48ZWxsaXBzZSBjeD0iMzM4Ljg5IiBjeT0iMzEyLjczMjgiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM4LjYwOTQiIHg9IjM0Ny44OSIgeT0iMzE2LjA3OTUiPmVtYWlsPC90ZXh0PjxlbGxpcHNlIGN4PSIzMzguODkiIGN5PSIzMjkuMDI5NyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA1LjQ1MTIiIHg9IjM0Ny44OSIgeT0iMzMyLjM3NjQiPnBob25lX251bWJlcjwvdGV4dD48ZWxsaXBzZSBjeD0iMzM4Ljg5IiBjeT0iMzQ1LjMyNjYiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ5LjYyODkiIHg9IjM0Ny44OSIgeT0iMzQ4LjY3MzIiPmdlbmRlcjwvdGV4dD48ZWxsaXBzZSBjeD0iMzM4Ljg5IiBjeT0iMzYxLjYyMzQiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjQ2NjgiIHg9IjM0Ny44OSIgeT0iMzY0Ljk3MDEiPnBvc3RhbF9jb2RlPC90ZXh0PjxlbGxpcHNlIGN4PSIzMzguODkiIGN5PSIzNzcuOTIwMyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA1LjcxMDkiIHg9IjM0Ny44OSIgeT0iMzgxLjI2NyI+bGFzdF9mb3VyX2RpZ2l0czwvdGV4dD48ZWxsaXBzZSBjeD0iMzM4Ljg5IiBjeT0iMzk0LjIxNzIiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ2LjgxMjUiIHg9IjM0Ny44OSIgeT0iMzk3LjU2MzkiPnNlYXJjaDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzMjguODkiIHgyPSI1NTMuNTU3IiB5MT0iNDA0Ljg2NTYiIHkyPSI0MDQuODY1NiIvPjwvZz48IS0tY2xhc3MgQ3VzdG9tZXItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iQ3VzdG9tZXIiIGRhdGEtc291cmNlLWxpbmU9IjIxIiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9DdXN0b21lciI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxNzguMzc1IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTcuMDUxOCIgeD0iMzYyLjY5IiB5PSI0ODkuODU2OSIvPjxlbGxpcHNlIGN4PSI0MDMuMzYxNSIgY3k9IjUwNS44NTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik00MDYuMzMwMyw1MTEuNDk3NSBRNDA1Ljc1MjIsNTExLjc5NDQgNDA1LjExMTUsNTExLjkzNSBRNDA0LjQ3MDksNTEyLjA5MTMgNDAzLjc2NzgsNTEyLjA5MTMgUTQwMS4yNjc4LDUxMi4wOTEzIDM5OS45Mzk3LDUxMC40NTA2IFEzOTguNjI3Miw1MDguNzk0NCAzOTguNjI3Miw1MDUuNjY5NCBRMzk4LjYyNzIsNTAyLjU0NDQgMzk5LjkzOTcsNTAwLjg4ODEgUTQwMS4yNjc4LDQ5OS4yMzE5IDQwMy43Njc4LDQ5OS4yMzE5IFE0MDQuNDcwOSw0OTkuMjMxOSA0MDUuMTExNSw0OTkuMzg4MSBRNDA1Ljc2NzgsNDk5LjU0NDQgNDA2LjMzMDMsNDk5Ljg0MTMgTDQwNi4zMzAzLDUwMi41NiBRNDA1LjcwNTMsNTAxLjk4MTkgNDA1LjExMTUsNTAxLjcxNjMgUTQwNC41MTc4LDUwMS40MzUgNDAzLjg5MjgsNTAxLjQzNSBRNDAyLjU0OSw1MDEuNDM1IDQwMS44NjE1LDUwMi41MTMxIFE0MDEuMTc0LDUwMy41NzU2IDQwMS4xNzQsNTA1LjY2OTQgUTQwMS4xNzQsNTA3Ljc2MzEgNDAxLjg2MTUsNTA4Ljg0MTMgUTQwMi41NDksNTA5LjkwMzggNDAzLjg5MjgsNTA5LjkwMzggUTQwNC41MTc4LDUwOS45MDM4IDQwNS4xMTE1LDUwOS42MzgxIFE0MDUuNzA1Myw1MDkuMzU2OSA0MDYuMzMwMyw1MDguNzc4OCBMNDA2LjMzMDMsNTExLjQ5NzUgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OC4wMDM5IiB4PSI0MjMuMDY2MyIgeT0iNTEwLjcwMzYiPkN1c3RvbWVyPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjM2My42OSIgeDI9IjUxOC43NDE4IiB5MT0iNTIxLjg1NjkiIHkyPSI1MjEuODU2OSIvPjxlbGxpcHNlIGN4PSIzNzMuNjkiIGN5PSI1MzUuNTA1MyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIuNzc2NCIgeD0iMzgyLjY5IiB5PSI1MzguODUyIj5pZDwvdGV4dD48ZWxsaXBzZSBjeD0iMzczLjY5IiBjeT0iNTUxLjgwMjIiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM4LjYwOTQiIHg9IjM4Mi42OSIgeT0iNTU1LjE0ODkiPmVtYWlsPC90ZXh0PjxlbGxpcHNlIGN4PSIzNzMuNjkiIGN5PSI1NjguMDk5MSIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODkuOTEzMSIgeD0iMzgyLjY5IiB5PSI1NzEuNDQ1NyI+ZmFtaWx5X25hbWU8L3RleHQ+PGVsbGlwc2UgY3g9IjM3My42OSIgY3k9IjU4NC4zOTU5IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4NS4yNTEiIHg9IjM4Mi42OSIgeT0iNTg3Ljc0MjYiPmdpdmVuX25hbWU8L3RleHQ+PGVsbGlwc2UgY3g9IjM3My42OSIgY3k9IjYwMC42OTI4IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzEuMDUxOCIgeD0iMzgyLjY5IiB5PSI2MDQuMDM5NSI+ZmFtaWx5X25hbWVfa2FuYTwvdGV4dD48ZWxsaXBzZSBjeD0iMzczLjY5IiBjeT0iNjE2Ljk4OTciIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNi4zODk2IiB4PSIzODIuNjkiIHk9IjYyMC4zMzY0Ij5naXZlbl9uYW1lX2thbmE8L3RleHQ+PGVsbGlwc2UgY3g9IjM3My42OSIgY3k9IjYzMy4yODY2IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OS42Mjg5IiB4PSIzODIuNjkiIHk9IjYzNi42MzMyIj5nZW5kZXI8L3RleHQ+PGVsbGlwc2UgY3g9IjM3My42OSIgY3k9IjY0OS41ODM0IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1OC42NDU1IiB4PSIzODIuNjkiIHk9IjY1Mi45MzAxIj5iaXJ0aGRheTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzNjMuNjkiIHgyPSI1MTguNzQxOCIgeTE9IjY2MC4yMzE5IiB5Mj0iNjYwLjIzMTkiLz48L2c+PCEtLWNsYXNzIEFkZHJlc3MtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iQWRkcmVzcyIgZGF0YS1zb3VyY2UtbGluZT0iMzIiIGRhdGEtdWlkPSJlbnQwMDA1IiBpZD0iZW50aXR5X0FkZHJlc3MiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iOTYuODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTA5LjQ2NjgiIHg9IjU1NC40OSIgeT0iNTMwLjYwNjkiLz48ZWxsaXBzZSBjeD0iNTc5LjAxMTYiIGN5PSI1NDYuNjA2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNNTgxLjk4MDQsNTUyLjI0NzUgUTU4MS40MDIzLDU1Mi41NDQ0IDU4MC43NjE2LDU1Mi42ODUgUTU4MC4xMjEsNTUyLjg0MTMgNTc5LjQxNzksNTUyLjg0MTMgUTU3Ni45MTc5LDU1Mi44NDEzIDU3NS41ODk4LDU1MS4yMDA2IFE1NzQuMjc3Myw1NDkuNTQ0NCA1NzQuMjc3Myw1NDYuNDE5NCBRNTc0LjI3NzMsNTQzLjI5NDQgNTc1LjU4OTgsNTQxLjYzODEgUTU3Ni45MTc5LDUzOS45ODE5IDU3OS40MTc5LDUzOS45ODE5IFE1ODAuMTIxLDUzOS45ODE5IDU4MC43NjE2LDU0MC4xMzgxIFE1ODEuNDE3OSw1NDAuMjk0NCA1ODEuOTgwNCw1NDAuNTkxMyBMNTgxLjk4MDQsNTQzLjMxIFE1ODEuMzU1NCw1NDIuNzMxOSA1ODAuNzYxNiw1NDIuNDY2MyBRNTgwLjE2NzksNTQyLjE4NSA1NzkuNTQyOSw1NDIuMTg1IFE1NzguMTk5MSw1NDIuMTg1IDU3Ny41MTE2LDU0My4yNjMxIFE1NzYuODI0MSw1NDQuMzI1NiA1NzYuODI0MSw1NDYuNDE5NCBRNTc2LjgyNDEsNTQ4LjUxMzEgNTc3LjUxMTYsNTQ5LjU5MTMgUTU3OC4xOTkxLDU1MC42NTM4IDU3OS41NDI5LDU1MC42NTM4IFE1ODAuMTY3OSw1NTAuNjUzOCA1ODAuNzYxNiw1NTAuMzg4MSBRNTgxLjM1NTQsNTUwLjEwNjkgNTgxLjk4MDQsNTQ5LjUyODggTDU4MS45ODA0LDU1Mi4yNDc1IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTYuMzA3NiIgeD0iNTk1LjEyNzUiIHk9IjU1MS40NTM2Ij5BZGRyZXNzPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjU1NS40OSIgeDI9IjY2Mi45NTY4IiB5MT0iNTYyLjYwNjkiIHkyPSI1NjIuNjA2OSIvPjxlbGxpcHNlIGN4PSI1NjUuNDkiIGN5PSI1NzYuMjU1MyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuNDY2OCIgeD0iNTc0LjQ5IiB5PSI1NzkuNjAyIj5wb3N0YWxfY29kZTwvdGV4dD48ZWxsaXBzZSBjeD0iNTY1LjQ5IiBjeT0iNTkyLjU1MjIiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjczLjIyNjYiIHg9IjU3NC40OSIgeT0iNTk1Ljg5ODkiPnByZWZlY3R1cmU8L3RleHQ+PGVsbGlwc2UgY3g9IjU2NS40OSIgY3k9IjYwOC44NDkxIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNS4zNjEzIiB4PSI1NzQuNDkiIHk9IjYxMi4xOTU3Ij5jaXR5PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjU1NS40OSIgeDI9IjY2Mi45NTY4IiB5MT0iNjE5LjQ5NzUiIHkyPSI2MTkuNDk3NSIvPjwvZz48IS0tY2xhc3MgUGhvbmUtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iUGhvbmUiIGRhdGEtc291cmNlLWxpbmU9IjM4IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImVudGl0eV9QaG9uZSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI5Ni44OTA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTIuNDM3NSIgeD0iNyIgeT0iNTMwLjYwNjkiLz48ZWxsaXBzZSBjeD0iNTcuMjg1MiIgY3k9IjU0Ni42MDY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik02MC4yNTM5LDU1Mi4yNDc1IFE1OS42NzU4LDU1Mi41NDQ0IDU5LjAzNTIsNTUyLjY4NSBRNTguMzk0NSw1NTIuODQxMyA1Ny42OTE0LDU1Mi44NDEzIFE1NS4xOTE0LDU1Mi44NDEzIDUzLjg2MzMsNTUxLjIwMDYgUTUyLjU1MDgsNTQ5LjU0NDQgNTIuNTUwOCw1NDYuNDE5NCBRNTIuNTUwOCw1NDMuMjk0NCA1My44NjMzLDU0MS42MzgxIFE1NS4xOTE0LDUzOS45ODE5IDU3LjY5MTQsNTM5Ljk4MTkgUTU4LjM5NDUsNTM5Ljk4MTkgNTkuMDM1Miw1NDAuMTM4MSBRNTkuNjkxNCw1NDAuMjk0NCA2MC4yNTM5LDU0MC41OTEzIEw2MC4yNTM5LDU0My4zMSBRNTkuNjI4OSw1NDIuNzMxOSA1OS4wMzUyLDU0Mi40NjYzIFE1OC40NDE0LDU0Mi4xODUgNTcuODE2NCw1NDIuMTg1IFE1Ni40NzI3LDU0Mi4xODUgNTUuNzg1Miw1NDMuMjYzMSBRNTUuMDk3Nyw1NDQuMzI1NiA1NS4wOTc3LDU0Ni40MTk0IFE1NS4wOTc3LDU0OC41MTMxIDU1Ljc4NTIsNTQ5LjU5MTMgUTU2LjQ3MjcsNTUwLjY1MzggNTcuODE2NCw1NTAuNjUzOCBRNTguNDQxNCw1NTAuNjUzOCA1OS4wMzUyLDU1MC4zODgxIFE1OS42Mjg5LDU1MC4xMDY5IDYwLjI1MzksNTQ5LjUyODggTDYwLjI1MzksNTUyLjI0NzUgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0My4zNjcyIiB4PSI3Ny43ODUyIiB5PSI1NTEuNDUzNiI+UGhvbmU8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjE1OC40Mzc1IiB5MT0iNTYyLjYwNjkiIHkyPSI1NjIuNjA2OSIvPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjU3Ni4yNTUzIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NC42Mzk2IiB4PSIyNyIgeT0iNTc5LjYwMiI+bnVtYmVyPC90ZXh0PjxlbGxpcHNlIGN4PSIxOCIgY3k9IjU5Mi41NTIyIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjYuNDM3NSIgeD0iMjciIHk9IjU5NS44OTg5Ij5udW1iZXJfZm9yX2luZGV4PC90ZXh0PjxlbGxpcHNlIGN4PSIxOCIgY3k9IjYwOC44NDkxIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDUuNzEwOSIgeD0iMjciIHk9IjYxMi4xOTU3Ij5sYXN0X2ZvdXJfZGlnaXRzPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjgiIHgyPSIxNTguNDM3NSIgeTE9IjYxOS40OTc1IiB5Mj0iNjE5LjQ5NzUiLz48L2c+PHBhdGggZD0iTTE5NC41OCw1NTMuOTE2OSBMMTk0LjU4LDU3MC4wNDk3IEwxMzIuNzEwOSw2MDcuMzQ5MSBMMTk0LjU4LDU3OC4wNDk3IEwxOTQuNTgsNTk0LjE4MjUgQTAsMCAwIDAgMCAxOTQuNTgsNTk0LjE4MjUgTDMyNy44NTExLDU5NC4xODI1IEEwLDAgMCAwIDAgMzI3Ljg1MTEsNTk0LjE4MjUgTDMyNy44NTExLDU2My45MTY5IEwzMTcuODUxMSw1NTMuOTE2OSBMMTk0LjU4LDU1My45MTY5IEEwLDAgMCAwIDAgMTk0LjU4LDU1My45MTY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMzE3Ljg1MTEsNTUzLjkxNjkgTDMxNy44NTExLDU2My45MTY5IEwzMjcuODUxMSw1NjMuOTE2OSBMMzE3Ljg1MTEsNTUzLjkxNjkiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMi4yNzExIiB4PSIyMDAuNTgiIHk9IjU3MC45ODM4Ij4mIzM4NjUxOyYjMzU0NDE7JiMzMDA1ODsmIzIxNDk1OyYjMTIzOTg7JiMxOTk3OTs0JiMyNjY4OTsmIzEyNDM0OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC4wMDAxIiB4PSIyMDAuNTgiIHk9IjU4Ni4xMTY2Ij4mIzI2OTA4OyYjMzIwMzQ7JiMyOTk5MjsmIzEyMzk1OyYjMjA0NDU7JiMyMzM4NDs8L3RleHQ+PCEtLWxpbmsgU3RhZmY6OkN1c3RvbWVyc0NvbnRyb2xsZXIgdG8gU3RhZmY6OkN1c3RvbWVyU2VhcmNoRm9ybS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJTdGFmZi4uQ3VzdG9tZXJzQ29udHJvbGxlciIgZGF0YS1lbnRpdHktMj0iU3RhZmYuLkN1c3RvbWVyU2VhcmNoRm9ybSIgZGF0YS1zb3VyY2UtbGluZT0iNDQiIGRhdGEtdWlkPSJsbms3IiBpZD0ibGlua19TdGFmZi4uQ3VzdG9tZXJzQ29udHJvbGxlcl9TdGFmZi4uQ3VzdG9tZXJTZWFyY2hGb3JtIj48cGF0aCBjb2RlTGluZT0iNDQiIGQ9Ik00NDEuMjIsMTI1LjMyNjkgQzQ0MS4yMiwxNDYuNzk2OSA0NDEuMjIsMTY4LjQzNjkgNDQxLjIyLDE5NS42MTY5IiBmaWxsPSJub25lIiBpZD0iU3RhZmY6OkN1c3RvbWVyc0NvbnRyb2xsZXItdG8tU3RhZmY6OkN1c3RvbWVyU2VhcmNoRm9ybSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDQxLjIyLDIwMS42MTY5LDQ0NS4yMiwxOTIuNjE2OSw0NDEuMjIsMTk2LjYxNjksNDM3LjIyLDE5Mi42MTY5LDQ0MS4yMiwyMDEuNjE2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSI0NDIuMjIiIHk9IjE2Ny45NjM4Ij4mIzIwMzUxOyYjMjk5OTI7PC90ZXh0PjwvZz48IS0tbGluayBTdGFmZjo6Q3VzdG9tZXJTZWFyY2hGb3JtIHRvIEN1c3RvbWVyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IlN0YWZmLi5DdXN0b21lclNlYXJjaEZvcm0iIGRhdGEtZW50aXR5LTI9IkN1c3RvbWVyIiBkYXRhLXNvdXJjZS1saW5lPSI0NSIgZGF0YS11aWQ9ImxuazgiIGlkPSJsaW5rX1N0YWZmLi5DdXN0b21lclNlYXJjaEZvcm1fQ3VzdG9tZXIiPjxwYXRoIGNvZGVMaW5lPSI0NSIgZD0iTTQ0MS4yMiw0MTMuMDI2OSBDNDQxLjIyLDQzOC4zNDY5IDQ0MS4yMiw0NTkuMTU2OSA0NDEuMjIsNDgzLjY0NjkiIGZpbGw9Im5vbmUiIGlkPSJTdGFmZjo6Q3VzdG9tZXJTZWFyY2hGb3JtLXRvLUN1c3RvbWVyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0NDEuMjIsNDg5LjY0NjksNDQ1LjIyLDQ4MC42NDY5LDQ0MS4yMiw0ODQuNjQ2OSw0MzcuMjIsNDgwLjY0NjksNDQxLjIyLDQ4OS42NDY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjYiIHg9IjQ0Mi4yMiIgeT0iNDU1LjkyMzgiPiYjMjY5MDg7JiMzMjAzNDs8L3RleHQ+PC9nPjwhLS1saW5rIFN0YWZmOjpDdXN0b21lclNlYXJjaEZvcm0gdG8gQWRkcmVzcy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJTdGFmZi4uQ3VzdG9tZXJTZWFyY2hGb3JtIiBkYXRhLWVudGl0eS0yPSJBZGRyZXNzIiBkYXRhLXNvdXJjZS1saW5lPSI0NiIgZGF0YS11aWQ9ImxuazkiIGlkPSJsaW5rX1N0YWZmLi5DdXN0b21lclNlYXJjaEZvcm1fQWRkcmVzcyI+PHBhdGggY29kZUxpbmU9IjQ2IiBkPSJNNTA2LjQxLDQxMy4wMjY5IEM1MzEuNTksNDUzLjQ0NjkgNTU1Ljk3NzUsNDkyLjU4NDIgNTc2LjIxNzUsNTI1LjA3NDIiIGZpbGw9Im5vbmUiIGlkPSJTdGFmZjo6Q3VzdG9tZXJTZWFyY2hGb3JtLXRvLUFkZHJlc3MiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU3OS4zOSw1MzAuMTY2OSw1NzguMDI2Myw1MjAuNDEyOSw1NzYuNzQ2Miw1MjUuOTIzLDU3MS4yMzYxLDUyNC42NDI5LDU3OS4zOSw1MzAuMTY2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSI1MzcuMjIiIHk9IjQ1NS45MjM4Ij4mIzI2OTA4OyYjMzIwMzQ7PC90ZXh0PjwvZz48IS0tbGluayBTdGFmZjo6Q3VzdG9tZXJTZWFyY2hGb3JtIHRvIFBob25lLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IlN0YWZmLi5DdXN0b21lclNlYXJjaEZvcm0iIGRhdGEtZW50aXR5LTI9IlBob25lIiBkYXRhLXNvdXJjZS1saW5lPSI0NyIgZGF0YS11aWQ9ImxuazEwIiBpZD0ibGlua19TdGFmZi4uQ3VzdG9tZXJTZWFyY2hGb3JtX1Bob25lIj48cGF0aCBjb2RlTGluZT0iNDciIGQ9Ik0zMjcuNDEsMzgxLjEyNjkgQzI3OS44MSw0MTIuOTQ2OSAyMjQuNjYsNDUxLjY2NjkgMTc3LjIyLDQ4OS44NTY5IEMxNjEuNzEsNTAyLjM0NjkgMTQ5Ljk4NjcsNTEyLjcwMiAxMzUuNTk2Nyw1MjYuMjYyIiBmaWxsPSJub25lIiBpZD0iU3RhZmY6OkN1c3RvbWVyU2VhcmNoRm9ybS10by1QaG9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTMxLjIzLDUzMC4zNzY5LDE0MC41MjMzLDUyNy4xMTU4LDEzNC44Njg5LDUyNi45NDc4LDEzNS4wMzY4LDUyMS4yOTM1LDEzMS4yMyw1MzAuMzc2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSIyMzQuMjIiIHk9IjQ1NS45MjM4Ij4mIzI2OTA4OyYjMzIwMzQ7PC90ZXh0PjwvZz48IS0tU1JDPVtmUEJESWlEMDU4TnR5bklwM3pzdm9hQUdXY2tYM3AyQ29LcXBjQ280Y09iT1llaWdoYm04ZVkyZWI1UDFncldHMTBLZlZQV3NfTmFCOXF0STVhakxTN003a1VWU2QyenREREMxdTZkaDhVY3NIX1N0dXhWc2dERVM3RlM2Wk14SVJLeGtKWDFvMGdlS2hjWmdVUlBUWmZLTThLWEw1Ym5CNEdHV1NIclBaQmptVzRlQWc3SHk0YjU5R3VLRXJ0V2hDek1zYTY1Z3pNWjhXWGhYRDBIYUxUYS15Rm95cjIxeGJERmJSZHUxOE1LMWlZOVZTMjB5M2RUMTZYTU9DQVA2R2NhUTQ0VXVQZlo5ZU9hZE9hYlNMY0xROElsQmtXWFBmOWxYa0ZGUF91Yk45RGJiS2xpa2hJcS1qa013NGFvalZ1aVBJVjMwcVI0cVB1VmY5U1RFb2ZaZzJ5b2k2WVA5aWgtX29jWkNGd29qTERmU2xuYVIzdGx6eVNLWk1oLXhyNXpTc3BYeEZCXzhTLW1fZ2NWOFNvdFlHV0VNaEVmaEJCb3lRUXltSnd5Xzl2dE55VUxKU2xQazdsN211dEhacjZlQ1ppdkhEaVNtM0hoRm1fdmp5ZEE1cDd2bUVsT0JdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h4 id="_4">検索条件の拡張<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>基本的な検索機能に加えて、以下の検索条件を追加実装しました：
1. 性別による検索
2. 郵便番号による検索
3. 電話番号の下4桁による検索</p>
<p>特に電話番号の下4桁検索は、顧客が自分の電話番号の下4桁だけを覚えている場合に便利な機能です。</p>
<h3 id="_5">アーキテクチャとの関連<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>この実装は、<a href="../../%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E6%A6%82%E8%A6%81/">アーキテクチャ概要</a>の「5. 主要なデータモデル」および「7.2 フォームオブジェクト」セクションに関連しています。特に以下の部分を実現するものです：</p>
<div class="highlight"><pre><span></span><code>Customer ||--o{ Phone
Customer ||--o{ HomeAddress
Customer ||--o{ WorkAddress
</code></pre></div>
<p>フォームオブジェクトパターンを使用して、検索フォームの入力値の処理と検索ロジックをカプセル化しています。</p>
<h3 id="_6">ユースケースとの関連<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>この実装は、<a href="../../%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9/">ユースケース</a>の「3.2. 顧客管理」セクションに記載されている以下のユースケースを実現するものです：</p>
<ul>
<li>S-005: 顧客情報検索</li>
</ul>
<p>ユースケース説明：</p>
<blockquote>
<p>職員が顧客情報を検索する</p>
<p>基本フロー：
1. 顧客検索フォームにアクセス
2. 検索条件（名前、メールアドレス、電話番号など）を入力
3. 検索を実行
4. 検索結果を表示</p>
</blockquote>
<h2 id="4164c10">コミット: 4164c10<a class="headerlink" href="#4164c10" title="Permanent link">&para;</a></h2>
<h3 id="_7">メッセージ<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>検索フォーム #16
</code></pre></div>
<h3 id="_8">変更されたファイル<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>M app/views/staff/top/index.html.erb</li>
</ul>
<h3 id="_9">変更内容<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 4164c10009555a020e64ebb596984335d50c8a22
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 16:36:30 2017 +0900

<span class="w"> </span>   検索フォーム #16

<span class="gh">diff --git a/app/views/staff/top/index.html.erb b/app/views/staff/top/index.html.erb</span>
<span class="gh">index 3bf7df0..4adfc9f 100644</span>
<span class="gd">--- a/app/views/staff/top/index.html.erb</span>
<span class="gi">+++ b/app/views/staff/top/index.html.erb</span>
<span class="gu">@@ -8,6 +8,10 @@</span>
<span class="w"> </span>    &lt;h2 class=&quot;sectionLabel&quot;&gt;お知らせ&lt;/h2&gt;
<span class="w"> </span>  &lt;/div&gt;
<span class="w"> </span>  &lt;ol class=&quot;NewsList&quot;&gt;
<span class="gi">+    &lt;li class=&quot;NewsList__item&quot;&gt;</span>
<span class="gi">+      &lt;time class=&quot;NewsList__head&quot; datatime=&quot;2017-2-7&quot;&gt;2017.2.7&lt;/time&gt;</span>
<span class="gi">+      &lt;span class=&quot;NewsList__body&quot;&gt;顧客検索機能を追加&lt;/span&gt;</span>
<span class="gi">+    &lt;/li&gt;</span>
<span class="w"> </span>    &lt;li class=&quot;NewsList__item&quot;&gt;
<span class="w"> </span>      &lt;time class=&quot;NewsList__head&quot; datatime=&quot;2017-2-7&quot;&gt;2017.2.7&lt;/time&gt;
<span class="w"> </span>      &lt;span class=&quot;NewsList__body&quot;&gt;顧客電話番号管理機能を追加&lt;/span&gt;
</code></pre></div>
<h2 id="f613d25">コミット: f613d25<a class="headerlink" href="#f613d25" title="Permanent link">&para;</a></h2>
<h3 id="_10">メッセージ<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>検索条件に電話番号下４桁を追加 #16
</code></pre></div>
<h3 id="_11">変更されたファイル<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/controllers/staff/customers_controller.rb</li>
<li>M app/forms/staff/customer_search_form.rb</li>
<li>M app/models/phone.rb</li>
<li>M app/views/staff/customers/_search_form.html.erb</li>
<li>M config/locales/models/ja.yml</li>
<li>A db/migrate/20170207070920_alter_phones2.rb</li>
<li>A db/migrate/20170207071612_update_phones1.rb</li>
<li>M db/schema.rb</li>
<li>M spec/factories/phones.rb</li>
</ul>
<h3 id="_12">変更内容<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit f613d25648e6f0363e8d499e6d2d4e21b678a383
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 16:31:09 2017 +0900

<span class="w"> </span>   検索条件に電話番号下４桁を追加 #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index b76583b..18c6f37 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -621,6 +621,7 @@ git push heroku master</span>
<span class="w"> </span>#### 演習問題
<span class="w"> </span>+ 検索条件に性別を追加 
<span class="w"> </span>+ 検索条件に郵便番号を追加
<span class="gi">++ 検索条件に電話番号下４桁を追加</span>

<span class="w"> </span>**[⬆ back to top](#構成)**

<span class="gh">diff --git a/app/controllers/staff/customers_controller.rb b/app/controllers/staff/customers_controller.rb</span>
<span class="gh">index c9b3ccf..6342b22 100644</span>
<span class="gd">--- a/app/controllers/staff/customers_controller.rb</span>
<span class="gi">+++ b/app/controllers/staff/customers_controller.rb</span>
<span class="gu">@@ -64,7 +64,8 @@ class Staff::CustomersController &lt; Staff::Base</span>
<span class="w"> </span>        :city,
<span class="w"> </span>        :phone_number,
<span class="w"> </span>        :gender,
<span class="gd">-        :postal_code</span>
<span class="gi">+        :postal_code,</span>
<span class="gi">+        :last_four_digits</span>
<span class="w"> </span>    )
<span class="w"> </span>  end

<span class="gh">diff --git a/app/forms/staff/customer_search_form.rb b/app/forms/staff/customer_search_form.rb</span>
<span class="gh">index 0d2991a..6a46821 100644</span>
<span class="gd">--- a/app/forms/staff/customer_search_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_search_form.rb</span>
<span class="gu">@@ -12,7 +12,8 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>                :city,
<span class="w"> </span>                :phone_number,
<span class="w"> </span>                :gender,
<span class="gd">-                :postal_code</span>
<span class="gi">+                :postal_code,</span>
<span class="gi">+                :last_four_digits</span>

<span class="w"> </span>  def search
<span class="w"> </span>    normalize_values
<span class="gu">@@ -49,8 +50,14 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>      end
<span class="w"> </span>    end

<span class="gd">-    if phone_number.present?</span>
<span class="gd">-      rel = rel.joins(:phones).where(&#39;phones.number_for_index&#39; =&gt; phone_number)</span>
<span class="gi">+    if phone_number.present? || last_four_digits.present?</span>
<span class="gi">+      rel = rel.joins(:phones)</span>
<span class="gi">+      if phone_number.present?</span>
<span class="gi">+        rel = rel.where(&#39;phones.number_for_index&#39; =&gt; phone_number)</span>
<span class="gi">+      end</span>
<span class="gi">+      if last_four_digits.present?</span>
<span class="gi">+        rel = rel.where(&#39;phones.last_four_digits&#39; =&gt; last_four_digits)</span>
<span class="gi">+      end</span>
<span class="w"> </span>    end

<span class="w"> </span>    rel.order(:family_name_kana, :given_name_kana)
<span class="gh">diff --git a/app/models/phone.rb b/app/models/phone.rb</span>
<span class="gh">index 386e689..94e92f9 100644</span>
<span class="gd">--- a/app/models/phone.rb</span>
<span class="gi">+++ b/app/models/phone.rb</span>
<span class="gu">@@ -10,11 +10,13 @@</span>
<span class="w"> </span>#  primary          :boolean          default(&quot;0&quot;), not null # 優先フラグ
<span class="w"> </span>#  created_at       :datetime         not null
<span class="w"> </span>#  updated_at       :datetime         not null
<span class="gi">+#  last_four_digits :string(255)                             # 電話番号下４桁</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="w"> </span>#  index_phones_on_address_id        (address_id)
<span class="w"> </span>#  index_phones_on_customer_id       (customer_id)
<span class="gi">+#  index_phones_on_last_four_digits  (last_four_digits)</span>
<span class="w"> </span>#  index_phones_on_number_for_index  (number_for_index)
<span class="w"> </span>#

<span class="gu">@@ -27,6 +29,9 @@ class Phone &lt; ApplicationRecord</span>
<span class="w"> </span>  before_validation do
<span class="w"> </span>    self.number = normalize_as_phone_number(number)
<span class="w"> </span>    self.number_for_index = number.gsub(/\D/, &#39;&#39;) if number
<span class="gi">+    if number_for_index &amp;&amp; number_for_index.size &gt;= 4</span>
<span class="gi">+      self.last_four_digits = number_for_index[-4, 4]</span>
<span class="gi">+    end</span>
<span class="w"> </span>  end

<span class="w"> </span>  before_create do
<span class="gh">diff --git a/app/views/staff/customers/_search_form.html.erb b/app/views/staff/customers/_search_form.html.erb</span>
<span class="gh">index 08e0875..43ff1f4 100644</span>
<span class="gd">--- a/app/views/staff/customers/_search_form.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_search_form.html.erb</span>
<span class="gu">@@ -17,6 +17,7 @@</span>
<span class="w"> </span>      m.br
<span class="w"> </span>      m &lt;&lt; p.text_field_block(:postal_code, t(&#39;activerecord.attributes.address.postal_code&#39;)+&#39;:&#39;, size: 7)
<span class="w"> </span>      m &lt;&lt; p.text_field_block(:phone_number, t(&#39;activerecord.attributes.phone.number&#39;)+&#39;:&#39;)
<span class="gi">+      m &lt;&lt; p.text_field_block(:last_four_digits, t(&#39;activerecord.attributes.phone.last_four_digits&#39;)+&#39;:&#39;, size: 4)</span>
<span class="w"> </span>      m &lt;&lt; f.submit(t(&#39;staff.shared.search.submit&#39;))
<span class="w"> </span>      end %&gt;
<span class="w"> </span>&lt;% end %&gt;
\ No newline at end of file
<span class="gh">diff --git a/config/locales/models/ja.yml b/config/locales/models/ja.yml</span>
<span class="gh">index 013f874..612676c 100644</span>
<span class="gd">--- a/config/locales/models/ja.yml</span>
<span class="gi">+++ b/config/locales/models/ja.yml</span>
<span class="gu">@@ -85,6 +85,7 @@ ja:</span>
<span class="w"> </span>        number: 電話番号
<span class="w"> </span>        number_for_index: 索引用電話番号
<span class="w"> </span>        primary: 優先
<span class="gi">+        last_four_digits: 電話番号下４桁</span>

<span class="w"> </span>    errors:
<span class="w"> </span>      models:
<span class="gh">diff --git a/db/migrate/20170207070920_alter_phones2.rb b/db/migrate/20170207070920_alter_phones2.rb</span>
new file mode 100644
<span class="gh">index 0000000..611faf3</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170207070920_alter_phones2.rb</span>
<span class="gu">@@ -0,0 +1,7 @@</span>
<span class="gi">+class AlterPhones2 &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def change</span>
<span class="gi">+    add_column :phones, :last_four_digits, :string, comment: &#39;電話番号下４桁&#39;</span>
<span class="gi">+</span>
<span class="gi">+    add_index :phones, :last_four_digits</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/migrate/20170207071612_update_phones1.rb b/db/migrate/20170207071612_update_phones1.rb</span>
new file mode 100644
<span class="gh">index 0000000..7cfd27b</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170207071612_update_phones1.rb</span>
<span class="gu">@@ -0,0 +1,19 @@</span>
<span class="gi">+class UpdatePhones1 &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def up</span>
<span class="gi">+    if Rails.env != &#39;test&#39;</span>
<span class="gi">+      execute(%q{</span>
<span class="gi">+      UPDATE phones SET last_four_digits =</span>
<span class="gi">+        SUBSTR(number_for_index, LENGTH(number_for_index) - 3)</span>
<span class="gi">+        WHERE number_for_index IS NOT NULL AND LENGTH(number_for_index) &gt;= 4</span>
<span class="gi">+    })</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  def down</span>
<span class="gi">+    if Rails.env != &#39;test&#39;</span>
<span class="gi">+      execute(%q{</span>
<span class="gi">+      UPDATE phones SET last_four_digits = NULL</span>
<span class="gi">+    })</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/schema.rb b/db/schema.rb</span>
<span class="gh">index c644c07..218066a 100644</span>
<span class="gd">--- a/db/schema.rb</span>
<span class="gi">+++ b/db/schema.rb</span>
<span class="gu">@@ -10,109 +10,107 @@</span>
<span class="w"> </span>#
<span class="w"> </span># It&#39;s strongly recommended that you check this file into your version control system.

<span class="gd">-ActiveRecord::Schema.define(version: 20170207064811) do</span>
<span class="gi">+ActiveRecord::Schema.define(version: 20170207071612) do</span>

<span class="gd">-  create_table &quot;addresses&quot;, force: :cascade, comment: &quot;住所&quot; do |t|</span>
<span class="gd">-    t.integer  &quot;customer_id&quot;,                null: false, comment: &quot;顧客への外部キー&quot;</span>
<span class="gd">-    t.string   &quot;type&quot;,                       null: false, comment: &quot;継承カラム&quot;</span>
<span class="gd">-    t.string   &quot;postal_code&quot;,                null: false, comment: &quot;郵便番号&quot;</span>
<span class="gd">-    t.string   &quot;prefecture&quot;,                 null: false, comment: &quot;都道府県&quot;</span>
<span class="gd">-    t.string   &quot;city&quot;,                       null: false, comment: &quot;市区町村&quot;</span>
<span class="gd">-    t.string   &quot;address1&quot;,                   null: false, comment: &quot;町域・番地等&quot;</span>
<span class="gd">-    t.string   &quot;address2&quot;,                   null: false, comment: &quot;建物名・部屋番号&quot;</span>
<span class="gd">-    t.string   &quot;company_name&quot;,  default: &quot;&quot;, null: false, comment: &quot;会社名&quot;</span>
<span class="gd">-    t.string   &quot;division_name&quot;, default: &quot;&quot;, null: false, comment: &quot;部署名&quot;</span>
<span class="gi">+  create_table &quot;addresses&quot;, force: :cascade do |t|</span>
<span class="gi">+    t.integer  &quot;customer_id&quot;,                null: false</span>
<span class="gi">+    t.string   &quot;type&quot;,                       null: false</span>
<span class="gi">+    t.string   &quot;postal_code&quot;,                null: false</span>
<span class="gi">+    t.string   &quot;prefecture&quot;,                 null: false</span>
<span class="gi">+    t.string   &quot;city&quot;,                       null: false</span>
<span class="gi">+    t.string   &quot;address1&quot;,                   null: false</span>
<span class="gi">+    t.string   &quot;address2&quot;,                   null: false</span>
<span class="gi">+    t.string   &quot;company_name&quot;,  default: &quot;&quot;, null: false</span>
<span class="gi">+    t.string   &quot;division_name&quot;, default: &quot;&quot;, null: false</span>
<span class="w"> </span>    t.datetime &quot;created_at&quot;,                 null: false
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,                 null: false
<span class="gd">-    t.index [&quot;city&quot;], name: &quot;index_addresses_on_city&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;customer_id&quot;], name: &quot;index_addresses_on_customer_id&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;postal_code&quot;], name: &quot;index_addresses_on_postal_code&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_prefecture_and_city&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;type&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_city&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;type&quot;, &quot;customer_id&quot;], name: &quot;index_addresses_on_type_and_customer_id&quot;, unique: true, using: :btree</span>
<span class="gd">-    t.index [&quot;type&quot;, &quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_prefecture_and_city&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;city&quot;], name: &quot;index_addresses_on_city&quot;</span>
<span class="gi">+    t.index [&quot;customer_id&quot;], name: &quot;index_addresses_on_customer_id&quot;</span>
<span class="gi">+    t.index [&quot;postal_code&quot;], name: &quot;index_addresses_on_postal_code&quot;</span>
<span class="gi">+    t.index [&quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_prefecture_and_city&quot;</span>
<span class="gi">+    t.index [&quot;type&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_city&quot;</span>
<span class="gi">+    t.index [&quot;type&quot;, &quot;customer_id&quot;], name: &quot;index_addresses_on_type_and_customer_id&quot;, unique: true</span>
<span class="gi">+    t.index [&quot;type&quot;, &quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_prefecture_and_city&quot;</span>
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;administrators&quot;, force: :cascade, comment: &quot;管理者&quot; do |t|</span>
<span class="gd">-    t.string   &quot;email&quot;,                           null: false, comment: &quot;メールアドレス&quot;</span>
<span class="gd">-    t.string   &quot;email_for_index&quot;,                 null: false, comment: &quot;索引用メールアドレス&quot;</span>
<span class="gd">-    t.string   &quot;hashed_password&quot;,                              comment: &quot;パスワード&quot;</span>
<span class="gd">-    t.boolean  &quot;suspended&quot;,       default: false, null: false, comment: &quot;停止フラグ&quot;</span>
<span class="gi">+  create_table &quot;administrators&quot;, force: :cascade do |t|</span>
<span class="gi">+    t.string   &quot;email&quot;,                           null: false</span>
<span class="gi">+    t.string   &quot;email_for_index&quot;,                 null: false</span>
<span class="gi">+    t.string   &quot;hashed_password&quot;</span>
<span class="gi">+    t.boolean  &quot;suspended&quot;,       default: false, null: false</span>
<span class="w"> </span>    t.datetime &quot;created_at&quot;,                      null: false
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,                      null: false
<span class="gd">-    t.index [&quot;email_for_index&quot;], name: &quot;index_administrators_on_email_for_index&quot;, unique: true, using: :btree</span>
<span class="gi">+    t.index [&quot;email_for_index&quot;], name: &quot;index_administrators_on_email_for_index&quot;, unique: true</span>
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;customers&quot;, force: :cascade, comment: &quot;顧客&quot; do |t|</span>
<span class="gd">-    t.string   &quot;email&quot;,            null: false, comment: &quot;メールアドレス&quot;</span>
<span class="gd">-    t.string   &quot;email_for_index&quot;,  null: false, comment: &quot;顧客用メールアドレス&quot;</span>
<span class="gd">-    t.string   &quot;family_name&quot;,      null: false, comment: &quot;姓&quot;</span>
<span class="gd">-    t.string   &quot;given_name&quot;,       null: false, comment: &quot;名&quot;</span>
<span class="gd">-    t.string   &quot;family_name_kana&quot;, null: false, comment: &quot;姓（カナ）&quot;</span>
<span class="gd">-    t.string   &quot;given_name_kana&quot;,  null: false, comment: &quot;名（カナ）&quot;</span>
<span class="gd">-    t.string   &quot;gender&quot;,                        comment: &quot;性別&quot;</span>
<span class="gd">-    t.date     &quot;birthday&quot;,                      comment: &quot;誕生日&quot;</span>
<span class="gd">-    t.string   &quot;hashed_password&quot;,               comment: &quot;パスワード&quot;</span>
<span class="gi">+  create_table &quot;customers&quot;, force: :cascade do |t|</span>
<span class="gi">+    t.string   &quot;email&quot;,            null: false</span>
<span class="gi">+    t.string   &quot;email_for_index&quot;,  null: false</span>
<span class="gi">+    t.string   &quot;family_name&quot;,      null: false</span>
<span class="gi">+    t.string   &quot;given_name&quot;,       null: false</span>
<span class="gi">+    t.string   &quot;family_name_kana&quot;, null: false</span>
<span class="gi">+    t.string   &quot;given_name_kana&quot;,  null: false</span>
<span class="gi">+    t.string   &quot;gender&quot;</span>
<span class="gi">+    t.date     &quot;birthday&quot;</span>
<span class="gi">+    t.string   &quot;hashed_password&quot;</span>
<span class="w"> </span>    t.datetime &quot;created_at&quot;,       null: false
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,       null: false
<span class="gd">-    t.integer  &quot;birth_year&quot;,                    comment: &quot;誕生年&quot;</span>
<span class="gd">-    t.integer  &quot;birth_month&quot;,                   comment: &quot;誕生月&quot;</span>
<span class="gd">-    t.integer  &quot;birth_mday&quot;,                    comment: &quot;誕生日&quot;</span>
<span class="gd">-    t.index [&quot;birth_mday&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_mday_and_furigana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;birth_mday&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_mday_and_given_name_kana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;birth_month&quot;, &quot;birth_mday&quot;], name: &quot;index_customers_on_birth_month_and_birth_mday&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;birth_month&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_month_and_furigana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;birth_month&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_month_and_given_name_kana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;birth_year&quot;, &quot;birth_month&quot;, &quot;birth_mday&quot;], name: &quot;index_customers_on_birth_year_and_birth_month_and_birth_mday&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;birth_year&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_year_and_furigana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;birth_year&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_year_and_given_name_kana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;email_for_index&quot;], name: &quot;index_customers_on_email_for_index&quot;, unique: true, using: :btree</span>
<span class="gd">-    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_family_name_kana_and_given_name_kana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;gender&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_gender_and_furigana&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;given_name_kana&quot;], name: &quot;index_customers_on_given_name_kana&quot;, using: :btree</span>
<span class="gi">+    t.integer  &quot;birth_year&quot;</span>
<span class="gi">+    t.integer  &quot;birth_month&quot;</span>
<span class="gi">+    t.integer  &quot;birth_mday&quot;</span>
<span class="gi">+    t.index [&quot;birth_mday&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_mday_and_furigana&quot;</span>
<span class="gi">+    t.index [&quot;birth_mday&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_mday_and_given_name_kana&quot;</span>
<span class="gi">+    t.index [&quot;birth_month&quot;, &quot;birth_mday&quot;], name: &quot;index_customers_on_birth_month_and_birth_mday&quot;</span>
<span class="gi">+    t.index [&quot;birth_month&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_month_and_furigana&quot;</span>
<span class="gi">+    t.index [&quot;birth_month&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_month_and_given_name_kana&quot;</span>
<span class="gi">+    t.index [&quot;birth_year&quot;, &quot;birth_month&quot;, &quot;birth_mday&quot;], name: &quot;index_customers_on_birth_year_and_birth_month_and_birth_mday&quot;</span>
<span class="gi">+    t.index [&quot;birth_year&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_year_and_furigana&quot;</span>
<span class="gi">+    t.index [&quot;birth_year&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_year_and_given_name_kana&quot;</span>
<span class="gi">+    t.index [&quot;email_for_index&quot;], name: &quot;index_customers_on_email_for_index&quot;, unique: true</span>
<span class="gi">+    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_family_name_kana_and_given_name_kana&quot;</span>
<span class="gi">+    t.index [&quot;gender&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_gender_and_furigana&quot;</span>
<span class="gi">+    t.index [&quot;given_name_kana&quot;], name: &quot;index_customers_on_given_name_kana&quot;</span>
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;phones&quot;, force: :cascade, comment: &quot;電話&quot; do |t|</span>
<span class="gd">-    t.integer  &quot;customer_id&quot;,                      null: false, comment: &quot;顧客への外部キー&quot;</span>
<span class="gd">-    t.integer  &quot;address_id&quot;,                                    comment: &quot;住所への外部キー&quot;</span>
<span class="gd">-    t.string   &quot;number&quot;,                           null: false, comment: &quot;電話番号&quot;</span>
<span class="gd">-    t.string   &quot;number_for_index&quot;,                 null: false, comment: &quot;索引用電話番号&quot;</span>
<span class="gd">-    t.boolean  &quot;primary&quot;,          default: false, null: false, comment: &quot;優先フラグ&quot;</span>
<span class="gi">+  create_table &quot;phones&quot;, force: :cascade do |t|</span>
<span class="gi">+    t.integer  &quot;customer_id&quot;,                      null: false</span>
<span class="gi">+    t.integer  &quot;address_id&quot;</span>
<span class="gi">+    t.string   &quot;number&quot;,                           null: false</span>
<span class="gi">+    t.string   &quot;number_for_index&quot;,                 null: false</span>
<span class="gi">+    t.boolean  &quot;primary&quot;,          default: false, null: false</span>
<span class="w"> </span>    t.datetime &quot;created_at&quot;,                       null: false
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,                       null: false
<span class="gd">-    t.index [&quot;address_id&quot;], name: &quot;index_phones_on_address_id&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;customer_id&quot;], name: &quot;index_phones_on_customer_id&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;, using: :btree</span>
<span class="gi">+    t.string   &quot;last_four_digits&quot;</span>
<span class="gi">+    t.index [&quot;address_id&quot;], name: &quot;index_phones_on_address_id&quot;</span>
<span class="gi">+    t.index [&quot;customer_id&quot;], name: &quot;index_phones_on_customer_id&quot;</span>
<span class="gi">+    t.index [&quot;last_four_digits&quot;], name: &quot;index_phones_on_last_four_digits&quot;</span>
<span class="gi">+    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;</span>
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_events&quot;, force: :cascade, comment: &quot;職員イベント&quot; do |t|</span>
<span class="gd">-    t.integer  &quot;staff_member_id&quot;, null: false, comment: &quot;職員レコードへの外部キー&quot;</span>
<span class="gd">-    t.string   &quot;type&quot;,            null: false, comment: &quot;イベントタイプ&quot;</span>
<span class="gd">-    t.datetime &quot;created_at&quot;,      null: false, comment: &quot;発生時刻&quot;</span>
<span class="gd">-    t.index [&quot;created_at&quot;], name: &quot;index_staff_events_on_created_at&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;staff_member_id&quot;, &quot;created_at&quot;], name: &quot;index_staff_events_on_staff_member_id_and_created_at&quot;, using: :btree</span>
<span class="gd">-    t.index [&quot;staff_member_id&quot;], name: &quot;index_staff_events_on_staff_member_id&quot;, using: :btree</span>
<span class="gi">+  create_table &quot;staff_events&quot;, force: :cascade do |t|</span>
<span class="gi">+    t.integer  &quot;staff_member_id&quot;, null: false</span>
<span class="gi">+    t.string   &quot;type&quot;,            null: false</span>
<span class="gi">+    t.datetime &quot;created_at&quot;,      null: false</span>
<span class="gi">+    t.index [&quot;created_at&quot;], name: &quot;index_staff_events_on_created_at&quot;</span>
<span class="gi">+    t.index [&quot;staff_member_id&quot;, &quot;created_at&quot;], name: &quot;index_staff_events_on_staff_member_id_and_created_at&quot;</span>
<span class="gi">+    t.index [&quot;staff_member_id&quot;], name: &quot;index_staff_events_on_staff_member_id&quot;</span>
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_members&quot;, force: :cascade, comment: &quot;職員&quot; do |t|</span>
<span class="gd">-    t.string   &quot;email&quot;,                            null: false, comment: &quot;メールアドレス&quot;</span>
<span class="gd">-    t.string   &quot;email_for_index&quot;,                  null: false, comment: &quot;索引用メールアドレス&quot;</span>
<span class="gd">-    t.string   &quot;family_name&quot;,                      null: false, comment: &quot;姓&quot;</span>
<span class="gd">-    t.string   &quot;given_name&quot;,                       null: false, comment: &quot;名&quot;</span>
<span class="gd">-    t.string   &quot;family_name_kana&quot;,                 null: false, comment: &quot;姓（カナ）&quot;</span>
<span class="gd">-    t.string   &quot;given_name_kana&quot;,                  null: false, comment: &quot;名（カナ）&quot;</span>
<span class="gd">-    t.string   &quot;hashed_password&quot;,                               comment: &quot;パスワード&quot;</span>
<span class="gd">-    t.date     &quot;start_date&quot;,                       null: false, comment: &quot;開始日&quot;</span>
<span class="gd">-    t.date     &quot;end_date&quot;,                                      comment: &quot;終了日&quot;</span>
<span class="gd">-    t.boolean  &quot;suspended&quot;,        default: false, null: false, comment: &quot;停止フラグ&quot;</span>
<span class="gi">+  create_table &quot;staff_members&quot;, force: :cascade do |t|</span>
<span class="gi">+    t.string   &quot;email&quot;,                            null: false</span>
<span class="gi">+    t.string   &quot;email_for_index&quot;,                  null: false</span>
<span class="gi">+    t.string   &quot;family_name&quot;,                      null: false</span>
<span class="gi">+    t.string   &quot;given_name&quot;,                       null: false</span>
<span class="gi">+    t.string   &quot;family_name_kana&quot;,                 null: false</span>
<span class="gi">+    t.string   &quot;given_name_kana&quot;,                  null: false</span>
<span class="gi">+    t.string   &quot;hashed_password&quot;</span>
<span class="gi">+    t.date     &quot;start_date&quot;,                       null: false</span>
<span class="gi">+    t.date     &quot;end_date&quot;</span>
<span class="gi">+    t.boolean  &quot;suspended&quot;,        default: false, null: false</span>
<span class="w"> </span>    t.datetime &quot;created_at&quot;,                       null: false
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,                       null: false
<span class="gd">-    t.index [&quot;email_for_index&quot;], name: &quot;index_staff_members_on_email_for_index&quot;, unique: true, using: :btree</span>
<span class="gd">-    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_staff_members_on_family_name_kana_and_given_name_kana&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;email_for_index&quot;], name: &quot;index_staff_members_on_email_for_index&quot;, unique: true</span>
<span class="gi">+    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_staff_members_on_family_name_kana_and_given_name_kana&quot;</span>
<span class="w"> </span>  end

<span class="gd">-  add_foreign_key &quot;addresses&quot;, &quot;customers&quot;</span>
<span class="gd">-  add_foreign_key &quot;phones&quot;, &quot;addresses&quot;</span>
<span class="gd">-  add_foreign_key &quot;phones&quot;, &quot;customers&quot;</span>
<span class="gd">-  add_foreign_key &quot;staff_events&quot;, &quot;staff_members&quot;</span>
<span class="w"> </span>end
<span class="gh">diff --git a/spec/factories/phones.rb b/spec/factories/phones.rb</span>
<span class="gh">index 4ef34b3..694da4d 100644</span>
<span class="gd">--- a/spec/factories/phones.rb</span>
<span class="gi">+++ b/spec/factories/phones.rb</span>
<span class="gu">@@ -10,11 +10,13 @@</span>
<span class="w"> </span>#  primary          :boolean          default(&quot;0&quot;), not null # 優先フラグ
<span class="w"> </span>#  created_at       :datetime         not null
<span class="w"> </span>#  updated_at       :datetime         not null
<span class="gi">+#  last_four_digits :string(255)                             # 電話番号下４桁</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="w"> </span>#  index_phones_on_address_id        (address_id)
<span class="w"> </span>#  index_phones_on_customer_id       (customer_id)
<span class="gi">+#  index_phones_on_last_four_digits  (last_four_digits)</span>
<span class="w"> </span>#  index_phones_on_number_for_index  (number_for_index)
<span class="w"> </span>#
</code></pre></div>
<h3 id="_13">構造変更<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="47e1f46">コミット: 47e1f46<a class="headerlink" href="#47e1f46" title="Permanent link">&para;</a></h2>
<h3 id="_14">メッセージ<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>演習問題 #16
</code></pre></div>
<h3 id="_15">変更されたファイル<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/controllers/staff/customers_controller.rb</li>
<li>M app/forms/staff/customer_search_form.rb</li>
<li>M app/models/address.rb</li>
<li>M app/models/home_address.rb</li>
<li>M app/models/work_address.rb</li>
<li>M app/views/staff/customers/_search_form.html.erb</li>
<li>A db/migrate/20170207064811_alter_addresses2.rb</li>
<li>M db/schema.rb</li>
<li>M spec/factories/addresses.rb</li>
</ul>
<h3 id="_16">変更内容<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 47e1f4645af5a9f618c7ef6b8870df37bc1445b4
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 16:06:04 2017 +0900

<span class="w"> </span>   演習問題 #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 7a9f2f1..b76583b 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -620,6 +620,7 @@ git push heroku master</span>

<span class="w"> </span>#### 演習問題
<span class="w"> </span>+ 検索条件に性別を追加 
<span class="gi">++ 検索条件に郵便番号を追加</span>

<span class="w"> </span>**[⬆ back to top](#構成)**

<span class="gh">diff --git a/app/controllers/staff/customers_controller.rb b/app/controllers/staff/customers_controller.rb</span>
<span class="gh">index ea2433a..c9b3ccf 100644</span>
<span class="gd">--- a/app/controllers/staff/customers_controller.rb</span>
<span class="gi">+++ b/app/controllers/staff/customers_controller.rb</span>
<span class="gu">@@ -63,7 +63,8 @@ class Staff::CustomersController &lt; Staff::Base</span>
<span class="w"> </span>        :prefecture,
<span class="w"> </span>        :city,
<span class="w"> </span>        :phone_number,
<span class="gd">-        :gender</span>
<span class="gi">+        :gender,</span>
<span class="gi">+        :postal_code</span>
<span class="w"> </span>    )
<span class="w"> </span>  end

<span class="gh">diff --git a/app/forms/staff/customer_search_form.rb b/app/forms/staff/customer_search_form.rb</span>
<span class="gh">index 10480fc..0d2991a 100644</span>
<span class="gd">--- a/app/forms/staff/customer_search_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_search_form.rb</span>
<span class="gu">@@ -11,7 +11,8 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>                :prefecture,
<span class="w"> </span>                :city,
<span class="w"> </span>                :phone_number,
<span class="gd">-                :gender</span>
<span class="gi">+                :gender,</span>
<span class="gi">+                :postal_code</span>

<span class="w"> </span>  def search
<span class="w"> </span>    normalize_values
<span class="gu">@@ -28,7 +29,7 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>    rel = rel.where(birth_mday: birth_mday) if birth_mday.present?
<span class="w"> </span>    rel = rel.where(gender: gender) if gender.present?

<span class="gd">-    if prefecture.present? || city.present?</span>
<span class="gi">+    if prefecture.present? || city.present? || postal_code.present?</span>
<span class="w"> </span>      case address_type
<span class="w"> </span>        when &#39;home&#39;
<span class="w"> </span>          rel = rel.joins(:home_address)
<span class="gu">@@ -43,6 +44,9 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>        rel = rel.where(&#39;addresses.prefecture&#39; =&gt; prefecture)
<span class="w"> </span>      end
<span class="w"> </span>      rel = rel.where(&#39;addresses.city&#39; =&gt; city) if city.present?
<span class="gi">+      if postal_code.present?</span>
<span class="gi">+        rel = rel.where(&#39;addresses.postal_code&#39; =&gt; postal_code)</span>
<span class="gi">+      end</span>
<span class="w"> </span>    end

<span class="w"> </span>    if phone_number.present?
<span class="gu">@@ -58,5 +62,6 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>    self.given_name_kana = normalize_as_furigana(given_name_kana)
<span class="w"> </span>    self.city = normalize_as_name(city)
<span class="w"> </span>    self.phone_number = normalize_as_phone_number(phone_number).try(:gsub,/\D/, &#39;&#39;)
<span class="gi">+    self.postal_code = normalize_as_postal_code(postal_code)</span>
<span class="w"> </span>  end
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/app/models/address.rb b/app/models/address.rb</span>
<span class="gh">index f7db6f8..503bf41 100644</span>
<span class="gd">--- a/app/models/address.rb</span>
<span class="gi">+++ b/app/models/address.rb</span>
<span class="gu">@@ -19,6 +19,7 @@</span>
<span class="w"> </span>#
<span class="w"> </span>#  index_addresses_on_city                          (city)
<span class="w"> </span>#  index_addresses_on_customer_id                   (customer_id)
<span class="gi">+#  index_addresses_on_postal_code                   (postal_code)</span>
<span class="w"> </span>#  index_addresses_on_prefecture_and_city           (prefecture,city)
<span class="w"> </span>#  index_addresses_on_type_and_city                 (type,city)
<span class="w"> </span>#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE
<span class="gh">diff --git a/app/models/home_address.rb b/app/models/home_address.rb</span>
<span class="gh">index da88407..7cf7676 100644</span>
<span class="gd">--- a/app/models/home_address.rb</span>
<span class="gi">+++ b/app/models/home_address.rb</span>
<span class="gu">@@ -19,6 +19,7 @@</span>
<span class="w"> </span>#
<span class="w"> </span>#  index_addresses_on_city                          (city)
<span class="w"> </span>#  index_addresses_on_customer_id                   (customer_id)
<span class="gi">+#  index_addresses_on_postal_code                   (postal_code)</span>
<span class="w"> </span>#  index_addresses_on_prefecture_and_city           (prefecture,city)
<span class="w"> </span>#  index_addresses_on_type_and_city                 (type,city)
<span class="w"> </span>#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE
<span class="gh">diff --git a/app/models/work_address.rb b/app/models/work_address.rb</span>
<span class="gh">index 0ba0773..50e0455 100644</span>
<span class="gd">--- a/app/models/work_address.rb</span>
<span class="gi">+++ b/app/models/work_address.rb</span>
<span class="gu">@@ -19,6 +19,7 @@</span>
<span class="w"> </span>#
<span class="w"> </span>#  index_addresses_on_city                          (city)
<span class="w"> </span>#  index_addresses_on_customer_id                   (customer_id)
<span class="gi">+#  index_addresses_on_postal_code                   (postal_code)</span>
<span class="w"> </span>#  index_addresses_on_prefecture_and_city           (prefecture,city)
<span class="w"> </span>#  index_addresses_on_type_and_city                 (type,city)
<span class="w"> </span>#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE
<span class="gh">diff --git a/app/views/staff/customers/_search_form.html.erb b/app/views/staff/customers/_search_form.html.erb</span>
<span class="gh">index da3070a..08e0875 100644</span>
<span class="gd">--- a/app/views/staff/customers/_search_form.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_search_form.html.erb</span>
<span class="gu">@@ -15,6 +15,7 @@</span>
<span class="w"> </span>      m &lt;&lt; p.drop_down_list_block(:prefecture, t(&#39;activerecord.attributes.address.prefecture&#39;)+&#39;:&#39;, Address::PREFECTURE_NAMES)
<span class="w"> </span>      m &lt;&lt; p.text_field_block(:city, t(&#39;activerecord.attributes.address.city&#39;))
<span class="w"> </span>      m.br
<span class="gi">+      m &lt;&lt; p.text_field_block(:postal_code, t(&#39;activerecord.attributes.address.postal_code&#39;)+&#39;:&#39;, size: 7)</span>
<span class="w"> </span>      m &lt;&lt; p.text_field_block(:phone_number, t(&#39;activerecord.attributes.phone.number&#39;)+&#39;:&#39;)
<span class="w"> </span>      m &lt;&lt; f.submit(t(&#39;staff.shared.search.submit&#39;))
<span class="w"> </span>      end %&gt;
<span class="gh">diff --git a/db/migrate/20170207064811_alter_addresses2.rb b/db/migrate/20170207064811_alter_addresses2.rb</span>
new file mode 100644
<span class="gh">index 0000000..3362e3f</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170207064811_alter_addresses2.rb</span>
<span class="gu">@@ -0,0 +1,5 @@</span>
<span class="gi">+class AlterAddresses2 &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def change</span>
<span class="gi">+    add_index :addresses, :postal_code</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/schema.rb b/db/schema.rb</span>
<span class="gh">index 80706d9..c644c07 100644</span>
<span class="gd">--- a/db/schema.rb</span>
<span class="gi">+++ b/db/schema.rb</span>
<span class="gu">@@ -10,9 +10,9 @@</span>
<span class="w"> </span>#
<span class="w"> </span># It&#39;s strongly recommended that you check this file into your version control system.

<span class="gd">-ActiveRecord::Schema.define(version: 20170207063552) do</span>
<span class="gi">+ActiveRecord::Schema.define(version: 20170207064811) do</span>

<span class="gd">-  create_table &quot;addresses&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;住所&quot; do |t|</span>
<span class="gi">+  create_table &quot;addresses&quot;, force: :cascade, comment: &quot;住所&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,                       null: false, comment: &quot;継承カラム&quot;
<span class="w"> </span>    t.string   &quot;postal_code&quot;,                null: false, comment: &quot;郵便番号&quot;
<span class="gu">@@ -26,13 +26,14 @@ ActiveRecord::Schema.define(version: 20170207063552) do</span>
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,                 null: false
<span class="w"> </span>    t.index [&quot;city&quot;], name: &quot;index_addresses_on_city&quot;, using: :btree
<span class="w"> </span>    t.index [&quot;customer_id&quot;], name: &quot;index_addresses_on_customer_id&quot;, using: :btree
<span class="gi">+    t.index [&quot;postal_code&quot;], name: &quot;index_addresses_on_postal_code&quot;, using: :btree</span>
<span class="w"> </span>    t.index [&quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_prefecture_and_city&quot;, using: :btree
<span class="w"> </span>    t.index [&quot;type&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_city&quot;, using: :btree
<span class="w"> </span>    t.index [&quot;type&quot;, &quot;customer_id&quot;], name: &quot;index_addresses_on_type_and_customer_id&quot;, unique: true, using: :btree
<span class="w"> </span>    t.index [&quot;type&quot;, &quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_prefecture_and_city&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;administrators&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;管理者&quot; do |t|</span>
<span class="gi">+  create_table &quot;administrators&quot;, force: :cascade, comment: &quot;管理者&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                           null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                 null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;hashed_password&quot;,                              comment: &quot;パスワード&quot;
<span class="gu">@@ -42,7 +43,7 @@ ActiveRecord::Schema.define(version: 20170207063552) do</span>
<span class="w"> </span>    t.index [&quot;email_for_index&quot;], name: &quot;index_administrators_on_email_for_index&quot;, unique: true, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;customers&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;顧客&quot; do |t|</span>
<span class="gi">+  create_table &quot;customers&quot;, force: :cascade, comment: &quot;顧客&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,  null: false, comment: &quot;顧客用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,      null: false, comment: &quot;姓&quot;
<span class="gu">@@ -71,7 +72,7 @@ ActiveRecord::Schema.define(version: 20170207063552) do</span>
<span class="w"> </span>    t.index [&quot;given_name_kana&quot;], name: &quot;index_customers_on_given_name_kana&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;phones&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;電話&quot; do |t|</span>
<span class="gi">+  create_table &quot;phones&quot;, force: :cascade, comment: &quot;電話&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                      null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.integer  &quot;address_id&quot;,                                    comment: &quot;住所への外部キー&quot;
<span class="w"> </span>    t.string   &quot;number&quot;,                           null: false, comment: &quot;電話番号&quot;
<span class="gu">@@ -84,7 +85,7 @@ ActiveRecord::Schema.define(version: 20170207063552) do</span>
<span class="w"> </span>    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_events&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員イベント&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_events&quot;, force: :cascade, comment: &quot;職員イベント&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;staff_member_id&quot;, null: false, comment: &quot;職員レコードへの外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,            null: false, comment: &quot;イベントタイプ&quot;
<span class="w"> </span>    t.datetime &quot;created_at&quot;,      null: false, comment: &quot;発生時刻&quot;
<span class="gu">@@ -93,7 +94,7 @@ ActiveRecord::Schema.define(version: 20170207063552) do</span>
<span class="w"> </span>    t.index [&quot;staff_member_id&quot;], name: &quot;index_staff_events_on_staff_member_id&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_members&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_members&quot;, force: :cascade, comment: &quot;職員&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                  null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,                      null: false, comment: &quot;姓&quot;
<span class="gh">diff --git a/spec/factories/addresses.rb b/spec/factories/addresses.rb</span>
<span class="gh">index 39737ae..ecbdc13 100644</span>
<span class="gd">--- a/spec/factories/addresses.rb</span>
<span class="gi">+++ b/spec/factories/addresses.rb</span>
<span class="gu">@@ -19,6 +19,7 @@</span>
<span class="w"> </span>#
<span class="w"> </span>#  index_addresses_on_city                          (city)
<span class="w"> </span>#  index_addresses_on_customer_id                   (customer_id)
<span class="gi">+#  index_addresses_on_postal_code                   (postal_code)</span>
<span class="w"> </span>#  index_addresses_on_prefecture_and_city           (prefecture,city)
<span class="w"> </span>#  index_addresses_on_type_and_city                 (type,city)
<span class="w"> </span>#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE
</code></pre></div>
<h3 id="_17">構造変更<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="a474c1a">コミット: a474c1a<a class="headerlink" href="#a474c1a" title="Permanent link">&para;</a></h2>
<h3 id="_18">メッセージ<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>演習問題 #16
</code></pre></div>
<h3 id="_19">変更されたファイル<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/controllers/staff/customers_controller.rb</li>
<li>M app/forms/staff/customer_search_form.rb</li>
<li>M app/models/customer.rb</li>
<li>M app/views/staff/customers/_search_form.html.erb</li>
<li>M config/locales/views/ja.yml</li>
<li>A db/migrate/20170207063552_alter_customer2.rb</li>
<li>M db/schema.rb</li>
<li>M spec/factories/customers.rb</li>
</ul>
<h3 id="_20">変更内容<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit a474c1af5ddd5a02e05a792224b2035d5fbbfd53
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 15:47:00 2017 +0900

<span class="w"> </span>   演習問題 #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 77a1a03..7a9f2f1 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -619,6 +619,7 @@ git push heroku master</span>
<span class="w"> </span>+ 検索文字列の正規化

<span class="w"> </span>#### 演習問題
<span class="gi">++ 検索条件に性別を追加 </span>

<span class="w"> </span>**[⬆ back to top](#構成)**

<span class="gh">diff --git a/app/controllers/staff/customers_controller.rb b/app/controllers/staff/customers_controller.rb</span>
<span class="gh">index b004ad4..ea2433a 100644</span>
<span class="gd">--- a/app/controllers/staff/customers_controller.rb</span>
<span class="gi">+++ b/app/controllers/staff/customers_controller.rb</span>
<span class="gu">@@ -62,7 +62,8 @@ class Staff::CustomersController &lt; Staff::Base</span>
<span class="w"> </span>        :address_type,
<span class="w"> </span>        :prefecture,
<span class="w"> </span>        :city,
<span class="gd">-        :phone_number</span>
<span class="gi">+        :phone_number,</span>
<span class="gi">+        :gender</span>
<span class="w"> </span>    )
<span class="w"> </span>  end

<span class="gh">diff --git a/app/forms/staff/customer_search_form.rb b/app/forms/staff/customer_search_form.rb</span>
<span class="gh">index c63fcf1..10480fc 100644</span>
<span class="gd">--- a/app/forms/staff/customer_search_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_search_form.rb</span>
<span class="gu">@@ -10,7 +10,8 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>                :address_type,
<span class="w"> </span>                :prefecture,
<span class="w"> </span>                :city,
<span class="gd">-                :phone_number</span>
<span class="gi">+                :phone_number,</span>
<span class="gi">+                :gender</span>

<span class="w"> </span>  def search
<span class="w"> </span>    normalize_values
<span class="gu">@@ -25,6 +26,7 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>    rel = rel.where(birth_year: birth_year) if birth_year.present?
<span class="w"> </span>    rel = rel.where(birth_month: birth_month) if birth_month.present?
<span class="w"> </span>    rel = rel.where(birth_mday: birth_mday) if birth_mday.present?
<span class="gi">+    rel = rel.where(gender: gender) if gender.present?</span>

<span class="w"> </span>    if prefecture.present? || city.present?
<span class="w"> </span>      case address_type
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index 30f20ba..68bac7c 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -30,6 +30,7 @@</span>
<span class="w"> </span>#  index_customers_on_birth_year_and_given_name_kana             (birth_year,given_name_kana)
<span class="w"> </span>#  index_customers_on_email_for_index                            (email_for_index) UNIQUE
<span class="w"> </span>#  index_customers_on_family_name_kana_and_given_name_kana       (family_name_kana,given_name_kana)
<span class="gi">+#  index_customers_on_gender_and_furigana                        (gender,family_name_kana,given_name_kana)</span>
<span class="w"> </span>#  index_customers_on_given_name_kana                            (given_name_kana)
<span class="w"> </span>#

<span class="gh">diff --git a/app/views/staff/customers/_search_form.html.erb b/app/views/staff/customers/_search_form.html.erb</span>
<span class="gh">index 3c51099..da3070a 100644</span>
<span class="gd">--- a/app/views/staff/customers/_search_form.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_search_form.html.erb</span>
<span class="gu">@@ -7,6 +7,7 @@</span>
<span class="w"> </span>      m &lt;&lt; p.drop_down_list_block(:birth_year, t(&#39;activerecord.attributes.customer.birthday&#39;) ,(1900..Time.current.year).to_a.reverse)
<span class="w"> </span>      m &lt;&lt; p.drop_down_list_block(:birth_month, t(&#39;activerecord.attributes.customer.birth_month&#39;),1..12)
<span class="w"> </span>      m &lt;&lt; p.drop_down_list_block(:birth_mday, t(&#39;activerecord.attributes.customer.birth_mday&#39;),1..31)
<span class="gi">+      m &lt;&lt; p.drop_down_list_block(:gender, t(&#39;activerecord.attributes.customer.gender&#39;),[[t(&#39;staff.shared.search.gender.male&#39;),&#39;male&#39;],[t(&#39;staff.shared.search.gender.female&#39;),&#39;female&#39;]])</span>
<span class="w"> </span>      m.br
<span class="w"> </span>      m.div do
<span class="w"> </span>        m &lt;&lt; p.drop_down_list_block(:address_type, t(&#39;staff.shared.search.address_type.range&#39;)+&#39;:&#39;,[ [t(&#39;staff.shared.search.address_type.home&#39;),&#39;home&#39;],[t(&#39;staff.shared.search.address_type.work&#39;),&#39;work&#39;]])
<span class="gh">diff --git a/config/locales/views/ja.yml b/config/locales/views/ja.yml</span>
<span class="gh">index bb05948..5ac1a8e 100644</span>
<span class="gd">--- a/config/locales/views/ja.yml</span>
<span class="gi">+++ b/config/locales/views/ja.yml</span>
<span class="gu">@@ -10,6 +10,9 @@ ja:</span>
<span class="w"> </span>          range: &#39;住所の検索範囲&#39;
<span class="w"> </span>          home: &#39;自宅住所のみ&#39;
<span class="w"> </span>          work: &#39;勤務先のみ&#39;
<span class="gi">+        gender:</span>
<span class="gi">+          male: &#39;男性&#39;</span>
<span class="gi">+          female: &#39;女性&#39;</span>
<span class="w"> </span>        submit: &#39;検索&#39;
<span class="w"> </span>    sessions:
<span class="w"> </span>      new:
<span class="gh">diff --git a/db/migrate/20170207063552_alter_customer2.rb b/db/migrate/20170207063552_alter_customer2.rb</span>
new file mode 100644
<span class="gh">index 0000000..a54b0e1</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170207063552_alter_customer2.rb</span>
<span class="gu">@@ -0,0 +1,5 @@</span>
<span class="gi">+class AlterCustomer2 &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def change</span>
<span class="gi">+    add_index :customers, [:gender, :family_name_kana, :given_name_kana], name: &#39;index_customers_on_gender_and_furigana&#39;</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/schema.rb b/db/schema.rb</span>
<span class="gh">index 7678b16..80706d9 100644</span>
<span class="gd">--- a/db/schema.rb</span>
<span class="gi">+++ b/db/schema.rb</span>
<span class="gu">@@ -10,9 +10,9 @@</span>
<span class="w"> </span>#
<span class="w"> </span># It&#39;s strongly recommended that you check this file into your version control system.

<span class="gd">-ActiveRecord::Schema.define(version: 20170207044130) do</span>
<span class="gi">+ActiveRecord::Schema.define(version: 20170207063552) do</span>

<span class="gd">-  create_table &quot;addresses&quot;, force: :cascade, comment: &quot;住所&quot; do |t|</span>
<span class="gi">+  create_table &quot;addresses&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;住所&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,                       null: false, comment: &quot;継承カラム&quot;
<span class="w"> </span>    t.string   &quot;postal_code&quot;,                null: false, comment: &quot;郵便番号&quot;
<span class="gu">@@ -32,7 +32,7 @@ ActiveRecord::Schema.define(version: 20170207044130) do</span>
<span class="w"> </span>    t.index [&quot;type&quot;, &quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_prefecture_and_city&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;administrators&quot;, force: :cascade,  comment: &quot;管理者&quot; do |t|</span>
<span class="gi">+  create_table &quot;administrators&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;管理者&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                           null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                 null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;hashed_password&quot;,                              comment: &quot;パスワード&quot;
<span class="gu">@@ -42,7 +42,7 @@ ActiveRecord::Schema.define(version: 20170207044130) do</span>
<span class="w"> </span>    t.index [&quot;email_for_index&quot;], name: &quot;index_administrators_on_email_for_index&quot;, unique: true, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;customers&quot;, force: :cascade,  comment: &quot;顧客&quot; do |t|</span>
<span class="gi">+  create_table &quot;customers&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;顧客&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,  null: false, comment: &quot;顧客用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,      null: false, comment: &quot;姓&quot;
<span class="gu">@@ -67,10 +67,11 @@ ActiveRecord::Schema.define(version: 20170207044130) do</span>
<span class="w"> </span>    t.index [&quot;birth_year&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_year_and_given_name_kana&quot;, using: :btree
<span class="w"> </span>    t.index [&quot;email_for_index&quot;], name: &quot;index_customers_on_email_for_index&quot;, unique: true, using: :btree
<span class="w"> </span>    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_family_name_kana_and_given_name_kana&quot;, using: :btree
<span class="gi">+    t.index [&quot;gender&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_gender_and_furigana&quot;, using: :btree</span>
<span class="w"> </span>    t.index [&quot;given_name_kana&quot;], name: &quot;index_customers_on_given_name_kana&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;phones&quot;, force: :cascade,  comment: &quot;電話&quot; do |t|</span>
<span class="gi">+  create_table &quot;phones&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;電話&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                      null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.integer  &quot;address_id&quot;,                                    comment: &quot;住所への外部キー&quot;
<span class="w"> </span>    t.string   &quot;number&quot;,                           null: false, comment: &quot;電話番号&quot;
<span class="gu">@@ -83,7 +84,7 @@ ActiveRecord::Schema.define(version: 20170207044130) do</span>
<span class="w"> </span>    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_events&quot;, force: :cascade,  comment: &quot;職員イベント&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_events&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員イベント&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;staff_member_id&quot;, null: false, comment: &quot;職員レコードへの外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,            null: false, comment: &quot;イベントタイプ&quot;
<span class="w"> </span>    t.datetime &quot;created_at&quot;,      null: false, comment: &quot;発生時刻&quot;
<span class="gu">@@ -92,7 +93,7 @@ ActiveRecord::Schema.define(version: 20170207044130) do</span>
<span class="w"> </span>    t.index [&quot;staff_member_id&quot;], name: &quot;index_staff_events_on_staff_member_id&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_members&quot;, force: :cascade,  comment: &quot;職員&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_members&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                  null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,                      null: false, comment: &quot;姓&quot;
<span class="gh">diff --git a/spec/factories/customers.rb b/spec/factories/customers.rb</span>
<span class="gh">index 3e9abab..9b0a9cd 100644</span>
<span class="gd">--- a/spec/factories/customers.rb</span>
<span class="gi">+++ b/spec/factories/customers.rb</span>
<span class="gu">@@ -30,6 +30,7 @@</span>
<span class="w"> </span>#  index_customers_on_birth_year_and_given_name_kana             (birth_year,given_name_kana)
<span class="w"> </span>#  index_customers_on_email_for_index                            (email_for_index) UNIQUE
<span class="w"> </span>#  index_customers_on_family_name_kana_and_given_name_kana       (family_name_kana,given_name_kana)
<span class="gi">+#  index_customers_on_gender_and_furigana                        (gender,family_name_kana,given_name_kana)</span>
<span class="w"> </span>#  index_customers_on_given_name_kana                            (given_name_kana)
<span class="w"> </span>#
</code></pre></div>
<h3 id="_21">構造変更<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="c07f4d4">コミット: c07f4d4<a class="headerlink" href="#c07f4d4" title="Permanent link">&para;</a></h2>
<h3 id="_22">メッセージ<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>検索文字列の正規化 #16
</code></pre></div>
<h3 id="_23">変更されたファイル<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_search_form.rb</li>
</ul>
<h3 id="_24">変更内容<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit c07f4d40750afbb257493d7d74b0bd35f5109f39
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 15:30:47 2017 +0900

<span class="w"> </span>   検索文字列の正規化 #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index d602654..77a1a03 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -616,6 +616,7 @@ git push heroku master</span>
<span class="w"> </span>+ indexアクションの修正
<span class="w"> </span>+ フォームオブジェクトの修正（１）
<span class="w"> </span>+ フォームオブジェクトの修正（２）
<span class="gi">++ 検索文字列の正規化</span>

<span class="w"> </span>#### 演習問題

<span class="gh">diff --git a/app/forms/staff/customer_search_form.rb b/app/forms/staff/customer_search_form.rb</span>
<span class="gh">index 1500017..c63fcf1 100644</span>
<span class="gd">--- a/app/forms/staff/customer_search_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_search_form.rb</span>
<span class="gu">@@ -1,5 +1,6 @@</span>
<span class="w"> </span>class Staff::CustomerSearchForm
<span class="w"> </span>  include ActiveModel::Model
<span class="gi">+  include StringNormalizer</span>

<span class="w"> </span>  attr_accessor :family_name_kana,
<span class="w"> </span>                :given_name_kana,
<span class="gu">@@ -12,6 +13,8 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>                :phone_number

<span class="w"> </span>  def search
<span class="gi">+    normalize_values</span>
<span class="gi">+</span>
<span class="w"> </span>    rel = Customer
<span class="w"> </span>    if family_name_kana.present?
<span class="w"> </span>      rel = rel.where(family_name_kana: family_name_kana)
<span class="gu">@@ -46,4 +49,12 @@ class Staff::CustomerSearchForm</span>

<span class="w"> </span>    rel.order(:family_name_kana, :given_name_kana)
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  private</span>
<span class="gi">+  def normalize_values</span>
<span class="gi">+    self.family_name_kana = normalize_as_furigana(family_name_kana)</span>
<span class="gi">+    self.given_name_kana = normalize_as_furigana(given_name_kana)</span>
<span class="gi">+    self.city = normalize_as_name(city)</span>
<span class="gi">+    self.phone_number = normalize_as_phone_number(phone_number).try(:gsub,/\D/, &#39;&#39;)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
</code></pre></div>
<h2 id="5d85223">コミット: 5d85223<a class="headerlink" href="#5d85223" title="Permanent link">&para;</a></h2>
<h3 id="_25">メッセージ<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>フォームオブジェクトの修正（２） #16
</code></pre></div>
<h3 id="_26">変更されたファイル<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/controllers/staff/customers_controller.rb</li>
<li>M app/forms/staff/customer_search_form.rb</li>
<li>M app/models/customer.rb</li>
</ul>
<h3 id="_27">変更内容<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 5d852237c6d67c1ce52c62d44edb2f7fc9aa5050
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 15:25:22 2017 +0900

<span class="w"> </span>   フォームオブジェクトの修正（２） #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index fff94bb..d602654 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -615,6 +615,7 @@ git push heroku master</span>
<span class="w"> </span>#### 検索機能の実装
<span class="w"> </span>+ indexアクションの修正
<span class="w"> </span>+ フォームオブジェクトの修正（１）
<span class="gi">++ フォームオブジェクトの修正（２）</span>

<span class="w"> </span>#### 演習問題

<span class="gh">diff --git a/app/controllers/staff/customers_controller.rb b/app/controllers/staff/customers_controller.rb</span>
<span class="gh">index c840c22..b004ad4 100644</span>
<span class="gd">--- a/app/controllers/staff/customers_controller.rb</span>
<span class="gi">+++ b/app/controllers/staff/customers_controller.rb</span>
<span class="gu">@@ -1,6 +1,10 @@</span>
<span class="w"> </span>class Staff::CustomersController &lt; Staff::Base
<span class="w"> </span>  def index
<span class="gd">-    @search_form = Staff::CustomerSearchForm.new(search_params)</span>
<span class="gi">+    if params[:search].nil?</span>
<span class="gi">+      @search_form = Staff::CustomerSearchForm.new</span>
<span class="gi">+    else</span>
<span class="gi">+      @search_form = Staff::CustomerSearchForm.new(search_params)</span>
<span class="gi">+    end</span>
<span class="w"> </span>    @customers = @search_form.search.page(params[:page])
<span class="w"> </span>  end

<span class="gh">diff --git a/app/forms/staff/customer_search_form.rb b/app/forms/staff/customer_search_form.rb</span>
<span class="gh">index f48f500..1500017 100644</span>
<span class="gd">--- a/app/forms/staff/customer_search_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_search_form.rb</span>
<span class="gu">@@ -23,6 +23,27 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>    rel = rel.where(birth_month: birth_month) if birth_month.present?
<span class="w"> </span>    rel = rel.where(birth_mday: birth_mday) if birth_mday.present?

<span class="gi">+    if prefecture.present? || city.present?</span>
<span class="gi">+      case address_type</span>
<span class="gi">+        when &#39;home&#39;</span>
<span class="gi">+          rel = rel.joins(:home_address)</span>
<span class="gi">+        when &#39;work&#39;</span>
<span class="gi">+          rel = rel.joins(:work_address)</span>
<span class="gi">+        when &#39;&#39;</span>
<span class="gi">+          rel = rel.joins(:addresses)</span>
<span class="gi">+        else</span>
<span class="gi">+          raise</span>
<span class="gi">+      end</span>
<span class="gi">+      if prefecture.present?</span>
<span class="gi">+        rel = rel.where(&#39;addresses.prefecture&#39; =&gt; prefecture)</span>
<span class="gi">+      end</span>
<span class="gi">+      rel = rel.where(&#39;addresses.city&#39; =&gt; city) if city.present?</span>
<span class="gi">+    end</span>
<span class="gi">+</span>
<span class="gi">+    if phone_number.present?</span>
<span class="gi">+      rel = rel.joins(:phones).where(&#39;phones.number_for_index&#39; =&gt; phone_number)</span>
<span class="gi">+    end</span>
<span class="gi">+</span>
<span class="w"> </span>    rel.order(:family_name_kana, :given_name_kana)
<span class="w"> </span>  end
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index eec9620..30f20ba 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -38,8 +38,9 @@ class Customer &lt; ApplicationRecord</span>
<span class="w"> </span>  include PersonalNameHolder
<span class="w"> </span>  include PasswordHolder

<span class="gd">-  has_one :home_address, dependent: :destroy, autosave: true</span>
<span class="gd">-  has_one :work_address, dependent: :destroy, autosave: true</span>
<span class="gi">+  has_many :addresses, dependent: :destroy</span>
<span class="gi">+  has_one :home_address, autosave: true</span>
<span class="gi">+  has_one :work_address, autosave: true</span>
<span class="w"> </span>  has_many :phones, dependent: :destroy
<span class="w"> </span>  has_many :personal_phones, -&gt; { where(address_id: nil).order(:id) },class_name: &#39;Phone&#39;, autosave: true
</code></pre></div>
<h3 id="_28">構造変更<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="32560b5">コミット: 32560b5<a class="headerlink" href="#32560b5" title="Permanent link">&para;</a></h2>
<h3 id="_29">メッセージ<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>フォームオブジェクトの修正（１） #16
</code></pre></div>
<h3 id="_30">変更されたファイル<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/controllers/staff/customers_controller.rb</li>
<li>M app/forms/staff/customer_search_form.rb</li>
</ul>
<h3 id="_31">変更内容<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 32560b5a95213209dc73ac10606ca897d03117ad
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 15:07:22 2017 +0900

<span class="w"> </span>   フォームオブジェクトの修正（１） #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 11acab2..fff94bb 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -614,6 +614,7 @@ git push heroku master</span>

<span class="w"> </span>#### 検索機能の実装
<span class="w"> </span>+ indexアクションの修正
<span class="gi">++ フォームオブジェクトの修正（１）</span>

<span class="w"> </span>#### 演習問題

<span class="gh">diff --git a/app/controllers/staff/customers_controller.rb b/app/controllers/staff/customers_controller.rb</span>
<span class="gh">index 842cd2d..c840c22 100644</span>
<span class="gd">--- a/app/controllers/staff/customers_controller.rb</span>
<span class="gi">+++ b/app/controllers/staff/customers_controller.rb</span>
<span class="gu">@@ -1,6 +1,6 @@</span>
<span class="w"> </span>class Staff::CustomersController &lt; Staff::Base
<span class="w"> </span>  def index
<span class="gd">-    @search_form = Staff::CustomerSearchForm.new(params[:search])</span>
<span class="gi">+    @search_form = Staff::CustomerSearchForm.new(search_params)</span>
<span class="w"> </span>    @customers = @search_form.search.page(params[:page])
<span class="w"> </span>  end

<span class="gu">@@ -46,4 +46,20 @@ class Staff::CustomersController &lt; Staff::Base</span>
<span class="w"> </span>    flash.notice = t(&#39;.flash_notice&#39;)
<span class="w"> </span>    redirect_to :staff_customers
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  private</span>
<span class="gi">+  def search_params</span>
<span class="gi">+    params.require(:search).permit(</span>
<span class="gi">+        :family_name_kana,</span>
<span class="gi">+        :given_name_kana,</span>
<span class="gi">+        :birth_year,</span>
<span class="gi">+        :birth_month,</span>
<span class="gi">+        :birth_mday,</span>
<span class="gi">+        :address_type,</span>
<span class="gi">+        :prefecture,</span>
<span class="gi">+        :city,</span>
<span class="gi">+        :phone_number</span>
<span class="gi">+    )</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="w"> </span>end
<span class="gh">diff --git a/app/forms/staff/customer_search_form.rb b/app/forms/staff/customer_search_form.rb</span>
<span class="gh">index 696c289..f48f500 100644</span>
<span class="gd">--- a/app/forms/staff/customer_search_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_search_form.rb</span>
<span class="gu">@@ -10,4 +10,19 @@ class Staff::CustomerSearchForm</span>
<span class="w"> </span>                :prefecture,
<span class="w"> </span>                :city,
<span class="w"> </span>                :phone_number
<span class="gi">+</span>
<span class="gi">+  def search</span>
<span class="gi">+    rel = Customer</span>
<span class="gi">+    if family_name_kana.present?</span>
<span class="gi">+      rel = rel.where(family_name_kana: family_name_kana)</span>
<span class="gi">+    end</span>
<span class="gi">+    if given_name_kana.present?</span>
<span class="gi">+      rel = rel.where(given_name_kana: given_name_kana)</span>
<span class="gi">+    end</span>
<span class="gi">+    rel = rel.where(birth_year: birth_year) if birth_year.present?</span>
<span class="gi">+    rel = rel.where(birth_month: birth_month) if birth_month.present?</span>
<span class="gi">+    rel = rel.where(birth_mday: birth_mday) if birth_mday.present?</span>
<span class="gi">+</span>
<span class="gi">+    rel.order(:family_name_kana, :given_name_kana)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
</code></pre></div>
<h3 id="_32">構造変更<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="e18b0a1">コミット: e18b0a1<a class="headerlink" href="#e18b0a1" title="Permanent link">&para;</a></h2>
<h3 id="_33">メッセージ<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>indexアクションの修正 #16
</code></pre></div>
<h3 id="_34">変更されたファイル<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/controllers/staff/customers_controller.rb</li>
</ul>
<h3 id="_35">変更内容<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit e18b0a1b46bf48c78a9a98c59da5189bb60a8765
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 14:56:55 2017 +0900

<span class="w"> </span>   indexアクションの修正 #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 6e17a88..11acab2 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -613,6 +613,8 @@ git push heroku master</span>
<span class="w"> </span>+ 検索フォームの表示

<span class="w"> </span>#### 検索機能の実装
<span class="gi">++ indexアクションの修正</span>
<span class="gi">+</span>
<span class="w"> </span>#### 演習問題

<span class="w"> </span>**[⬆ back to top](#構成)**
<span class="gh">diff --git a/app/controllers/staff/customers_controller.rb b/app/controllers/staff/customers_controller.rb</span>
<span class="gh">index 6568707..842cd2d 100644</span>
<span class="gd">--- a/app/controllers/staff/customers_controller.rb</span>
<span class="gi">+++ b/app/controllers/staff/customers_controller.rb</span>
<span class="gu">@@ -1,7 +1,7 @@</span>
<span class="w"> </span>class Staff::CustomersController &lt; Staff::Base
<span class="w"> </span>  def index
<span class="gd">-    @search_form = Staff::CustomerSearchForm.new</span>
<span class="gd">-    @customers = Customer.order(:family_name_kana, :given_name_kana).page(params[:page])</span>
<span class="gi">+    @search_form = Staff::CustomerSearchForm.new(params[:search])</span>
<span class="gi">+    @customers = @search_form.search.page(params[:page])</span>
<span class="w"> </span>  end

<span class="w"> </span>  def show
</code></pre></div>
<h3 id="_36">構造変更<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="be04433">コミット: be04433<a class="headerlink" href="#be04433" title="Permanent link">&para;</a></h2>
<h3 id="_37">メッセージ<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>検索フォームの表示 #16
</code></pre></div>
<h3 id="_38">変更されたファイル<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/assets/stylesheets/components/_appForm.scss</li>
<li>M app/controllers/staff/customers_controller.rb</li>
<li>A app/forms/staff/customer_search_form.rb</li>
<li>M app/presenters/form_presenter.rb</li>
<li>A app/views/staff/customers/_search_form.html.erb</li>
<li>M app/views/staff/customers/index.html.erb</li>
<li>M config/locales/models/ja.yml</li>
<li>M config/locales/views/ja.yml</li>
</ul>
<h3 id="_39">変更内容<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit be0443324730070ff8f009336d08821de76e7642
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 14:53:26 2017 +0900

<span class="w"> </span>   検索フォームの表示 #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index ae630b8..6e17a88 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -610,6 +610,7 @@ git push heroku master</span>
<span class="w"> </span>+ 顧客検索機能の仕様
<span class="w"> </span>+ データベーススキーマの見直し
<span class="w"> </span>+ 誕生日、誕生月、誕生日の設定
<span class="gi">++ 検索フォームの表示</span>

<span class="w"> </span>#### 検索機能の実装
<span class="w"> </span>#### 演習問題
<span class="gh">diff --git a/app/assets/stylesheets/components/_appForm.scss b/app/assets/stylesheets/components/_appForm.scss</span>
<span class="gh">index a148bf7..591163e 100644</span>
<span class="gd">--- a/app/assets/stylesheets/components/_appForm.scss</span>
<span class="gi">+++ b/app/assets/stylesheets/components/_appForm.scss</span>
<span class="gu">@@ -46,4 +46,14 @@</span>
<span class="w"> </span>  &amp;__input-block {
<span class="w"> </span>    input { margin-right: $narrow * 2; }
<span class="w"> </span>  }
<span class="gi">+  &amp;__search {</span>
<span class="gi">+    padding: $wide;</span>
<span class="gi">+    border: solid $dark_gray 1px;</span>
<span class="gi">+    background-color: $very_light_gray;</span>
<span class="gi">+    div {</span>
<span class="gi">+      display: inline-block;</span>
<span class="gi">+      margin-right: $moderate $very_wide $moderate 0;</span>
<span class="gi">+      label { margin-right: $moderate }</span>
<span class="gi">+    }</span>
<span class="gi">+  }</span>
<span class="w"> </span>}
\ No newline at end of file
<span class="gh">diff --git a/app/controllers/staff/customers_controller.rb b/app/controllers/staff/customers_controller.rb</span>
<span class="gh">index 3969abe..6568707 100644</span>
<span class="gd">--- a/app/controllers/staff/customers_controller.rb</span>
<span class="gi">+++ b/app/controllers/staff/customers_controller.rb</span>
<span class="gu">@@ -1,5 +1,6 @@</span>
<span class="w"> </span>class Staff::CustomersController &lt; Staff::Base
<span class="w"> </span>  def index
<span class="gi">+    @search_form = Staff::CustomerSearchForm.new</span>
<span class="w"> </span>    @customers = Customer.order(:family_name_kana, :given_name_kana).page(params[:page])
<span class="w"> </span>  end

<span class="gh">diff --git a/app/forms/staff/customer_search_form.rb b/app/forms/staff/customer_search_form.rb</span>
new file mode 100644
<span class="gh">index 0000000..696c289</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/app/forms/staff/customer_search_form.rb</span>
<span class="gu">@@ -0,0 +1,13 @@</span>
<span class="gi">+class Staff::CustomerSearchForm</span>
<span class="gi">+  include ActiveModel::Model</span>
<span class="gi">+</span>
<span class="gi">+  attr_accessor :family_name_kana,</span>
<span class="gi">+                :given_name_kana,</span>
<span class="gi">+                :birth_year,</span>
<span class="gi">+                :birth_month,</span>
<span class="gi">+                :birth_mday,</span>
<span class="gi">+                :address_type,</span>
<span class="gi">+                :prefecture,</span>
<span class="gi">+                :city,</span>
<span class="gi">+                :phone_number</span>
<span class="gi">+end</span>
\ No newline at end of file
<span class="gh">diff --git a/app/presenters/form_presenter.rb b/app/presenters/form_presenter.rb</span>
<span class="gh">index 2695a43..545467e 100644</span>
<span class="gd">--- a/app/presenters/form_presenter.rb</span>
<span class="gi">+++ b/app/presenters/form_presenter.rb</span>
<span class="gu">@@ -53,7 +53,7 @@ class FormPresenter</span>

<span class="w"> </span>  def drop_down_list_block(name, label_text, choices, options ={})
<span class="w"> </span>    markup(:div, class: &#39;AppForm__input-block&#39;) do |m|
<span class="gd">-      m &lt;&lt; form_builder.select(name, choices, { include_blank: true }, options)</span>
<span class="gi">+      m &lt;&lt; form_builder.select(name, choices, options.merge(include_blank: true).merge(label: label_text))</span>
<span class="w"> </span>    end
<span class="w"> </span>  end

<span class="gh">diff --git a/app/views/staff/customers/_search_form.html.erb b/app/views/staff/customers/_search_form.html.erb</span>
new file mode 100644
<span class="gh">index 0000000..3c51099</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/app/views/staff/customers/_search_form.html.erb</span>
<span class="gu">@@ -0,0 +1,20 @@</span>
<span class="gi">+&lt;%= bootstrap_form_for @search_form, as: &#39;search&#39;, url: :staff_customers, html: { method: :get, class: &#39;AppForm__search&#39; } ,layout: :inline do |f| %&gt;</span>
<span class="gi">+    &lt;%= markup do |m|</span>
<span class="gi">+      p = FormPresenter.new(f, self)</span>
<span class="gi">+      m &lt;&lt; p.text_field_block(:family_name_kana, t(&#39;activerecord.attributes.customer.family_name_kana&#39;))</span>
<span class="gi">+      m &lt;&lt; p.text_field_block(:given_name_kana, t(&#39;activerecord.attributes.customer.given_name_kana&#39;))</span>
<span class="gi">+      m.br</span>
<span class="gi">+      m &lt;&lt; p.drop_down_list_block(:birth_year, t(&#39;activerecord.attributes.customer.birthday&#39;) ,(1900..Time.current.year).to_a.reverse)</span>
<span class="gi">+      m &lt;&lt; p.drop_down_list_block(:birth_month, t(&#39;activerecord.attributes.customer.birth_month&#39;),1..12)</span>
<span class="gi">+      m &lt;&lt; p.drop_down_list_block(:birth_mday, t(&#39;activerecord.attributes.customer.birth_mday&#39;),1..31)</span>
<span class="gi">+      m.br</span>
<span class="gi">+      m.div do</span>
<span class="gi">+        m &lt;&lt; p.drop_down_list_block(:address_type, t(&#39;staff.shared.search.address_type.range&#39;)+&#39;:&#39;,[ [t(&#39;staff.shared.search.address_type.home&#39;),&#39;home&#39;],[t(&#39;staff.shared.search.address_type.work&#39;),&#39;work&#39;]])</span>
<span class="gi">+      end</span>
<span class="gi">+      m &lt;&lt; p.drop_down_list_block(:prefecture, t(&#39;activerecord.attributes.address.prefecture&#39;)+&#39;:&#39;, Address::PREFECTURE_NAMES)</span>
<span class="gi">+      m &lt;&lt; p.text_field_block(:city, t(&#39;activerecord.attributes.address.city&#39;))</span>
<span class="gi">+      m.br</span>
<span class="gi">+      m &lt;&lt; p.text_field_block(:phone_number, t(&#39;activerecord.attributes.phone.number&#39;)+&#39;:&#39;)</span>
<span class="gi">+      m &lt;&lt; f.submit(t(&#39;staff.shared.search.submit&#39;))</span>
<span class="gi">+      end %&gt;</span>
<span class="gi">+&lt;% end %&gt;</span>
\ No newline at end of file
<span class="gh">diff --git a/app/views/staff/customers/index.html.erb b/app/views/staff/customers/index.html.erb</span>
<span class="gh">index 4978613..2fd20aa 100644</span>
<span class="gd">--- a/app/views/staff/customers/index.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/index.html.erb</span>
<span class="gu">@@ -8,6 +8,8 @@</span>
<span class="w"> </span>    &lt;%= link_to t(&#39;.new&#39;), :new_staff_customer, class: &#39;btn btn-default&#39; %&gt;
<span class="w"> </span>  &lt;/div&gt;

<span class="gi">+  &lt;%= render &#39;search_form&#39; %&gt;</span>
<span class="gi">+</span>
<span class="w"> </span>  &lt;%= paginate @customers %&gt;

<span class="w"> </span>  &lt;table class=&quot;Table__body Table__body--listing StaffTable__body&quot;&gt;
<span class="gh">diff --git a/config/locales/models/ja.yml b/config/locales/models/ja.yml</span>
<span class="gh">index b5c2b2f..013f874 100644</span>
<span class="gd">--- a/config/locales/models/ja.yml</span>
<span class="gi">+++ b/config/locales/models/ja.yml</span>
<span class="gu">@@ -52,6 +52,9 @@ ja:</span>
<span class="w"> </span>        work_address: 勤務先
<span class="w"> </span>        full_name: 氏名
<span class="w"> </span>        full_name_kana: フリガナ
<span class="gi">+        birth_year: 誕生年</span>
<span class="gi">+        birth_month: 誕生月</span>
<span class="gi">+        birth_mday: 誕生日</span>

<span class="w"> </span>      address:
<span class="w"> </span>        postal_code: 郵便番号
<span class="gh">diff --git a/config/locales/views/ja.yml b/config/locales/views/ja.yml</span>
<span class="gh">index 446ccfa..bb05948 100644</span>
<span class="gd">--- a/config/locales/views/ja.yml</span>
<span class="gi">+++ b/config/locales/views/ja.yml</span>
<span class="gu">@@ -5,6 +5,12 @@ ja:</span>
<span class="w"> </span>        login: &#39;ログイン&#39;
<span class="w"> </span>        logout: &#39;ログアウト&#39;
<span class="w"> </span>        account: &#39;アカウント&#39;
<span class="gi">+      search:</span>
<span class="gi">+        address_type:</span>
<span class="gi">+          range: &#39;住所の検索範囲&#39;</span>
<span class="gi">+          home: &#39;自宅住所のみ&#39;</span>
<span class="gi">+          work: &#39;勤務先のみ&#39;</span>
<span class="gi">+        submit: &#39;検索&#39;</span>
<span class="w"> </span>    sessions:
<span class="w"> </span>      new:
<span class="w"> </span>        submit: &#39;ログイン&#39;
</code></pre></div>
<h3 id="_40">構造変更<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="e6b074a">コミット: e6b074a<a class="headerlink" href="#e6b074a" title="Permanent link">&para;</a></h2>
<h3 id="_41">メッセージ<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>誕生日、誕生月、誕生日の設定 #16
</code></pre></div>
<h3 id="_42">変更されたファイル<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/models/customer.rb</li>
<li>A db/migrate/20170207044130_update_customer1.rb</li>
<li>M db/schema.rb</li>
<li>M spec/factories/customers.rb</li>
</ul>
<h3 id="_43">変更内容<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit e6b074a50a4ca45810701f790dc5c5fdf708378f
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 13:56:12 2017 +0900

<span class="w"> </span>   誕生日、誕生月、誕生日の設定 #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index eb6c484..ae630b8 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -609,6 +609,7 @@ git push heroku master</span>
<span class="w"> </span>#### 顧客検索フォーム
<span class="w"> </span>+ 顧客検索機能の仕様
<span class="w"> </span>+ データベーススキーマの見直し
<span class="gi">++ 誕生日、誕生月、誕生日の設定</span>

<span class="w"> </span>#### 検索機能の実装
<span class="w"> </span>#### 演習問題
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index 55327ae..eec9620 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -14,9 +14,9 @@</span>
<span class="w"> </span>#  hashed_password  :string(255)                            # パスワード
<span class="w"> </span>#  created_at       :datetime         not null
<span class="w"> </span>#  updated_at       :datetime         not null
<span class="gd">-#  birth_year       :integer                                # 誕生日年</span>
<span class="gd">-#  birth_month      :integer                                # 誕生日月</span>
<span class="gd">-#  birth_mday       :integer                                # 誕生日日</span>
<span class="gi">+#  birth_year       :integer                                # 誕生年</span>
<span class="gi">+#  birth_month      :integer                                # 誕生月</span>
<span class="gi">+#  birth_mday       :integer                                # 誕生日</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="gu">@@ -49,4 +49,12 @@ class Customer &lt; ApplicationRecord</span>
<span class="w"> </span>      before: -&gt;(obj) { Date.today },
<span class="w"> </span>      allow_blank: true
<span class="w"> </span>  }
<span class="gi">+</span>
<span class="gi">+  before_save do</span>
<span class="gi">+    if birthday</span>
<span class="gi">+      self.birth_year = birthday.year</span>
<span class="gi">+      self.birth_month = birthday.month</span>
<span class="gi">+      self.birth_mday = birthday.mday</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
<span class="gh">diff --git a/db/migrate/20170207044130_update_customer1.rb b/db/migrate/20170207044130_update_customer1.rb</span>
new file mode 100644
<span class="gh">index 0000000..5d6ecfb</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170207044130_update_customer1.rb</span>
<span class="gu">@@ -0,0 +1,22 @@</span>
<span class="gi">+class UpdateCustomer1 &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def up</span>
<span class="gi">+    if Rails.env != &#39;test&#39;</span>
<span class="gi">+      execute(%q{</span>
<span class="gi">+      UPDATE customers SET birth_year = EXTRACT(YEAR FROM birthday),</span>
<span class="gi">+       birth_month = EXTRACT(MONTH FROM birthday),</span>
<span class="gi">+       birth_mday = EXTRACT(DAY FROM birthday)</span>
<span class="gi">+       WHERE birthday IS NOT NULL</span>
<span class="gi">+    })</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  def down</span>
<span class="gi">+    if Rails.env != &#39;test&#39;</span>
<span class="gi">+      execute(%q{</span>
<span class="gi">+      UPDATE customers SET birth_year = NULL,</span>
<span class="gi">+       birth_month = NULL,</span>
<span class="gi">+       birth_mday = NULL</span>
<span class="gi">+    })</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/schema.rb b/db/schema.rb</span>
<span class="gh">index 8c5917b..7678b16 100644</span>
<span class="gd">--- a/db/schema.rb</span>
<span class="gi">+++ b/db/schema.rb</span>
<span class="gu">@@ -10,9 +10,9 @@</span>
<span class="w"> </span>#
<span class="w"> </span># It&#39;s strongly recommended that you check this file into your version control system.

<span class="gd">-ActiveRecord::Schema.define(version: 20170207042122) do</span>
<span class="gi">+ActiveRecord::Schema.define(version: 20170207044130) do</span>

<span class="gd">-  create_table &quot;addresses&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;住所&quot; do |t|</span>
<span class="gi">+  create_table &quot;addresses&quot;, force: :cascade, comment: &quot;住所&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,                       null: false, comment: &quot;継承カラム&quot;
<span class="w"> </span>    t.string   &quot;postal_code&quot;,                null: false, comment: &quot;郵便番号&quot;
<span class="gu">@@ -32,7 +32,7 @@ ActiveRecord::Schema.define(version: 20170207042122) do</span>
<span class="w"> </span>    t.index [&quot;type&quot;, &quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_prefecture_and_city&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;administrators&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;管理者&quot; do |t|</span>
<span class="gi">+  create_table &quot;administrators&quot;, force: :cascade,  comment: &quot;管理者&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                           null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                 null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;hashed_password&quot;,                              comment: &quot;パスワード&quot;
<span class="gu">@@ -42,7 +42,7 @@ ActiveRecord::Schema.define(version: 20170207042122) do</span>
<span class="w"> </span>    t.index [&quot;email_for_index&quot;], name: &quot;index_administrators_on_email_for_index&quot;, unique: true, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;customers&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;顧客&quot; do |t|</span>
<span class="gi">+  create_table &quot;customers&quot;, force: :cascade,  comment: &quot;顧客&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,  null: false, comment: &quot;顧客用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,      null: false, comment: &quot;姓&quot;
<span class="gu">@@ -70,7 +70,7 @@ ActiveRecord::Schema.define(version: 20170207042122) do</span>
<span class="w"> </span>    t.index [&quot;given_name_kana&quot;], name: &quot;index_customers_on_given_name_kana&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;phones&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;電話&quot; do |t|</span>
<span class="gi">+  create_table &quot;phones&quot;, force: :cascade,  comment: &quot;電話&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                      null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.integer  &quot;address_id&quot;,                                    comment: &quot;住所への外部キー&quot;
<span class="w"> </span>    t.string   &quot;number&quot;,                           null: false, comment: &quot;電話番号&quot;
<span class="gu">@@ -83,7 +83,7 @@ ActiveRecord::Schema.define(version: 20170207042122) do</span>
<span class="w"> </span>    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_events&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員イベント&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_events&quot;, force: :cascade,  comment: &quot;職員イベント&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;staff_member_id&quot;, null: false, comment: &quot;職員レコードへの外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,            null: false, comment: &quot;イベントタイプ&quot;
<span class="w"> </span>    t.datetime &quot;created_at&quot;,      null: false, comment: &quot;発生時刻&quot;
<span class="gu">@@ -92,7 +92,7 @@ ActiveRecord::Schema.define(version: 20170207042122) do</span>
<span class="w"> </span>    t.index [&quot;staff_member_id&quot;], name: &quot;index_staff_events_on_staff_member_id&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_members&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_members&quot;, force: :cascade,  comment: &quot;職員&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                  null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,                      null: false, comment: &quot;姓&quot;
<span class="gh">diff --git a/spec/factories/customers.rb b/spec/factories/customers.rb</span>
<span class="gh">index 185b72d..3e9abab 100644</span>
<span class="gd">--- a/spec/factories/customers.rb</span>
<span class="gi">+++ b/spec/factories/customers.rb</span>
<span class="gu">@@ -14,9 +14,9 @@</span>
<span class="w"> </span>#  hashed_password  :string(255)                            # パスワード
<span class="w"> </span>#  created_at       :datetime         not null
<span class="w"> </span>#  updated_at       :datetime         not null
<span class="gd">-#  birth_year       :integer                                # 誕生日（年）</span>
<span class="gd">-#  birth_month      :integer                                # 誕生日（月）</span>
<span class="gd">-#  birth_mday       :integer                                # 誕生日（日）</span>
<span class="gi">+#  birth_year       :integer                                # 誕生年</span>
<span class="gi">+#  birth_month      :integer                                # 誕生月</span>
<span class="gi">+#  birth_mday       :integer                                # 誕生日</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
</code></pre></div>
<h3 id="_44">構造変更<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="419b461">コミット: 419b461<a class="headerlink" href="#419b461" title="Permanent link">&para;</a></h2>
<h3 id="_45">メッセージ<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>データベーススキーマの見直し #16
</code></pre></div>
<h3 id="_46">変更されたファイル<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/models/address.rb</li>
<li>M app/models/customer.rb</li>
<li>M app/models/home_address.rb</li>
<li>M app/models/work_address.rb</li>
<li>A db/migrate/20170207042109_alter_customers1.rb</li>
<li>A db/migrate/20170207042122_alter_addresses1.rb</li>
<li>M db/schema.rb</li>
<li>M spec/factories/addresses.rb</li>
<li>M spec/factories/customers.rb</li>
</ul>
<h3 id="_47">変更内容<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 419b461a6a5649ade66b1f19a813dd9a5b8451e2
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 13:32:38 2017 +0900

<span class="w"> </span>   データベーススキーマの見直し #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index c678175..eb6c484 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -607,6 +607,9 @@ git push heroku master</span>

<span class="w"> </span>### 検索フォーム
<span class="w"> </span>#### 顧客検索フォーム
<span class="gi">++ 顧客検索機能の仕様</span>
<span class="gi">++ データベーススキーマの見直し</span>
<span class="gi">+</span>
<span class="w"> </span>#### 検索機能の実装
<span class="w"> </span>#### 演習問題

<span class="gh">diff --git a/app/models/address.rb b/app/models/address.rb</span>
<span class="gh">index b8ab123..f7db6f8 100644</span>
<span class="gd">--- a/app/models/address.rb</span>
<span class="gi">+++ b/app/models/address.rb</span>
<span class="gu">@@ -17,8 +17,12 @@</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="gd">-#  index_addresses_on_customer_id           (customer_id)</span>
<span class="gd">-#  index_addresses_on_type_and_customer_id  (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_city                          (city)</span>
<span class="gi">+#  index_addresses_on_customer_id                   (customer_id)</span>
<span class="gi">+#  index_addresses_on_prefecture_and_city           (prefecture,city)</span>
<span class="gi">+#  index_addresses_on_type_and_city                 (type,city)</span>
<span class="gi">+#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_type_and_prefecture_and_city  (type,prefecture,city)</span>
<span class="w"> </span>#

<span class="w"> </span>class Address &lt; ApplicationRecord
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index 423e927..55327ae 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -14,11 +14,23 @@</span>
<span class="w"> </span>#  hashed_password  :string(255)                            # パスワード
<span class="w"> </span>#  created_at       :datetime         not null
<span class="w"> </span>#  updated_at       :datetime         not null
<span class="gi">+#  birth_year       :integer                                # 誕生日年</span>
<span class="gi">+#  birth_month      :integer                                # 誕生日月</span>
<span class="gi">+#  birth_mday       :integer                                # 誕生日日</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="gd">-#  index_customers_on_email_for_index                       (email_for_index) UNIQUE</span>
<span class="gd">-#  index_customers_on_family_name_kana_and_given_name_kana  (family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_mday_and_furigana                    (birth_mday,family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_mday_and_given_name_kana             (birth_mday,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_month_and_birth_mday                 (birth_month,birth_mday)</span>
<span class="gi">+#  index_customers_on_birth_month_and_furigana                   (birth_month,family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_month_and_given_name_kana            (birth_month,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_year_and_birth_month_and_birth_mday  (birth_year,birth_month,birth_mday)</span>
<span class="gi">+#  index_customers_on_birth_year_and_furigana                    (birth_year,family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_year_and_given_name_kana             (birth_year,given_name_kana)</span>
<span class="gi">+#  index_customers_on_email_for_index                            (email_for_index) UNIQUE</span>
<span class="gi">+#  index_customers_on_family_name_kana_and_given_name_kana       (family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_given_name_kana                            (given_name_kana)</span>
<span class="w"> </span>#

<span class="w"> </span>class Customer &lt; ApplicationRecord
<span class="gh">diff --git a/app/models/home_address.rb b/app/models/home_address.rb</span>
<span class="gh">index fd3aa3e..da88407 100644</span>
<span class="gd">--- a/app/models/home_address.rb</span>
<span class="gi">+++ b/app/models/home_address.rb</span>
<span class="gu">@@ -17,8 +17,12 @@</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="gd">-#  index_addresses_on_customer_id           (customer_id)</span>
<span class="gd">-#  index_addresses_on_type_and_customer_id  (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_city                          (city)</span>
<span class="gi">+#  index_addresses_on_customer_id                   (customer_id)</span>
<span class="gi">+#  index_addresses_on_prefecture_and_city           (prefecture,city)</span>
<span class="gi">+#  index_addresses_on_type_and_city                 (type,city)</span>
<span class="gi">+#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_type_and_prefecture_and_city  (type,prefecture,city)</span>
<span class="w"> </span>#

<span class="w"> </span>class HomeAddress &lt; Address
<span class="gh">diff --git a/app/models/work_address.rb b/app/models/work_address.rb</span>
<span class="gh">index de8d396..0ba0773 100644</span>
<span class="gd">--- a/app/models/work_address.rb</span>
<span class="gi">+++ b/app/models/work_address.rb</span>
<span class="gu">@@ -17,8 +17,12 @@</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="gd">-#  index_addresses_on_customer_id           (customer_id)</span>
<span class="gd">-#  index_addresses_on_type_and_customer_id  (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_city                          (city)</span>
<span class="gi">+#  index_addresses_on_customer_id                   (customer_id)</span>
<span class="gi">+#  index_addresses_on_prefecture_and_city           (prefecture,city)</span>
<span class="gi">+#  index_addresses_on_type_and_city                 (type,city)</span>
<span class="gi">+#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_type_and_prefecture_and_city  (type,prefecture,city)</span>
<span class="w"> </span>#

<span class="w"> </span>class WorkAddress &lt; Address
<span class="gh">diff --git a/db/migrate/20170207042109_alter_customers1.rb b/db/migrate/20170207042109_alter_customers1.rb</span>
new file mode 100644
<span class="gh">index 0000000..1e0ffe5</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170207042109_alter_customers1.rb</span>
<span class="gu">@@ -0,0 +1,17 @@</span>
<span class="gi">+class AlterCustomers1 &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def change</span>
<span class="gi">+    add_column :customers, :birth_year, :integer, comment:&#39;誕生年&#39;</span>
<span class="gi">+    add_column :customers, :birth_month, :integer, comment:&#39;誕生月&#39;</span>
<span class="gi">+    add_column :customers, :birth_mday, :integer, comment:&#39;誕生日&#39;</span>
<span class="gi">+</span>
<span class="gi">+    add_index :customers, [ :birth_year, :birth_month, :birth_mday ]</span>
<span class="gi">+    add_index :customers, [ :birth_month, :birth_mday ]</span>
<span class="gi">+    add_index :customers, :given_name_kana</span>
<span class="gi">+    add_index :customers, [ :birth_year, :family_name_kana, :given_name_kana ], name: &#39;index_customers_on_birth_year_and_furigana&#39;</span>
<span class="gi">+    add_index :customers, [ :birth_year, :given_name_kana ]</span>
<span class="gi">+    add_index :customers, [ :birth_month, :family_name_kana, :given_name_kana ], name: &#39;index_customers_on_birth_month_and_furigana&#39;</span>
<span class="gi">+    add_index :customers, [ :birth_month, :given_name_kana ]</span>
<span class="gi">+    add_index :customers, [ :birth_mday, :family_name_kana, :given_name_kana ], name: &#39;index_customers_on_birth_mday_and_furigana&#39;</span>
<span class="gi">+    add_index :customers, [ :birth_mday, :given_name_kana ]</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/migrate/20170207042122_alter_addresses1.rb b/db/migrate/20170207042122_alter_addresses1.rb</span>
new file mode 100644
<span class="gh">index 0000000..a295639</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170207042122_alter_addresses1.rb</span>
<span class="gu">@@ -0,0 +1,8 @@</span>
<span class="gi">+class AlterAddresses1 &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def change</span>
<span class="gi">+    add_index :addresses, [ :type, :prefecture, :city ]</span>
<span class="gi">+    add_index :addresses, [ :type, :city ]</span>
<span class="gi">+    add_index :addresses, [ :prefecture, :city ]</span>
<span class="gi">+    add_index :addresses, :city</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/schema.rb b/db/schema.rb</span>
<span class="gh">index 7285822..8c5917b 100644</span>
<span class="gd">--- a/db/schema.rb</span>
<span class="gi">+++ b/db/schema.rb</span>
<span class="gu">@@ -10,9 +10,9 @@</span>
<span class="w"> </span>#
<span class="w"> </span># It&#39;s strongly recommended that you check this file into your version control system.

<span class="gd">-ActiveRecord::Schema.define(version: 20170206085929) do</span>
<span class="gi">+ActiveRecord::Schema.define(version: 20170207042122) do</span>

<span class="gd">-  create_table &quot;addresses&quot;, force: :cascade,  comment: &quot;住所&quot; do |t|</span>
<span class="gi">+  create_table &quot;addresses&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;住所&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,                       null: false, comment: &quot;継承カラム&quot;
<span class="w"> </span>    t.string   &quot;postal_code&quot;,                null: false, comment: &quot;郵便番号&quot;
<span class="gu">@@ -24,11 +24,15 @@ ActiveRecord::Schema.define(version: 20170206085929) do</span>
<span class="w"> </span>    t.string   &quot;division_name&quot;, default: &quot;&quot;, null: false, comment: &quot;部署名&quot;
<span class="w"> </span>    t.datetime &quot;created_at&quot;,                 null: false
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,                 null: false
<span class="gi">+    t.index [&quot;city&quot;], name: &quot;index_addresses_on_city&quot;, using: :btree</span>
<span class="w"> </span>    t.index [&quot;customer_id&quot;], name: &quot;index_addresses_on_customer_id&quot;, using: :btree
<span class="gi">+    t.index [&quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_prefecture_and_city&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;type&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_city&quot;, using: :btree</span>
<span class="w"> </span>    t.index [&quot;type&quot;, &quot;customer_id&quot;], name: &quot;index_addresses_on_type_and_customer_id&quot;, unique: true, using: :btree
<span class="gi">+    t.index [&quot;type&quot;, &quot;prefecture&quot;, &quot;city&quot;], name: &quot;index_addresses_on_type_and_prefecture_and_city&quot;, using: :btree</span>
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;administrators&quot;, force: :cascade,  comment: &quot;管理者&quot; do |t|</span>
<span class="gi">+  create_table &quot;administrators&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;管理者&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                           null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                 null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;hashed_password&quot;,                              comment: &quot;パスワード&quot;
<span class="gu">@@ -38,7 +42,7 @@ ActiveRecord::Schema.define(version: 20170206085929) do</span>
<span class="w"> </span>    t.index [&quot;email_for_index&quot;], name: &quot;index_administrators_on_email_for_index&quot;, unique: true, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;customers&quot;, force: :cascade,  comment: &quot;顧客&quot; do |t|</span>
<span class="gi">+  create_table &quot;customers&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;顧客&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,  null: false, comment: &quot;顧客用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,      null: false, comment: &quot;姓&quot;
<span class="gu">@@ -50,11 +54,23 @@ ActiveRecord::Schema.define(version: 20170206085929) do</span>
<span class="w"> </span>    t.string   &quot;hashed_password&quot;,               comment: &quot;パスワード&quot;
<span class="w"> </span>    t.datetime &quot;created_at&quot;,       null: false
<span class="w"> </span>    t.datetime &quot;updated_at&quot;,       null: false
<span class="gi">+    t.integer  &quot;birth_year&quot;,                    comment: &quot;誕生年&quot;</span>
<span class="gi">+    t.integer  &quot;birth_month&quot;,                   comment: &quot;誕生月&quot;</span>
<span class="gi">+    t.integer  &quot;birth_mday&quot;,                    comment: &quot;誕生日&quot;</span>
<span class="gi">+    t.index [&quot;birth_mday&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_mday_and_furigana&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;birth_mday&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_mday_and_given_name_kana&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;birth_month&quot;, &quot;birth_mday&quot;], name: &quot;index_customers_on_birth_month_and_birth_mday&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;birth_month&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_month_and_furigana&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;birth_month&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_month_and_given_name_kana&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;birth_year&quot;, &quot;birth_month&quot;, &quot;birth_mday&quot;], name: &quot;index_customers_on_birth_year_and_birth_month_and_birth_mday&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;birth_year&quot;, &quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_year_and_furigana&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;birth_year&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_birth_year_and_given_name_kana&quot;, using: :btree</span>
<span class="w"> </span>    t.index [&quot;email_for_index&quot;], name: &quot;index_customers_on_email_for_index&quot;, unique: true, using: :btree
<span class="w"> </span>    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_family_name_kana_and_given_name_kana&quot;, using: :btree
<span class="gi">+    t.index [&quot;given_name_kana&quot;], name: &quot;index_customers_on_given_name_kana&quot;, using: :btree</span>
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;phones&quot;, force: :cascade, comment: &quot;電話&quot; do |t|</span>
<span class="gi">+  create_table &quot;phones&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;電話&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                      null: false, comment: &quot;顧客への外部キー&quot;
<span class="w"> </span>    t.integer  &quot;address_id&quot;,                                    comment: &quot;住所への外部キー&quot;
<span class="w"> </span>    t.string   &quot;number&quot;,                           null: false, comment: &quot;電話番号&quot;
<span class="gu">@@ -67,7 +83,7 @@ ActiveRecord::Schema.define(version: 20170206085929) do</span>
<span class="w"> </span>    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_events&quot;, force: :cascade,  comment: &quot;職員イベント&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_events&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員イベント&quot; do |t|</span>
<span class="w"> </span>    t.integer  &quot;staff_member_id&quot;, null: false, comment: &quot;職員レコードへの外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,            null: false, comment: &quot;イベントタイプ&quot;
<span class="w"> </span>    t.datetime &quot;created_at&quot;,      null: false, comment: &quot;発生時刻&quot;
<span class="gu">@@ -76,7 +92,7 @@ ActiveRecord::Schema.define(version: 20170206085929) do</span>
<span class="w"> </span>    t.index [&quot;staff_member_id&quot;], name: &quot;index_staff_events_on_staff_member_id&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;staff_members&quot;, force: :cascade,  comment: &quot;職員&quot; do |t|</span>
<span class="gi">+  create_table &quot;staff_members&quot;, force: :cascade, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, comment: &quot;職員&quot; do |t|</span>
<span class="w"> </span>    t.string   &quot;email&quot;,                            null: false, comment: &quot;メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;email_for_index&quot;,                  null: false, comment: &quot;索引用メールアドレス&quot;
<span class="w"> </span>    t.string   &quot;family_name&quot;,                      null: false, comment: &quot;姓&quot;
<span class="gh">diff --git a/spec/factories/addresses.rb b/spec/factories/addresses.rb</span>
<span class="gh">index 076c809..39737ae 100644</span>
<span class="gd">--- a/spec/factories/addresses.rb</span>
<span class="gi">+++ b/spec/factories/addresses.rb</span>
<span class="gu">@@ -17,8 +17,12 @@</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="gd">-#  index_addresses_on_customer_id           (customer_id)</span>
<span class="gd">-#  index_addresses_on_type_and_customer_id  (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_city                          (city)</span>
<span class="gi">+#  index_addresses_on_customer_id                   (customer_id)</span>
<span class="gi">+#  index_addresses_on_prefecture_and_city           (prefecture,city)</span>
<span class="gi">+#  index_addresses_on_type_and_city                 (type,city)</span>
<span class="gi">+#  index_addresses_on_type_and_customer_id          (type,customer_id) UNIQUE</span>
<span class="gi">+#  index_addresses_on_type_and_prefecture_and_city  (type,prefecture,city)</span>
<span class="w"> </span>#

<span class="w"> </span>FactoryGirl.define do
<span class="gh">diff --git a/spec/factories/customers.rb b/spec/factories/customers.rb</span>
<span class="gh">index 9cec838..185b72d 100644</span>
<span class="gd">--- a/spec/factories/customers.rb</span>
<span class="gi">+++ b/spec/factories/customers.rb</span>
<span class="gu">@@ -14,11 +14,23 @@</span>
<span class="w"> </span>#  hashed_password  :string(255)                            # パスワード
<span class="w"> </span>#  created_at       :datetime         not null
<span class="w"> </span>#  updated_at       :datetime         not null
<span class="gi">+#  birth_year       :integer                                # 誕生日（年）</span>
<span class="gi">+#  birth_month      :integer                                # 誕生日（月）</span>
<span class="gi">+#  birth_mday       :integer                                # 誕生日（日）</span>
<span class="w"> </span>#
<span class="w"> </span># Indexes
<span class="w"> </span>#
<span class="gd">-#  index_customers_on_email_for_index                       (email_for_index) UNIQUE</span>
<span class="gd">-#  index_customers_on_family_name_kana_and_given_name_kana  (family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_mday_and_furigana                    (birth_mday,family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_mday_and_given_name_kana             (birth_mday,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_month_and_birth_mday                 (birth_month,birth_mday)</span>
<span class="gi">+#  index_customers_on_birth_month_and_furigana                   (birth_month,family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_month_and_given_name_kana            (birth_month,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_year_and_birth_month_and_birth_mday  (birth_year,birth_month,birth_mday)</span>
<span class="gi">+#  index_customers_on_birth_year_and_furigana                    (birth_year,family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_birth_year_and_given_name_kana             (birth_year,given_name_kana)</span>
<span class="gi">+#  index_customers_on_email_for_index                            (email_for_index) UNIQUE</span>
<span class="gi">+#  index_customers_on_family_name_kana_and_given_name_kana       (family_name_kana,given_name_kana)</span>
<span class="gi">+#  index_customers_on_given_name_kana                            (given_name_kana)</span>
<span class="w"> </span>#

<span class="w"> </span>FactoryGirl.define do
</code></pre></div>
<h3 id="_48">構造変更<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="fe94bbc">コミット: fe94bbc<a class="headerlink" href="#fe94bbc" title="Permanent link">&para;</a></h2>
<h3 id="_49">メッセージ<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>検索フォーム #16
</code></pre></div>
<h3 id="_50">変更されたファイル<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
</ul>
<h3 id="_51">変更内容<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit fe94bbcb979f2e2186a4cddacd63146bbbd12e8c
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 13:18:11 2017 +0900

<span class="w"> </span>   検索フォーム #16

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 05708e9..c678175 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -606,6 +606,10 @@ git push heroku master</span>
<span class="w"> </span>+ 勤務先電話番号の新規登録、更新、削除

<span class="w"> </span>### 検索フォーム
<span class="gi">+#### 顧客検索フォーム</span>
<span class="gi">+#### 検索機能の実装</span>
<span class="gi">+#### 演習問題</span>
<span class="gi">+</span>
<span class="w"> </span>**[⬆ back to top](#構成)**

<span class="w"> </span># 参照 #
</code></pre></div>
<h2 id="3d93787">コミット: 3d93787<a class="headerlink" href="#3d93787" title="Permanent link">&para;</a></h2>
<h3 id="_52">メッセージ<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>フォームオブジェクト #15
</code></pre></div>
<h3 id="_53">変更されたファイル<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h3>
<ul>
<li>M app/views/staff/top/index.html.erb</li>
</ul>
<h3 id="_54">変更内容<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 3d937870417ca43530577df2dc3c9a6b66b76ec7
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 13:09:48 2017 +0900

<span class="w"> </span>   フォームオブジェクト #15

<span class="gh">diff --git a/app/views/staff/top/index.html.erb b/app/views/staff/top/index.html.erb</span>
<span class="gh">index cda3f0f..3bf7df0 100644</span>
<span class="gd">--- a/app/views/staff/top/index.html.erb</span>
<span class="gi">+++ b/app/views/staff/top/index.html.erb</span>
<span class="gu">@@ -8,6 +8,10 @@</span>
<span class="w"> </span>    &lt;h2 class=&quot;sectionLabel&quot;&gt;お知らせ&lt;/h2&gt;
<span class="w"> </span>  &lt;/div&gt;
<span class="w"> </span>  &lt;ol class=&quot;NewsList&quot;&gt;
<span class="gi">+    &lt;li class=&quot;NewsList__item&quot;&gt;</span>
<span class="gi">+      &lt;time class=&quot;NewsList__head&quot; datatime=&quot;2017-2-7&quot;&gt;2017.2.7&lt;/time&gt;</span>
<span class="gi">+      &lt;span class=&quot;NewsList__body&quot;&gt;顧客電話番号管理機能を追加&lt;/span&gt;</span>
<span class="gi">+    &lt;/li&gt;</span>
<span class="w"> </span>    &lt;li class=&quot;NewsList__item&quot;&gt;
<span class="w"> </span>      &lt;time class=&quot;NewsList__head&quot; datatime=&quot;2017-2-4&quot;&gt;2017.2.4&lt;/time&gt;
<span class="w"> </span>      &lt;span class=&quot;NewsList__body&quot;&gt;顧客管理機能を追加&lt;/span&gt;
</code></pre></div>
<h2 id="0322718">コミット: 0322718<a class="headerlink" href="#0322718" title="Permanent link">&para;</a></h2>
<h3 id="_55">メッセージ<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>勤務先電話番号の新規登録、更新、削除 #15
</code></pre></div>
<h3 id="_56">変更されたファイル<a class="headerlink" href="#_56" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_form.rb</li>
<li>M app/views/staff/customers/_work_address_fields.html.erb</li>
</ul>
<h3 id="_57">変更内容<a class="headerlink" href="#_57" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 032271828bbbdbad0ee7302d82a64cd49124caa1
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 13:07:45 2017 +0900

<span class="w"> </span>   勤務先電話番号の新規登録、更新、削除 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 79db94d..05708e9 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -603,6 +603,7 @@ git push heroku master</span>

<span class="w"> </span>#### 演習問題 
<span class="w"> </span>+ 受け入れテスト作成
<span class="gi">++ 勤務先電話番号の新規登録、更新、削除</span>

<span class="w"> </span>### 検索フォーム
<span class="w"> </span>**[⬆ back to top](#構成)**
<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index b66b14d..89ca635 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -17,6 +17,9 @@ class Staff::CustomerForm</span>
<span class="w"> </span>    (2 - @customer.home_address.phones.size).times do
<span class="w"> </span>      @customer.home_address.phones.build
<span class="w"> </span>    end
<span class="gi">+    (2 - @customer.work_address.phones.size).times do</span>
<span class="gi">+      @customer.work_address.phones.build</span>
<span class="gi">+    end</span>
<span class="w"> </span>  end

<span class="w"> </span>  def assign_attributes(params = {})
<span class="gu">@@ -53,6 +56,16 @@ class Staff::CustomerForm</span>
<span class="w"> </span>    end
<span class="w"> </span>    if inputs_work_address
<span class="w"> </span>      customer.work_address.assign_attributes(work_address_params)
<span class="gi">+</span>
<span class="gi">+      phones = phone_params(:work_address).fetch(:phones)</span>
<span class="gi">+      customer.work_address.phones.size.times do |index|</span>
<span class="gi">+        attributes = phones[index.to_s]</span>
<span class="gi">+        if attributes &amp;&amp; attributes[:number].present?</span>
<span class="gi">+          customer.work_address.phones[index].assign_attributes(attributes)</span>
<span class="gi">+        else</span>
<span class="gi">+          customer.work_address.phones[index].mark_for_destruction</span>
<span class="gi">+        end</span>
<span class="gi">+      end</span>
<span class="w"> </span>    else
<span class="w"> </span>      customer.work_address.mark_for_destruction
<span class="w"> </span>    end
<span class="gh">diff --git a/app/views/staff/customers/_work_address_fields.html.erb b/app/views/staff/customers/_work_address_fields.html.erb</span>
<span class="gh">index 102516e..b9e6cd3 100644</span>
<span class="gd">--- a/app/views/staff/customers/_work_address_fields.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_work_address_fields.html.erb</span>
<span class="gu">@@ -8,5 +8,12 @@</span>
<span class="w"> </span>      m &lt;&lt; p.text_field_block(:city, t(&#39;activerecord.attributes.work_address.city&#39;), size: 16)
<span class="w"> </span>      m &lt;&lt; p.text_field_block(:address1, t(&#39;activerecord.attributes.work_address.address1&#39;), size: 40)
<span class="w"> </span>      m &lt;&lt; p.text_field_block(:address2, t(&#39;activerecord.attributes.work_address.address2&#39;), size: 40)
<span class="gi">+      m.div(class: &#39;FormApp__input-block&#39;) do</span>
<span class="gi">+        m.ol do</span>
<span class="gi">+          p.object.phones.each_with_index do |phone, index|</span>
<span class="gi">+            m &lt;&lt; render(&#39;phone_fields&#39;, f: ff, phone: phone, index: index)</span>
<span class="gi">+          end</span>
<span class="gi">+        end</span>
<span class="gi">+      end</span>
<span class="w"> </span>    end %&gt;
<span class="w"> </span>&lt;% end %&gt;
</code></pre></div>
<h2 id="1131f65">コミット: 1131f65<a class="headerlink" href="#1131f65" title="Permanent link">&para;</a></h2>
<h3 id="_58">メッセージ<a class="headerlink" href="#_58" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>受け入れテスト作成 #15
</code></pre></div>
<h3 id="_59">変更されたファイル<a class="headerlink" href="#_59" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/assets/javascripts/staff/customer_form.coffee</li>
<li>M spec/features/staff/customer_management_spec.rb</li>
<li>M spec/features/staff/phone_management_spec.rb</li>
</ul>
<h3 id="_60">変更内容<a class="headerlink" href="#_60" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 1131f654b47bf3571a9b14157df46cdb756064ee
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 13:01:29 2017 +0900

<span class="w"> </span>   受け入れテスト作成 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index ab05df6..79db94d 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -602,6 +602,7 @@ git push heroku master</span>
<span class="w"> </span>+ 自宅電話番号の新規登録、更新、削除

<span class="w"> </span>#### 演習問題 
<span class="gi">++ 受け入れテスト作成</span>

<span class="w"> </span>### 検索フォーム
<span class="w"> </span>**[⬆ back to top](#構成)**
<span class="gh">diff --git a/app/assets/javascripts/staff/customer_form.coffee b/app/assets/javascripts/staff/customer_form.coffee</span>
<span class="gh">index 1d09d38..1c4bf5a 100644</span>
<span class="gd">--- a/app/assets/javascripts/staff/customer_form.coffee</span>
<span class="gi">+++ b/app/assets/javascripts/staff/customer_form.coffee</span>
<span class="gu">@@ -34,7 +34,9 @@ class CustomerForm</span>
<span class="w"> </span>    checked = $(&#39;input#form_inputs_home_address&#39;).prop(&#39;checked&#39;)
<span class="w"> </span>    $(&#39;fieldset#home-address-fields input&#39;).prop(&#39;disabled&#39;, !checked)
<span class="w"> </span>    $(&#39;fieldset#home-address-fields select&#39;).prop(&#39;disabled&#39;, !checked)
<span class="gi">+    $(&#39;fieldset#home-address-fields&#39;).toggle(checked)</span>
<span class="w"> </span>  toggleWorkAddressFields = -&gt;
<span class="w"> </span>    checked = $(&#39;input#form_inputs_work_address&#39;).prop(&#39;checked&#39;)
<span class="w"> </span>    $(&#39;fieldset#work-address-fields input&#39;).prop(&#39;disabled&#39;, !checked)
<span class="gd">-    $(&#39;fieldset#work-address-fields select&#39;).prop(&#39;disabled&#39;, !checked)</span>
\ No newline at end of file
<span class="gi">+    $(&#39;fieldset#work-address-fields select&#39;).prop(&#39;disabled&#39;, !checked)</span>
<span class="gi">+    $(&#39;fieldset#work-address-fields&#39;).toggle(checked)</span>
\ No newline at end of file
<span class="gh">diff --git a/spec/features/staff/customer_management_spec.rb b/spec/features/staff/customer_management_spec.rb</span>
<span class="gh">index 0f4ca36..8aac7ee 100644</span>
<span class="gd">--- a/spec/features/staff/customer_management_spec.rb</span>
<span class="gi">+++ b/spec/features/staff/customer_management_spec.rb</span>
<span class="gu">@@ -108,4 +108,20 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>    expect(page).to have_css(&#39;header span.Flash__alert&#39;)
<span class="w"> </span>    expect(page).to have_css(&#39;.has-error span.help-block&#39;)
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  # 職員が勤務先データのない既存顧客に会社名の情報を追加する</span>
<span class="gi">+  scenario &#39;Staff add company name information to existing customers that do not have work data&#39; do</span>
<span class="gi">+    customer.work_address.destroy</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+    first(&#39;table.Table__body--listing&#39;).click_link I18n.t(&#39;staff.customers.index.edit&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    check I18n.t(&#39;staff.customers.new.work_address_inputs&#39;)</span>
<span class="gi">+    within(&#39;fieldset#work-address-fields&#39;) do</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.company_name&#39;), with: &#39;テスト&#39;</span>
<span class="gi">+    end</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.edit.update&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    customer.reload</span>
<span class="gi">+    expect(customer.work_address.company_name).to eq(&#39;テスト&#39;)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/spec/features/staff/phone_management_spec.rb b/spec/features/staff/phone_management_spec.rb</span>
<span class="gh">index 3c4ec3d..99935f2 100644</span>
<span class="gd">--- a/spec/features/staff/phone_management_spec.rb</span>
<span class="gi">+++ b/spec/features/staff/phone_management_spec.rb</span>
<span class="gu">@@ -38,4 +38,18 @@ feature &#39;Customer telephone number management by staff&#39; do</span>
<span class="w"> </span>    expect(customer.home_address.phones.size).to eq(1)
<span class="w"> </span>    expect(customer.home_address.phones[0].number).to eq(&#39;090-9999-9999&#39;)
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  # 職員が顧客の勤務先電話番号を追加する</span>
<span class="gi">+  scenario &quot;The staff adds the customer&#39;s work phone number&quot; do</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+    first(&#39;table.Table__body--listing&#39;).click_link I18n.t(&#39;staff.customers.index.edit&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    fill_in &#39;form_work_address_phones_0_number&#39;, with: &#39;03-9999-9999&#39;</span>
<span class="gi">+    check &#39;form_work_address_phones_0_primary&#39;</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.edit.update&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    customer.reload</span>
<span class="gi">+    expect(customer.work_address.phones.size).to eq(1)</span>
<span class="gi">+    expect(customer.work_address.phones[0].number).to eq(&#39;03-9999-9999&#39;)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
</code></pre></div>
<h2 id="ff3e2e2">コミット: ff3e2e2<a class="headerlink" href="#ff3e2e2" title="Permanent link">&para;</a></h2>
<h3 id="_61">メッセージ<a class="headerlink" href="#_61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>自宅電話番号の新規登録、更新、削除 #15
</code></pre></div>
<h3 id="_62">変更されたファイル<a class="headerlink" href="#_62" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_form.rb</li>
<li>M app/views/staff/customers/_home_address_fields.html.erb</li>
<li>M spec/features/staff/phone_management_spec.rb</li>
</ul>
<h3 id="_63">変更内容<a class="headerlink" href="#_63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit ff3e2e2f057581a37a7a39ee545befaf0c4d5dd0
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 12:47:49 2017 +0900

<span class="w"> </span>   自宅電話番号の新規登録、更新、削除 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index d0120c4..ab05df6 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -599,6 +599,7 @@ git push heroku master</span>
<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="w"> </span>+ 個人電話番号の入力欄表示
<span class="w"> </span>+ 個人電話番号の新規登録、更新、削除
<span class="gi">++ 自宅電話番号の新規登録、更新、削除</span>

<span class="w"> </span>#### 演習問題 

<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index 8b0845f..b66b14d 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -14,6 +14,9 @@ class Staff::CustomerForm</span>
<span class="w"> </span>    self.inputs_work_address = @customer.work_address.present?
<span class="w"> </span>    @customer.build_home_address unless @customer.home_address
<span class="w"> </span>    @customer.build_work_address unless @customer.work_address
<span class="gi">+    (2 - @customer.home_address.phones.size).times do</span>
<span class="gi">+      @customer.home_address.phones.build</span>
<span class="gi">+    end</span>
<span class="w"> </span>  end

<span class="w"> </span>  def assign_attributes(params = {})
<span class="gu">@@ -35,6 +38,16 @@ class Staff::CustomerForm</span>

<span class="w"> </span>    if inputs_home_address
<span class="w"> </span>      customer.home_address.assign_attributes(home_address_params)
<span class="gi">+</span>
<span class="gi">+      phones = phone_params(:home_address).fetch(:phones)</span>
<span class="gi">+      customer.home_address.phones.size.times do |index|</span>
<span class="gi">+        attributes = phones[index.to_s]</span>
<span class="gi">+        if attributes &amp;&amp; attributes[:number].present?</span>
<span class="gi">+          customer.home_address.phones[index].assign_attributes(attributes)</span>
<span class="gi">+        else</span>
<span class="gi">+          customer.home_address.phones[index].mark_for_destruction</span>
<span class="gi">+        end</span>
<span class="gi">+      end</span>
<span class="w"> </span>    else
<span class="w"> </span>      customer.home_address.mark_for_destruction
<span class="w"> </span>    end
<span class="gh">diff --git a/app/views/staff/customers/_home_address_fields.html.erb b/app/views/staff/customers/_home_address_fields.html.erb</span>
<span class="gh">index 0efe6ee..23aa061 100644</span>
<span class="gd">--- a/app/views/staff/customers/_home_address_fields.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_home_address_fields.html.erb</span>
<span class="gu">@@ -8,5 +8,12 @@</span>
<span class="w"> </span>    m &lt;&lt; q.text_field_block(:address1, t(&#39;activerecord.attributes.home_address.address1&#39;), size: 40)
<span class="w"> </span>  end
<span class="w"> </span>  m &lt;&lt; p.text_field_block(:address2, t(&#39;activerecord.attributes.home_address.address2&#39;), size: 40)
<span class="gi">+  m.div(class: &#39;FormApp__input-block&#39;) do</span>
<span class="gi">+    m.ol do</span>
<span class="gi">+      p.object.phones.each_with_index do |phone, index|</span>
<span class="gi">+        m &lt;&lt; render(&#39;phone_fields&#39;, f: ff, phone: phone, index: index)</span>
<span class="gi">+        end</span>
<span class="gi">+      end</span>
<span class="gi">+    end</span>
<span class="w"> </span>end %&gt;
<span class="w"> </span>&lt;% end %&gt;
<span class="gh">diff --git a/spec/features/staff/phone_management_spec.rb b/spec/features/staff/phone_management_spec.rb</span>
<span class="gh">index 878d9ce..3c4ec3d 100644</span>
<span class="gd">--- a/spec/features/staff/phone_management_spec.rb</span>
<span class="gi">+++ b/spec/features/staff/phone_management_spec.rb</span>
<span class="gu">@@ -24,4 +24,18 @@ feature &#39;Customer telephone number management by staff&#39; do</span>
<span class="w"> </span>    expect(customer.personal_phones.size).to eq(1)
<span class="w"> </span>    expect(customer.personal_phones[0].number).to eq(&#39;090-9999-9999&#39;)
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  # 職員が顧客の自宅電話番号を追加する</span>
<span class="gi">+  scenario &quot;The staff adds the customer&#39;s home phone number&quot; do</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+    first(&#39;table.Table__body--listing&#39;).click_link I18n.t(&#39;staff.customers.index.edit&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    fill_in &#39;form_home_address_phones_0_number&#39;, with: &#39;090-9999-9999&#39;</span>
<span class="gi">+    check &#39;form_home_address_phones_0_primary&#39;</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.edit.update&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    customer.reload</span>
<span class="gi">+    expect(customer.home_address.phones.size).to eq(1)</span>
<span class="gi">+    expect(customer.home_address.phones[0].number).to eq(&#39;090-9999-9999&#39;)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
</code></pre></div>
<h2 id="20fc0ef">コミット: 20fc0ef<a class="headerlink" href="#20fc0ef" title="Permanent link">&para;</a></h2>
<h3 id="_64">メッセージ<a class="headerlink" href="#_64" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>個人電話番号の新規登録、更新、削除 #15
</code></pre></div>
<h3 id="_65">変更されたファイル<a class="headerlink" href="#_65" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_form.rb</li>
<li>A spec/features/staff/phone_management_spec.rb</li>
</ul>
<h3 id="_66">変更内容<a class="headerlink" href="#_66" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 20fc0ef59d3155d8906d8a7b75196cce7f3703d6
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 12:21:22 2017 +0900

<span class="w"> </span>   個人電話番号の新規登録、更新、削除 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 6747cf6..d0120c4 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -598,6 +598,7 @@ git push heroku master</span>

<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="w"> </span>+ 個人電話番号の入力欄表示
<span class="gi">++ 個人電話番号の新規登録、更新、削除</span>

<span class="w"> </span>#### 演習問題 

<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index ca5ed03..8b0845f 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -22,6 +22,17 @@ class Staff::CustomerForm</span>
<span class="w"> </span>    self.inputs_work_address = params[:inputs_work_address] == &#39;1&#39;

<span class="w"> </span>    customer.assign_attributes(customer_params)
<span class="gi">+</span>
<span class="gi">+    phones = phone_params(:customer).fetch(:phones)</span>
<span class="gi">+    customer.personal_phones.size.times do |index|</span>
<span class="gi">+      attributes = phones[index.to_s]</span>
<span class="gi">+      if attributes &amp;&amp; attributes[:number].present?</span>
<span class="gi">+        customer.personal_phones[index].assign_attributes(attributes)</span>
<span class="gi">+      else</span>
<span class="gi">+        customer.personal_phones[index].mark_for_destruction</span>
<span class="gi">+      end</span>
<span class="gi">+    end</span>
<span class="gi">+</span>
<span class="w"> </span>    if inputs_home_address
<span class="w"> </span>      customer.home_address.assign_attributes(home_address_params)
<span class="w"> </span>    else
<span class="gu">@@ -69,4 +80,8 @@ class Staff::CustomerForm</span>
<span class="w"> </span>                                      :division_name
<span class="w"> </span>    )
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  def phone_params(record_name)</span>
<span class="gi">+    @params.require(record_name).permit(phones: [ :number, :primary ])</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/spec/features/staff/phone_management_spec.rb b/spec/features/staff/phone_management_spec.rb</span>
new file mode 100644
<span class="gh">index 0000000..878d9ce</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/spec/features/staff/phone_management_spec.rb</span>
<span class="gu">@@ -0,0 +1,27 @@</span>
<span class="gi">+require &#39;rails_helper&#39;</span>
<span class="gi">+</span>
<span class="gi">+# 職員による顧客電話番号管理</span>
<span class="gi">+feature &#39;Customer telephone number management by staff&#39; do</span>
<span class="gi">+  include FeaturesSpecHelper</span>
<span class="gi">+  let(:staff_member) { create(:staff_member) }</span>
<span class="gi">+  let!(:customer) { create(:customer) }</span>
<span class="gi">+</span>
<span class="gi">+  before do</span>
<span class="gi">+    switch_namespace(:staff)</span>
<span class="gi">+    login_as_staff_member(staff_member)</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  # 職員が顧客の電話番号を追加する</span>
<span class="gi">+  scenario &quot;The staff adds the customer&#39;s phone number&quot; do</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+    first(&#39;table.Table__body--listing&#39;).click_link I18n.t(&#39;staff.customers.index.edit&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    fill_in &#39;form_customer_phones_0_number&#39;, with: &#39;090-9999-9999&#39;</span>
<span class="gi">+    check &#39;form_customer_phones_0_primary&#39;</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.edit.update&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    customer.reload</span>
<span class="gi">+    expect(customer.personal_phones.size).to eq(1)</span>
<span class="gi">+    expect(customer.personal_phones[0].number).to eq(&#39;090-9999-9999&#39;)</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
\ No newline at end of file
</code></pre></div>
<h2 id="052c0ad">コミット: 052c0ad<a class="headerlink" href="#052c0ad" title="Permanent link">&para;</a></h2>
<h3 id="_67">メッセージ<a class="headerlink" href="#_67" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>個人電話番号の入力欄表示 #15
</code></pre></div>
<h3 id="_68">変更されたファイル<a class="headerlink" href="#_68" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_form.rb</li>
<li>M app/presenters/form_presenter.rb</li>
<li>M app/views/staff/customers/_customer_fields.html.erb</li>
<li>A app/views/staff/customers/_phone_fields.html.erb</li>
<li>M config/locales/models/ja.yml</li>
</ul>
<h3 id="_69">変更内容<a class="headerlink" href="#_69" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 052c0ad6c930fef79ef9c99909ecd302815b4217
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Tue Feb 7 11:12:52 2017 +0900

<span class="w"> </span>   個人電話番号の入力欄表示 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 43aae6a..6747cf6 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -597,6 +597,8 @@ git push heroku master</span>
<span class="w"> </span>+ 顧客詳細ページへの電話番号の表示

<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="gi">++ 個人電話番号の入力欄表示</span>
<span class="gi">+</span>
<span class="w"> </span>#### 演習問題 

<span class="w"> </span>### 検索フォーム
<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index acc92b9..ca5ed03 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -7,6 +7,9 @@ class Staff::CustomerForm</span>
<span class="w"> </span>  def initialize(customer = nil)
<span class="w"> </span>    @customer = customer
<span class="w"> </span>    @customer ||= Customer.new(gender: &#39;male&#39;)
<span class="gi">+    (2 - @customer.personal_phones.size).times do</span>
<span class="gi">+      @customer.personal_phones.build</span>
<span class="gi">+    end</span>
<span class="w"> </span>    self.inputs_home_address = @customer.home_address.present?
<span class="w"> </span>    self.inputs_work_address = @customer.work_address.present?
<span class="w"> </span>    @customer.build_home_address unless @customer.home_address
<span class="gh">diff --git a/app/presenters/form_presenter.rb b/app/presenters/form_presenter.rb</span>
<span class="gh">index b825b9a..2695a43 100644</span>
<span class="gd">--- a/app/presenters/form_presenter.rb</span>
<span class="gi">+++ b/app/presenters/form_presenter.rb</span>
<span class="gu">@@ -67,7 +67,6 @@ class FormPresenter</span>
<span class="w"> </span>    end
<span class="w"> </span>  end

<span class="gd">-  private</span>
<span class="w"> </span>  def decorated_label(name, label_text, options = {})
<span class="w"> </span>    label(name, label_text, class: options[:required] ? &#39;AppForm__label required&#39; : &#39;AppForm__label&#39;)
<span class="w"> </span>  end
<span class="gh">diff --git a/app/views/staff/customers/_customer_fields.html.erb b/app/views/staff/customers/_customer_fields.html.erb</span>
<span class="gh">index ea4eb7f..702879f 100644</span>
<span class="gd">--- a/app/views/staff/customers/_customer_fields.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_customer_fields.html.erb</span>
<span class="gu">@@ -9,5 +9,12 @@</span>
<span class="w"> </span>  end
<span class="w"> </span>  m &lt;&lt; p.birthday_field_block(:birthday, t(&#39;activerecord.attributes.customer.birthday&#39;))
<span class="w"> </span>  m &lt;&lt; p.gender_field_block
<span class="gi">+  m.div(class: &#39;AppForm__input-block&#39;) do</span>
<span class="gi">+    m.ol do</span>
<span class="gi">+      p.object.personal_phones.each_with_index do |phone, index|</span>
<span class="gi">+        m &lt;&lt; render(&#39;phone_fields&#39;, f: ff, phone: phone, index: index)</span>
<span class="gi">+      end</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="w"> </span>  end %&gt;
<span class="w"> </span>&lt;% end %&gt;
\ No newline at end of file
<span class="gh">diff --git a/app/views/staff/customers/_phone_fields.html.erb b/app/views/staff/customers/_phone_fields.html.erb</span>
new file mode 100644
<span class="gh">index 0000000..a5f6749</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/app/views/staff/customers/_phone_fields.html.erb</span>
<span class="gu">@@ -0,0 +1,6 @@</span>
<span class="gi">+&lt;%= f.fields_for :phones, phone, index: index do |ff| %&gt;</span>
<span class="gi">+    &lt;%= markup(:li) do |m|</span>
<span class="gi">+      m &lt;&lt; ff.text_field(:number, skip_required: true)</span>
<span class="gi">+      m &lt;&lt; ff.check_box(:primary, label: t(&#39;activerecord.attributes.phone.primary&#39;))</span>
<span class="gi">+      end %&gt;</span>
<span class="gi">+&lt;% end %&gt;</span>
\ No newline at end of file
<span class="gh">diff --git a/config/locales/models/ja.yml b/config/locales/models/ja.yml</span>
<span class="gh">index cf31ec0..b5c2b2f 100644</span>
<span class="gd">--- a/config/locales/models/ja.yml</span>
<span class="gi">+++ b/config/locales/models/ja.yml</span>
<span class="gu">@@ -46,6 +46,7 @@ ja:</span>
<span class="w"> </span>        given_name_kana: 名（カナ）
<span class="w"> </span>        gender: 性別
<span class="w"> </span>        birthday: 誕生日
<span class="gi">+        personal_phone: 電話番号</span>
<span class="w"> </span>        hashed_password: パスワード
<span class="w"> </span>        home_address: 自宅住所
<span class="w"> </span>        work_address: 勤務先
<span class="gu">@@ -77,6 +78,11 @@ ja:</span>
<span class="w"> </span>        company_name: 会社名
<span class="w"> </span>        division_name: 部署名

<span class="gi">+      phone:</span>
<span class="gi">+        number: 電話番号</span>
<span class="gi">+        number_for_index: 索引用電話番号</span>
<span class="gi">+        primary: 優先</span>
<span class="gi">+</span>
<span class="w"> </span>    errors:
<span class="w"> </span>      models:
<span class="w"> </span>        staff_member:
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works/baukis-kai" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>