
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Baukis-Kai project.">
      
      
        <meta name="author" content="Project Team">
      
      
      
        <link rel="prev" href="../20170204/">
      
      
        <link rel="next" href="../20170207/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>20170206 - Baukis-Kai</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2017-02-06" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Baukis-Kai" class="md-header__button md-logo" aria-label="Baukis-Kai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Baukis-Kai
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              20170206
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/baukis-kai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    baukis-kai
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9/" class="md-tabs__link">
        
  
  
    
  
  UseCases

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E6%A6%82%E8%A6%81/" class="md-tabs__link">
        
  
  
    
  
  Architecture

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%AE%9F%E8%A3%85/" class="md-tabs__link">
        
  
  
    
  
  Implementation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../%E7%94%A8%E8%AA%9E%E9%9B%86/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../20170110/" class="md-tabs__link">
          
  
  
  Journal

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Baukis-Kai" class="md-nav__button md-logo" aria-label="Baukis-Kai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Baukis-Kai
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/baukis-kai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    baukis-kai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UseCases
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E6%A6%82%E8%A6%81/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%AE%9F%E8%A3%85/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%94%A8%E8%AA%9E%E9%9B%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Journal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Journal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170110
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170111/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170111
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170114/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170114
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170116/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170116
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170117/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170117
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170118/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170118
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170120/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170120
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170121/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170121
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170123/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170123
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170124/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170124
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170126/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170126
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170127/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170127
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170128/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170128
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170130/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170130
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170131/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170131
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170202
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170203
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170204
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    20170206
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    20170206
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      概要
    </span>
  </a>
  
    <nav class="md-nav" aria-label="概要">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      実装内容の説明
    </span>
  </a>
  
    <nav class="md-nav" aria-label="実装内容の説明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      顧客電話番号の管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      電話番号の正規化と検証
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      アーキテクチャとの関連
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      ユースケースとの関連
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a2f9e37" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: a2f9e37
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: a2f9e37">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4a6edde" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 4a6edde
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 4a6edde">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c30c834" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: c30c834
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: c30c834">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#72fc059" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 72fc059
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 72fc059">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#b31d234" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: b31d234
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: b31d234">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4735944" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 4735944
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 4735944">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#631ce6c" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 631ce6c
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 631ce6c">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac215c0" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: ac215c0
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: ac215c0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a84aa17" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: a84aa17
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: a84aa17">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a5f2cd9" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: a5f2cd9
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: a5f2cd9">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#b69c01b" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: b69c01b
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: b69c01b">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1ce0a35" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 1ce0a35
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 1ce0a35">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#f01cc5c" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: f01cc5c
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: f01cc5c">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#014dfb6" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 014dfb6
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 014dfb6">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#23f580b" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 23f580b
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 23f580b">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#621abf2" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: 621abf2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: 621abf2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    <span class="md-ellipsis">
      構造変更
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d5c3d36" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: d5c3d36
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: d5c3d36">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#b002a0a" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: b002a0a
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: b002a0a">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ce1c09a" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: ce1c09a
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: ce1c09a">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_70" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_71" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a15c7f3" class="md-nav__link">
    <span class="md-ellipsis">
      コミット: a15c7f3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コミット: a15c7f3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_72" class="md-nav__link">
    <span class="md-ellipsis">
      メッセージ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_73" class="md-nav__link">
    <span class="md-ellipsis">
      変更されたファイル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_74" class="md-nav__link">
    <span class="md-ellipsis">
      変更内容
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170207/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170207
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170209/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170209
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170210/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170210
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170213/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170213
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170214/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170214
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170216/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170216
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170220/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170220
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170317/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170317
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170318/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170318
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170325/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170325
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170327/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170327
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20170328/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20170328
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250424/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250424
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250510/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250510
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250607/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250607
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250608/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250608
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250609/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250609
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250610/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250610
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250611/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250611
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20250612/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20250612
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="2017-02-06">作業履歴 2017-02-06<a class="headerlink" href="#2017-02-06" title="Permanent link">&para;</a></h1>
<h2 id="_1">概要<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>2017-02-06の作業内容をまとめています。この日は主に「顧客電話番号の管理」機能の実装を行いました。</p>
<h3 id="_2">実装内容の説明<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<h4 id="_3">顧客電話番号の管理<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>顧客の連絡先情報として電話番号を管理する機能を実装しました。顧客は複数の電話番号（個人電話、自宅電話、勤務先電話など）を持つことができ、それぞれに優先フラグを設定できます。また、電話番号は顧客に直接紐づくだけでなく、住所（自宅・勤務先）にも紐づけることができます。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjY5MHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6ODc5cHg7aGVpZ2h0OjY5MHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDg3OSA2OTAiIHdpZHRoPSI4NzlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzkwMTU7JiMyMzQ1ODsmIzM4NjUxOyYjMzU0NDE7JiMzMDA1ODsmIzIxNDk1OyYjMzE2NDk7JiMyOTcwMjsmIzEyMzk4OyYjMjM0NTU7JiMzNTAxMzs8L3RpdGxlPjxkZWZzLz48Zz48ZyBjbGFzcz0idGl0bGUiIGRhdGEtc291cmNlLWxpbmU9IjEiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTMuOTk5MyIgeD0iMzU1LjU5MTgiIHk9IjIyLjk5NTEiPiYjMzkwMTU7JiMyMzQ1ODsmIzM4NjUxOyYjMzU0NDE7JiMzMDA1ODsmIzIxNDk1OyYjMzE2NDk7JiMyOTcwMjsmIzEyMzk4OyYjMjM0NTU7JiMzNTAxMzs8L3RleHQ+PC9nPjwhLS1jbGFzcyBDdXN0b21lci0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJDdXN0b21lciIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJlbnRpdHlfQ3VzdG9tZXIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTk0LjY3MTkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjIwNi40MDcyIiB4PSIyNDMuNjkiIHk9IjQ0LjI5NjkiLz48ZWxsaXBzZSBjeD0iMzA4LjY0MTciIGN5PSI2MC4yOTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0zMTEuNjEwNCw2NS45Mzc1IFEzMTEuMDMyMyw2Ni4yMzQ0IDMxMC4zOTE3LDY2LjM3NSBRMzA5Ljc1MSw2Ni41MzEzIDMwOS4wNDc5LDY2LjUzMTMgUTMwNi41NDc5LDY2LjUzMTMgMzA1LjIxOTgsNjQuODkwNiBRMzAzLjkwNzMsNjMuMjM0NCAzMDMuOTA3Myw2MC4xMDk0IFEzMDMuOTA3Myw1Ni45ODQ0IDMwNS4yMTk4LDU1LjMyODEgUTMwNi41NDc5LDUzLjY3MTkgMzA5LjA0NzksNTMuNjcxOSBRMzA5Ljc1MSw1My42NzE5IDMxMC4zOTE3LDUzLjgyODEgUTMxMS4wNDc5LDUzLjk4NDQgMzExLjYxMDQsNTQuMjgxMyBMMzExLjYxMDQsNTcgUTMxMC45ODU0LDU2LjQyMTkgMzEwLjM5MTcsNTYuMTU2MyBRMzA5Ljc5NzksNTUuODc1IDMwOS4xNzI5LDU1Ljg3NSBRMzA3LjgyOTIsNTUuODc1IDMwNy4xNDE3LDU2Ljk1MzEgUTMwNi40NTQyLDU4LjAxNTYgMzA2LjQ1NDIsNjAuMTA5NCBRMzA2LjQ1NDIsNjIuMjAzMSAzMDcuMTQxNyw2My4yODEzIFEzMDcuODI5Miw2NC4zNDM4IDMwOS4xNzI5LDY0LjM0MzggUTMwOS43OTc5LDY0LjM0MzggMzEwLjM5MTcsNjQuMDc4MSBRMzEwLjk4NTQsNjMuNzk2OSAzMTEuNjEwNCw2My4yMTg4IEwzMTEuNjEwNCw2NS45Mzc1IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjguMDAzOSIgeD0iMzI5LjE0MTciIHk9IjY1LjE0MzYiPkN1c3RvbWVyPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjI0NC42OSIgeDI9IjQ0OS4wOTcyIiB5MT0iNzYuMjk2OSIgeTI9Ijc2LjI5NjkiLz48ZWxsaXBzZSBjeD0iMjU0LjY5IiBjeT0iODkuOTQ1MyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzIuMDY0NSIgeD0iMjYzLjY5IiB5PSI5My4yOTIiPmlkOiBpbnRlZ2VyPC90ZXh0PjxlbGxpcHNlIGN4PSIyNTQuNjkiIGN5PSIxMDYuMjQyMiIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODcuOTY0OCIgeD0iMjYzLjY5IiB5PSIxMDkuNTg4OSI+ZW1haWw6IHN0cmluZzwvdGV4dD48ZWxsaXBzZSBjeD0iMjU0LjY5IiBjeT0iMTIyLjUzOTEiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzOS4yNjg2IiB4PSIyNjMuNjkiIHk9IjEyNS44ODU3Ij5mYW1pbHlfbmFtZTogc3RyaW5nPC90ZXh0PjxlbGxpcHNlIGN4PSIyNTQuNjkiIGN5PSIxMzguODM1OSIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM0LjYwNjQiIHg9IjI2My42OSIgeT0iMTQyLjE4MjYiPmdpdmVuX25hbWU6IHN0cmluZzwvdGV4dD48ZWxsaXBzZSBjeD0iMjU0LjY5IiBjeT0iMTU1LjEzMjgiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4MC40MDcyIiB4PSIyNjMuNjkiIHk9IjE1OC40Nzk1Ij5mYW1pbHlfbmFtZV9rYW5hOiBzdHJpbmc8L3RleHQ+PGVsbGlwc2UgY3g9IjI1NC42OSIgY3k9IjE3MS40Mjk3IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNzUuNzQ1MSIgeD0iMjYzLjY5IiB5PSIxNzQuNzc2NCI+Z2l2ZW5fbmFtZV9rYW5hOiBzdHJpbmc8L3RleHQ+PGVsbGlwc2UgY3g9IjI1NC42OSIgY3k9IjE4Ny43MjY2IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5OC45ODQ0IiB4PSIyNjMuNjkiIHk9IjE5MS4wNzMyIj5nZW5kZXI6IHN0cmluZzwvdGV4dD48ZWxsaXBzZSBjeD0iMjU0LjY5IiBjeT0iMjA0LjAyMzQiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk5LjM4MDkiIHg9IjI2My42OSIgeT0iMjA3LjM3MDEiPmJpcnRoZGF5OiBkYXRlPC90ZXh0PjxlbGxpcHNlIGN4PSIyNTQuNjkiIGN5PSIyMjAuMzIwMyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc0LjE4NjUiIHg9IjI2My42OSIgeT0iMjIzLjY2NyI+aGFzaGVkX3Bhc3N3b3JkOiBzdHJpbmc8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjQ0LjY5IiB4Mj0iNDQ5LjA5NzIiIHkxPSIyMzAuOTY4OCIgeTI9IjIzMC45Njg4Ii8+PC9nPjwhLS1jbGFzcyBBZGRyZXNzLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkFkZHJlc3MiIGRhdGEtc291cmNlLWxpbmU9IjE1IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9BZGRyZXNzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjE3OC4zNzUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE3MC45OTAyIiB4PSI0MTUuNCIgeT0iMjk4Ljk2NjkiLz48ZWxsaXBzZSBjeD0iNDY4LjQ5MTMiIGN5PSIzMTQuOTY2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNNDcxLjQ2MDEsMzIwLjYwNzUgUTQ3MC44ODE5LDMyMC45MDQ0IDQ3MC4yNDEzLDMyMS4wNDUgUTQ2OS42MDA3LDMyMS4yMDEzIDQ2OC44OTc2LDMyMS4yMDEzIFE0NjYuMzk3NiwzMjEuMjAxMyA0NjUuMDY5NCwzMTkuNTYwNiBRNDYzLjc1NjksMzE3LjkwNDQgNDYzLjc1NjksMzE0Ljc3OTQgUTQ2My43NTY5LDMxMS42NTQ0IDQ2NS4wNjk0LDMwOS45OTgxIFE0NjYuMzk3NiwzMDguMzQxOSA0NjguODk3NiwzMDguMzQxOSBRNDY5LjYwMDcsMzA4LjM0MTkgNDcwLjI0MTMsMzA4LjQ5ODEgUTQ3MC44OTc2LDMwOC42NTQ0IDQ3MS40NjAxLDMwOC45NTEzIEw0NzEuNDYwMSwzMTEuNjcgUTQ3MC44MzUxLDMxMS4wOTE5IDQ3MC4yNDEzLDMxMC44MjYzIFE0NjkuNjQ3NiwzMTAuNTQ1IDQ2OS4wMjI2LDMxMC41NDUgUTQ2Ny42Nzg4LDMxMC41NDUgNDY2Ljk5MTMsMzExLjYyMzEgUTQ2Ni4zMDM4LDMxMi42ODU2IDQ2Ni4zMDM4LDMxNC43Nzk0IFE0NjYuMzAzOCwzMTYuODczMSA0NjYuOTkxMywzMTcuOTUxMyBRNDY3LjY3ODgsMzE5LjAxMzggNDY5LjAyMjYsMzE5LjAxMzggUTQ2OS42NDc2LDMxOS4wMTM4IDQ3MC4yNDEzLDMxOC43NDgxIFE0NzAuODM1MSwzMTguNDY2OSA0NzEuNDYwMSwzMTcuODg4OCBMNDcxLjQ2MDEsMzIwLjYwNzUgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Ni4zMDc2IiB4PSI0ODguOTkxMyIgeT0iMzE5LjgxMzYiPkFkZHJlc3M8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNDE2LjQiIHgyPSI1ODUuMzkwMiIgeTE9IjMzMC45NjY5IiB5Mj0iMzMwLjk2NjkiLz48ZWxsaXBzZSBjeD0iNDI2LjQiIGN5PSIzNDQuNjE1MyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzIuMDY0NSIgeD0iNDM1LjQiIHk9IjM0Ny45NjIiPmlkOiBpbnRlZ2VyPC90ZXh0PjxlbGxpcHNlIGN4PSI0MjYuNCIgY3k9IjM2MC45MTIyIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNDQuOTkwMiIgeD0iNDM1LjQiIHk9IjM2NC4yNTg5Ij5jdXN0b21lcl9pZDogaW50ZWdlcjwvdGV4dD48ZWxsaXBzZSBjeD0iNDI2LjQiIGN5PSIzNzcuMjA5MSIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODAuNjI5OSIgeD0iNDM1LjQiIHk9IjM4MC41NTU3Ij50eXBlOiBzdHJpbmc8L3RleHQ+PGVsbGlwc2UgY3g9IjQyNi40IiBjeT0iMzkzLjUwNTkiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMi44MjIzIiB4PSI0MzUuNCIgeT0iMzk2Ljg1MjYiPnBvc3RhbF9jb2RlOiBzdHJpbmc8L3RleHQ+PGVsbGlwc2UgY3g9IjQyNi40IiBjeT0iNDA5LjgwMjgiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyMi41ODIiIHg9IjQzNS40IiB5PSI0MTMuMTQ5NSI+cHJlZmVjdHVyZTogc3RyaW5nPC90ZXh0PjxlbGxpcHNlIGN4PSI0MjYuNCIgY3k9IjQyNi4wOTk3IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NC43MTY4IiB4PSI0MzUuNCIgeT0iNDI5LjQ0NjQiPmNpdHk6IHN0cmluZzwvdGV4dD48ZWxsaXBzZSBjeD0iNDI2LjQiIGN5PSI0NDIuMzk2NiIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEzLjU3MjMiIHg9IjQzNS40IiB5PSI0NDUuNzQzMiI+YWRkcmVzczE6IHN0cmluZzwvdGV4dD48ZWxsaXBzZSBjeD0iNDI2LjQiIGN5PSI0NTguNjkzNCIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEzLjU3MjMiIHg9IjQzNS40IiB5PSI0NjIuMDQwMSI+YWRkcmVzczI6IHN0cmluZzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI0MTYuNCIgeDI9IjU4NS4zOTAyIiB5MT0iNDY5LjM0MTkiIHkyPSI0NjkuMzQxOSIvPjwvZz48IS0tY2xhc3MgSG9tZUFkZHJlc3MtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iSG9tZUFkZHJlc3MiIGRhdGEtc291cmNlLWxpbmU9IjI2IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9Ib21lQWRkcmVzcyI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0OCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTI5LjY1MTQiIHg9IjUyMS4wNyIgeT0iNTg2LjIzNjkiLz48ZWxsaXBzZSBjeD0iNTM2LjA3IiBjeT0iNjAyLjIzNjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTUzOS4wMzg4LDYwNy44Nzc1IFE1MzguNDYwNiw2MDguMTc0NCA1MzcuODIsNjA4LjMxNSBRNTM3LjE3OTQsNjA4LjQ3MTMgNTM2LjQ3NjMsNjA4LjQ3MTMgUTUzMy45NzYzLDYwOC40NzEzIDUzMi42NDgxLDYwNi44MzA2IFE1MzEuMzM1Niw2MDUuMTc0NCA1MzEuMzM1Niw2MDIuMDQ5NCBRNTMxLjMzNTYsNTk4LjkyNDQgNTMyLjY0ODEsNTk3LjI2ODEgUTUzMy45NzYzLDU5NS42MTE5IDUzNi40NzYzLDU5NS42MTE5IFE1MzcuMTc5NCw1OTUuNjExOSA1MzcuODIsNTk1Ljc2ODEgUTUzOC40NzYzLDU5NS45MjQ0IDUzOS4wMzg4LDU5Ni4yMjEzIEw1MzkuMDM4OCw1OTguOTQgUTUzOC40MTM4LDU5OC4zNjE5IDUzNy44Miw1OTguMDk2MyBRNTM3LjIyNjMsNTk3LjgxNSA1MzYuNjAxMyw1OTcuODE1IFE1MzUuMjU3NSw1OTcuODE1IDUzNC41Nyw1OTguODkzMSBRNTMzLjg4MjUsNTk5Ljk1NTYgNTMzLjg4MjUsNjAyLjA0OTQgUTUzMy44ODI1LDYwNC4xNDMxIDUzNC41Nyw2MDUuMjIxMyBRNTM1LjI1NzUsNjA2LjI4MzggNTM2LjYwMTMsNjA2LjI4MzggUTUzNy4yMjYzLDYwNi4yODM4IDUzNy44Miw2MDYuMDE4MSBRNTM4LjQxMzgsNjA1LjczNjkgNTM5LjAzODgsNjA1LjE1ODggTDUzOS4wMzg4LDYwNy44Nzc1IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuNjUxNCIgeD0iNTUwLjA3IiB5PSI2MDcuMDgzNiI+SG9tZUFkZHJlc3M8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTIyLjA3IiB4Mj0iNjQ5LjcyMTQiIHkxPSI2MTguMjM2OSIgeTI9IjYxOC4yMzY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTIyLjA3IiB4Mj0iNjQ5LjcyMTQiIHkxPSI2MjYuMjM2OSIgeTI9IjYyNi4yMzY5Ii8+PC9nPjwhLS1jbGFzcyBXb3JrQWRkcmVzcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJXb3JrQWRkcmVzcyIgZGF0YS1zb3VyY2UtbGluZT0iMjkiIGRhdGEtdWlkPSJlbnQwMDA1IiBpZD0iZW50aXR5X1dvcmtBZGRyZXNzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjgwLjU5MzgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE4Ni41ODMiIHg9IjY4NS42IiB5PSI1NjkuOTM2OSIvPjxlbGxpcHNlIGN4PSI3MjguNTAxOCIgY3k9IjU4NS45MzY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik03MzEuNDcwNSw1OTEuNTc3NSBRNzMwLjg5MjQsNTkxLjg3NDQgNzMwLjI1MTgsNTkyLjAxNSBRNzI5LjYxMTEsNTkyLjE3MTMgNzI4LjkwOCw1OTIuMTcxMyBRNzI2LjQwOCw1OTIuMTcxMyA3MjUuMDc5OSw1OTAuNTMwNiBRNzIzLjc2NzQsNTg4Ljg3NDQgNzIzLjc2NzQsNTg1Ljc0OTQgUTcyMy43Njc0LDU4Mi42MjQ0IDcyNS4wNzk5LDU4MC45NjgxIFE3MjYuNDA4LDU3OS4zMTE5IDcyOC45MDgsNTc5LjMxMTkgUTcyOS42MTExLDU3OS4zMTE5IDczMC4yNTE4LDU3OS40NjgxIFE3MzAuOTA4LDU3OS42MjQ0IDczMS40NzA1LDU3OS45MjEzIEw3MzEuNDcwNSw1ODIuNjQgUTczMC44NDU1LDU4Mi4wNjE5IDczMC4yNTE4LDU4MS43OTYzIFE3MjkuNjU4LDU4MS41MTUgNzI5LjAzMyw1ODEuNTE1IFE3MjcuNjg5Myw1ODEuNTE1IDcyNy4wMDE4LDU4Mi41OTMxIFE3MjYuMzE0Myw1ODMuNjU1NiA3MjYuMzE0Myw1ODUuNzQ5NCBRNzI2LjMxNDMsNTg3Ljg0MzEgNzI3LjAwMTgsNTg4LjkyMTMgUTcyNy42ODkzLDU4OS45ODM4IDcyOS4wMzMsNTg5Ljk4MzggUTcyOS42NTgsNTg5Ljk4MzggNzMwLjI1MTgsNTg5LjcxODEgUTczMC44NDU1LDU4OS40MzY5IDczMS40NzA1LDU4OC44NTg4IEw3MzEuNDcwNSw1OTEuNTc3NSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkyLjU3OTEiIHg9Ijc0OC43MDIxIiB5PSI1OTAuNzgzNiI+V29ya0FkZHJlc3M8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNjg2LjYiIHgyPSI4NzEuMTgzIiB5MT0iNjAxLjkzNjkiIHkyPSI2MDEuOTM2OSIvPjxlbGxpcHNlIGN4PSI2OTYuNiIgY3k9IjYxNS41ODUzIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjAuNTgzIiB4PSI3MDUuNiIgeT0iNjE4LjkzMiI+Y29tcGFueV9uYW1lOiBzdHJpbmc8L3RleHQ+PGVsbGlwc2UgY3g9IjY5Ni42IiBjeT0iNjMxLjg4MjIiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0OS42MzE4IiB4PSI3MDUuNiIgeT0iNjM1LjIyODkiPmRpdmlzaW9uX25hbWU6IHN0cmluZzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI2ODYuNiIgeDI9Ijg3MS4xODMiIHkxPSI2NDIuNTMwNiIgeTI9IjY0Mi41MzA2Ii8+PC9nPjwhLS1jbGFzcyBQaG9uZS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJQaG9uZSIgZGF0YS1zb3VyY2UtbGluZT0iMzQiIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X1Bob25lIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjE0NS43ODEzIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMDEuNzkzIiB4PSI3IiB5PSI1MzcuMzQ2OSIvPjxlbGxpcHNlIGN4PSI4MS45NjI5IiBjeT0iNTUzLjM0NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTg0LjkzMTYsNTU4Ljk4NzUgUTg0LjM1MzUsNTU5LjI4NDQgODMuNzEyOSw1NTkuNDI1IFE4My4wNzIzLDU1OS41ODEzIDgyLjM2OTEsNTU5LjU4MTMgUTc5Ljg2OTEsNTU5LjU4MTMgNzguNTQxLDU1Ny45NDA2IFE3Ny4yMjg1LDU1Ni4yODQ0IDc3LjIyODUsNTUzLjE1OTQgUTc3LjIyODUsNTUwLjAzNDQgNzguNTQxLDU0OC4zNzgxIFE3OS44NjkxLDU0Ni43MjE5IDgyLjM2OTEsNTQ2LjcyMTkgUTgzLjA3MjMsNTQ2LjcyMTkgODMuNzEyOSw1NDYuODc4MSBRODQuMzY5MSw1NDcuMDM0NCA4NC45MzE2LDU0Ny4zMzEzIEw4NC45MzE2LDU1MC4wNSBRODQuMzA2Niw1NDkuNDcxOSA4My43MTI5LDU0OS4yMDYzIFE4My4xMTkxLDU0OC45MjUgODIuNDk0MSw1NDguOTI1IFE4MS4xNTA0LDU0OC45MjUgODAuNDYyOSw1NTAuMDAzMSBRNzkuNzc1NCw1NTEuMDY1NiA3OS43NzU0LDU1My4xNTk0IFE3OS43NzU0LDU1NS4yNTMxIDgwLjQ2MjksNTU2LjMzMTMgUTgxLjE1MDQsNTU3LjM5MzggODIuNDk0MSw1NTcuMzkzOCBRODMuMTE5MSw1NTcuMzkzOCA4My43MTI5LDU1Ny4xMjgxIFE4NC4zMDY2LDU1Ni44NDY5IDg0LjkzMTYsNTU2LjI2ODggTDg0LjkzMTYsNTU4Ljk4NzUgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0My4zNjcyIiB4PSIxMDIuNDYyOSIgeT0iNTU4LjE5MzYiPlBob25lPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjgiIHgyPSIyMDcuNzkzIiB5MT0iNTY5LjM0NjkiIHkyPSI1NjkuMzQ2OSIvPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjU4Mi45OTUzIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3Mi4wNjQ1IiB4PSIyNyIgeT0iNTg2LjM0MiI+aWQ6IGludGVnZXI8L3RleHQ+PGVsbGlwc2UgY3g9IjE4IiBjeT0iNTk5LjI5MjIiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0NC45OTAyIiB4PSIyNyIgeT0iNjAyLjYzODkiPmN1c3RvbWVyX2lkOiBpbnRlZ2VyPC90ZXh0PjxlbGxpcHNlIGN4PSIxOCIgY3k9IjYxNS41ODkxIiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzQuMzc0IiB4PSIyNyIgeT0iNjE4LjkzNTciPmFkZHJlc3NfaWQ6IGludGVnZXI8L3RleHQ+PGVsbGlwc2UgY3g9IjE4IiBjeT0iNjMxLjg4NTkiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMy45OTUxIiB4PSIyNyIgeT0iNjM1LjIzMjYiPm51bWJlcjogc3RyaW5nPC90ZXh0PjxlbGxpcHNlIGN4PSIxOCIgY3k9IjY0OC4xODI4IiBmaWxsPSJub25lIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNzUuNzkzIiB4PSIyNyIgeT0iNjUxLjUyOTUiPm51bWJlcl9mb3JfaW5kZXg6IHN0cmluZzwvdGV4dD48ZWxsaXBzZSBjeD0iMTgiIGN5PSI2NjQuNDc5NyIgZmlsbD0ibm9uZSIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE5LjkyOTciIHg9IjI3IiB5PSI2NjcuODI2NCI+cHJpbWFyeTogYm9vbGVhbjwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI4IiB4Mj0iMjA3Ljc5MyIgeTE9IjY3NS4xMjgxIiB5Mj0iNjc1LjEyODEiLz48L2c+PHBhdGggZD0iTTI0My45LDU2Ny41MzY5IEwyNDMuOSw1ODMuNjY5NyBMMjAyLjc5Myw2NDYuNjgyOCBMMjQzLjksNTkxLjY2OTcgTDI0My45LDYwNy44MDI1IEEwLDAgMCAwIDAgMjQzLjksNjA3LjgwMjUgTDQ0Ni45MDAyLDYwNy44MDI1IEEwLDAgMCAwIDAgNDQ2LjkwMDIsNjA3LjgwMjUgTDQ0Ni45MDAyLDU3Ny41MzY5IEw0MzYuOTAwMiw1NjcuNTM2OSBMMjQzLjksNTY3LjUzNjkgQTAsMCAwIDAgMCAyNDMuOSw1NjcuNTM2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTQzNi45MDAyLDU2Ny41MzY5IEw0MzYuOTAwMiw1NzcuNTM2OSBMNDQ2LjkwMDIsNTc3LjUzNjkgTDQzNi45MDAyLDU2Ny41MzY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxODIuMDAwMiIgeD0iMjQ5LjkiIHk9IjU4NC42MDM4Ij4mIzI2OTA4OyYjMzIwMzQ7JiMyOTk5MjsmIzEyMzk1OyYjMjc0OTE7JiMzNTIxNTsmIzIxMjcwOyYjMTIzNzM7JiMxMjQyODsmIzEyMzgzOyYjMzg2NTE7JiMzNTQ0MTsmIzMwMDU4OyYjMjE0OTU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4Mi4wMDAyIiB4PSIyNDkuOSIgeT0iNTk5LjczNjYiPiYjNjUyODg7JiMxMjQ5NTsmIzEyNDUyOyYjMTI1MDE7JiMxMjUzMTsmIzEyMzk0OyYjMTIzOTM7JiMxMjM5ODsmIzM1MzUyOyYjMjE0OTU7JiMxMjQzNDsmIzM4NTAwOyYjMjE0MzU7JiM2NTI4OTs8L3RleHQ+PHBhdGggZD0iTTI0My45LDYxNy44MDI1IEwyNDMuOSw2MjYuMzY4OSBMMTQ2LjkyOTcsNjYyLjk3OTcgTDI0My45LDYzNC4zNjg5IEwyNDMuOSw2NDIuOTM1MyBBMCwwIDAgMCAwIDI0My45LDY0Mi45MzUzIEw0ODUuOTAwMyw2NDIuOTM1MyBBMCwwIDAgMCAwIDQ4NS45MDAzLDY0Mi45MzUzIEw0ODUuOTAwMyw2MjcuODAyNSBMNDc1LjkwMDMsNjE3LjgwMjUgTDI0My45LDYxNy44MDI1IEEwLDAgMCAwIDAgMjQzLjksNjE3LjgwMjUiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik00NzUuOTAwMyw2MTcuODAyNSBMNDc1LjkwMDMsNjI3LjgwMjUgTDQ4NS45MDAzLDYyNy44MDI1IEw0NzUuOTAwMyw2MTcuODAyNSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjIxLjAwMDMiIHg9IjI0OS45IiB5PSI2MzQuODY5NCI+JiMyMDc3ODsmIzIwODA4OyYjMTI1MDE7JiMxMjUyMTsmIzEyNDY0OyYjNjUyODg7JiMyMDAyNzsmIzEyMzk0OyYjMzY4OTk7JiMzMjA5NzsmIzIwODA4OyYjMTIzOTI7JiMxMjM3NTsmIzEyMzkwOyYjMjAzNTE7JiMyOTk5MjsmIzY1Mjg5OzwvdGV4dD48IS0tbGluayBDdXN0b21lciB0byBQaG9uZS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJDdXN0b21lciIgZGF0YS1lbnRpdHktMj0iUGhvbmUiIGRhdGEtc291cmNlLWxpbmU9IjQzIiBkYXRhLXVpZD0ibG5rNyIgaWQ9ImxpbmtfQ3VzdG9tZXJfUGhvbmUiPjxwYXRoIGNvZGVMaW5lPSI0MyIgZD0iTTI5Ny4zOCwyMzkuMzE2OSBDMjUxLjk4LDMyNy45MzY5IDE4NS43OSw0NTcuMTY2OSAxNDQuODYsNTM3LjA3NjkiIGZpbGw9Im5vbmUiIGlkPSJDdXN0b21lci1QaG9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjguMjcxIiB4PSIyODUuNDYiIHk9IjI1OS4xMTMxIj4xPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIzLjAzNTYiIHg9IjEyNC4zNjgzIiB5PSI1MjYuMjEwMyI+MC4uKjwvdGV4dD48L2c+PCEtLWxpbmsgQ3VzdG9tZXIgdG8gQWRkcmVzcy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJDdXN0b21lciIgZGF0YS1lbnRpdHktMj0iQWRkcmVzcyIgZGF0YS1zb3VyY2UtbGluZT0iNDQiIGRhdGEtdWlkPSJsbms4IiBpZD0ibGlua19DdXN0b21lcl9BZGRyZXNzIj48cGF0aCBjb2RlTGluZT0iNDQiIGQ9Ik00MDcuNzYsMjM5LjI3NjkgQzQyMC4xMiwyNTguODk2OSA0MzMuMDYsMjc5LjQ0NjkgNDQ1LjIzLDI5OC43NjY5IiBmaWxsPSJub25lIiBpZD0iQ3VzdG9tZXItQWRkcmVzcyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjguMjcxIiB4PSI0MDMuOTQ2MSIgeT0iMjU5LjA3MDIiPjE8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjMuMDM1NiIgeD0iNDE2LjY2OTQiIHk9IjI4Ny44MTU4Ij4wLi4qPC90ZXh0PjwvZz48IS0tcmV2ZXJzZSBsaW5rIEFkZHJlc3MgdG8gSG9tZUFkZHJlc3MtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQWRkcmVzcyIgZGF0YS1lbnRpdHktMj0iSG9tZUFkZHJlc3MiIGRhdGEtc291cmNlLWxpbmU9IjQ1IiBkYXRhLXVpZD0ibG5rOSIgaWQ9ImxpbmtfQWRkcmVzc19Ib21lQWRkcmVzcyI+PHBhdGggY29kZUxpbmU9IjQ1IiBkPSJNNTQxLjU4Nyw0OTQuNTA3MyBDNTU2LjgxNyw1MzMuOTI3MyA1NjcuMDMsNTYwLjM3NjkgNTc2Ljk4LDU4Ni4xMzY5IiBmaWxsPSJub25lIiBpZD0iQWRkcmVzcy1iYWNrdG8tSG9tZUFkZHJlc3MiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjUzNS4xLDQ3Ny43MTY5LDUzNS45OTAyLDQ5Ni42Njk2LDU0Ny4xODM4LDQ5Mi4zNDUsNTM1LjEsNDc3LjcxNjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLXJldmVyc2UgbGluayBBZGRyZXNzIHRvIFdvcmtBZGRyZXNzLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkFkZHJlc3MiIGRhdGEtZW50aXR5LTI9IldvcmtBZGRyZXNzIiBkYXRhLXNvdXJjZS1saW5lPSI0NiIgZGF0YS11aWQ9ImxuazEwIiBpZD0ibGlua19BZGRyZXNzX1dvcmtBZGRyZXNzIj48cGF0aCBjb2RlTGluZT0iNDYiIGQ9Ik02MDAuNjgzNCw0NjguMTU4OCBDNjQ3LjI3MzQsNTA1LjAzODggNjg5LjE2LDUzOC4xOTY5IDcyOC42OSw1NjkuNDg2OSIgZmlsbD0ibm9uZSIgaWQ9IkFkZHJlc3MtYmFja3RvLVdvcmtBZGRyZXNzIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSI1ODYuNTcsNDU2Ljk4NjksNTk2Ljk1OTQsNDcyLjg2MzMsNjA0LjQwNzQsNDYzLjQ1NDQsNTg2LjU3LDQ1Ni45ODY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIEFkZHJlc3MgdG8gUGhvbmUtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQWRkcmVzcyIgZGF0YS1lbnRpdHktMj0iUGhvbmUiIGRhdGEtc291cmNlLWxpbmU9IjQ3IiBkYXRhLXVpZD0ibG5rMTEiIGlkPSJsaW5rX0FkZHJlc3NfUGhvbmUiPjxwYXRoIGNvZGVMaW5lPSI0NyIgZD0iTTQxNS4wOSw0MzMuODk2OSBDMzYwLjUyLDQ2Mi43MTY5IDI4OC41OCw1MDEuMzk2OSAyMjUuOSw1MzcuMzQ2OSBDMjIwLjM4LDU0MC41MDY5IDIxNC43NCw1NDMuNzg2OSAyMDkuMDcsNTQ3LjEyNjkiIGZpbGw9Im5vbmUiIGlkPSJBZGRyZXNzLVBob25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQuODA2NiIgeD0iMzgyLjcxOTUiIHk9IjQzNC4yNTU5Ij4wLi4xPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIzLjAzNTYiIHg9IjIxNi42NDE0IiB5PSI1MzkuNDU0MSI+MC4uKjwvdGV4dD48L2c+PCEtLVNSQz1bWkxEMVFuRDE2QnRGaG5Yb0RCSE9adWlOeVVCSGN5VGJpbENiRXRIdDlpbkVnZzRBUmNBYkdaNFlIWXFBOUtzZUpTSkdlYjhYNU5fQ1RCbDlnTl8xWUthdGFzcUJkZlJsbE0tX3h4cXRDdWdmMEYyYXlvS1B4YXktWlNSenV4R3pJNWVkd1IySmxkY2Z1czRvdDFqdGpuM28wWDk1LTd1aktZODRZSlRIYUw0N0N3d1cwWDhMOElHaVM3MmE5RUNMTDJvSmEwTHJidkNHNWMyNVJHM0ZPTFFaa3F1dWtRdXhKbTJkODFUcllLZGJLcjl0QzJLQUtENGRhR19LaEhnelp1TWFNVUVwSW5GdEE5TFdsZGFGdGpvU2t1SWdVak5JTW5NSDhlN2gyTWczNGloV2dQZ3FDOC1mLWc4WWl2TGhMdjB4TC1LekMxZU00WkZ1YVAzaGJkOUZYNU4yeW41SmppNFk5ZDhmUHBDVS1lQjNWX2dVMnJtNlVJcWlzVGRGUWhTaXBDX2NMOXhPY1IyR0kxRDFJT1cwMjktQW82dkZPUXMwTHJQbXVWUmd3Z3QySkRMRHZEbW9raEgtendkWGg4WU0ySWthWjlXRWtjT1Z1YTgxYmdwWUFvcEFDejFueWVSR1VVenAtY0NfVk5VZXV3X2R0eGhaV3JRb3lyeDdSVHRPcVY2VV9NSkduVWNzUmhQcWV3VVJSVHR5aGtFMVpsbGMyT3FGRm5mUUR6dkVUZGw5d3o3NXdJamFoWjJVeGh6MW5KbXliQm1POTVsUl95UnJUVUY4QjNaeERKOXA5eS14d1NfRWI4Z0RoV3l3RlpaeF9TVGVqNFZfMUcwMF0tLT48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h4 id="_4">電話番号の正規化と検証<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>電話番号は入力形式が多様なため、保存前に正規化処理を行います。また、電話番号形式の検証も実装し、不正な形式の電話番号が登録されないようにしています。</p>
<h3 id="_5">アーキテクチャとの関連<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>この実装は、<a href="../../%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E6%A6%82%E8%A6%81/">アーキテクチャ概要</a>の「5. 主要なデータモデル」セクションに記載されている顧客と電話番号のモデル関連を実現するものです。特に以下の部分に関連しています：</p>
<div class="highlight"><pre><span></span><code>Customer ||--o{ Phone
</code></pre></div>
<p>また、「7.1 値の正規化とバリデーション」の実装例としても位置づけられます。</p>
<h3 id="_6">ユースケースとの関連<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>この実装は、<a href="../../%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9/">ユースケース</a>の「3.2. 顧客管理」セクションに記載されている以下のユースケースをサポートします：</p>
<ul>
<li>S-004: 顧客情報登録</li>
<li>S-006: 顧客情報更新</li>
</ul>
<p>これにより、職員は顧客の連絡先情報として複数の電話番号を管理できるようになります。</p>
<h2 id="a2f9e37">コミット: a2f9e37<a class="headerlink" href="#a2f9e37" title="Permanent link">&para;</a></h2>
<h3 id="_7">メッセージ<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>顧客詳細ページへの電話番号の表示 #15
</code></pre></div>
<h3 id="_8">変更されたファイル<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>A app/models/phone.rb</li>
<li>A db/migrate/20170206085929_create_phones.rb</li>
<li>A spec/factories/phones.rb</li>
</ul>
<h3 id="_9">変更内容<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit a2f9e37965f00d1ebe55bf0a2cfc959c9d07ede7
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 20:19:37 2017 +0900

<span class="w"> </span>   顧客詳細ページへの電話番号の表示 #15

<span class="gh">diff --git a/app/models/phone.rb b/app/models/phone.rb</span>
new file mode 100644
<span class="gh">index 0000000..386e689</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/app/models/phone.rb</span>
<span class="gu">@@ -0,0 +1,37 @@</span>
<span class="gi">+# == Schema Information</span>
<span class="gi">+#</span>
<span class="gi">+# Table name: phones # 電話</span>
<span class="gi">+#</span>
<span class="gi">+#  id               :integer          not null, primary key</span>
<span class="gi">+#  customer_id      :integer          not null               # 顧客への外部キー</span>
<span class="gi">+#  address_id       :integer                                 # 住所への外部キー</span>
<span class="gi">+#  number           :string(255)      not null               # 電話番号</span>
<span class="gi">+#  number_for_index :string(255)      not null               # 索引用電話番号</span>
<span class="gi">+#  primary          :boolean          default(&quot;0&quot;), not null # 優先フラグ</span>
<span class="gi">+#  created_at       :datetime         not null</span>
<span class="gi">+#  updated_at       :datetime         not null</span>
<span class="gi">+#</span>
<span class="gi">+# Indexes</span>
<span class="gi">+#</span>
<span class="gi">+#  index_phones_on_address_id        (address_id)</span>
<span class="gi">+#  index_phones_on_customer_id       (customer_id)</span>
<span class="gi">+#  index_phones_on_number_for_index  (number_for_index)</span>
<span class="gi">+#</span>
<span class="gi">+</span>
<span class="gi">+class Phone &lt; ApplicationRecord</span>
<span class="gi">+  include StringNormalizer</span>
<span class="gi">+</span>
<span class="gi">+  belongs_to :customer</span>
<span class="gi">+  belongs_to :address</span>
<span class="gi">+</span>
<span class="gi">+  before_validation do</span>
<span class="gi">+    self.number = normalize_as_phone_number(number)</span>
<span class="gi">+    self.number_for_index = number.gsub(/\D/, &#39;&#39;) if number</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  before_create do</span>
<span class="gi">+    self.customer = address.customer if address</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  validates :number, presence: true, format: { with: /\A\+?\d+(-\d+)*\z/, allow_blank: true }</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/db/migrate/20170206085929_create_phones.rb b/db/migrate/20170206085929_create_phones.rb</span>
new file mode 100644
<span class="gh">index 0000000..f9f0714</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/db/migrate/20170206085929_create_phones.rb</span>
<span class="gu">@@ -0,0 +1,17 @@</span>
<span class="gi">+class CreatePhones &lt; ActiveRecord::Migration[5.0]</span>
<span class="gi">+  def change</span>
<span class="gi">+    create_table :phones,comment:&#39;電話&#39; do |t|</span>
<span class="gi">+      t.references :customer, null: false, comment: &#39;顧客への外部キー&#39;</span>
<span class="gi">+      t.references :address, comment: &#39;住所への外部キー&#39;</span>
<span class="gi">+      t.string :number, null: false, comment: &#39;電話番号&#39;</span>
<span class="gi">+      t.string :number_for_index, null: false, comment: &#39;索引用電話番号&#39;</span>
<span class="gi">+      t.boolean :primary,   null: false, default: false, comment: &#39;優先フラグ&#39;</span>
<span class="gi">+</span>
<span class="gi">+      t.timestamps</span>
<span class="gi">+    end</span>
<span class="gi">+</span>
<span class="gi">+    add_index :phones, :number_for_index</span>
<span class="gi">+    add_foreign_key :phones, :customers</span>
<span class="gi">+    add_foreign_key :phones, :addresses</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
<span class="gh">diff --git a/spec/factories/phones.rb b/spec/factories/phones.rb</span>
new file mode 100644
<span class="gh">index 0000000..4ef34b3</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/spec/factories/phones.rb</span>
<span class="gu">@@ -0,0 +1,25 @@</span>
<span class="gi">+# == Schema Information</span>
<span class="gi">+#</span>
<span class="gi">+# Table name: phones # 電話</span>
<span class="gi">+#</span>
<span class="gi">+#  id               :integer          not null, primary key</span>
<span class="gi">+#  customer_id      :integer          not null               # 顧客への外部キー</span>
<span class="gi">+#  address_id       :integer                                 # 住所への外部キー</span>
<span class="gi">+#  number           :string(255)      not null               # 電話番号</span>
<span class="gi">+#  number_for_index :string(255)      not null               # 索引用電話番号</span>
<span class="gi">+#  primary          :boolean          default(&quot;0&quot;), not null # 優先フラグ</span>
<span class="gi">+#  created_at       :datetime         not null</span>
<span class="gi">+#  updated_at       :datetime         not null</span>
<span class="gi">+#</span>
<span class="gi">+# Indexes</span>
<span class="gi">+#</span>
<span class="gi">+#  index_phones_on_address_id        (address_id)</span>
<span class="gi">+#  index_phones_on_customer_id       (customer_id)</span>
<span class="gi">+#  index_phones_on_number_for_index  (number_for_index)</span>
<span class="gi">+#</span>
<span class="gi">+</span>
<span class="gi">+FactoryGirl.define do</span>
<span class="gi">+  factory :phone do</span>
<span class="gi">+    </span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
</code></pre></div>
<h3 id="_10">構造変更<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="4a6edde">コミット: 4a6edde<a class="headerlink" href="#4a6edde" title="Permanent link">&para;</a></h2>
<h3 id="_11">メッセージ<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>顧客詳細ページへの電話番号の表示 #15
</code></pre></div>
<h3 id="_12">変更されたファイル<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/presenters/staff/address_presenter.rb</li>
<li>M app/presenters/staff/customer_presenter.rb</li>
<li>M app/views/staff/customers/show.html.erb</li>
<li>M config/locales/views/ja.yml</li>
</ul>
<h3 id="_13">変更内容<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 4a6edde7fe2a709574d77e797aa7263ba0963fe7
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 20:18:31 2017 +0900

<span class="w"> </span>   顧客詳細ページへの電話番号の表示 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 55df9b9..43aae6a 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -594,6 +594,7 @@ git push heroku master</span>
<span class="w"> </span>+ 電話番号管理機能の仕様
<span class="w"> </span>+ phonesテーブルとPhoneモデル
<span class="w"> </span>+ 顧客、自宅住所、勤務先との関連付け
<span class="gi">++ 顧客詳細ページへの電話番号の表示</span>

<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="w"> </span>#### 演習問題 
<span class="gh">diff --git a/app/presenters/staff/address_presenter.rb b/app/presenters/staff/address_presenter.rb</span>
<span class="gh">index 313757d..e633329 100644</span>
<span class="gd">--- a/app/presenters/staff/address_presenter.rb</span>
<span class="gi">+++ b/app/presenters/staff/address_presenter.rb</span>
<span class="gu">@@ -13,4 +13,8 @@ class Staff::AddressPresenter &lt; ModelPresenter</span>
<span class="w"> </span>      object.postal_code
<span class="w"> </span>    end
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  def phones</span>
<span class="gi">+    object.phones.map(&amp;:number)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/app/presenters/staff/customer_presenter.rb b/app/presenters/staff/customer_presenter.rb</span>
<span class="gh">index dc698ec..c699b87 100644</span>
<span class="gd">--- a/app/presenters/staff/customer_presenter.rb</span>
<span class="gi">+++ b/app/presenters/staff/customer_presenter.rb</span>
<span class="gu">@@ -24,4 +24,8 @@ class Staff::CustomerPresenter &lt; ModelPresenter</span>
<span class="w"> </span>        &#39;&#39;
<span class="w"> </span>    end
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  def personal_phones</span>
<span class="gi">+    object.personal_phones.map(&amp;:number)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/app/views/staff/customers/show.html.erb b/app/views/staff/customers/show.html.erb</span>
<span class="gh">index 0b78d96..67ffbe8 100644</span>
<span class="gd">--- a/app/views/staff/customers/show.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/show.html.erb</span>
<span class="gu">@@ -13,14 +13,18 @@</span>
<span class="w"> </span>    &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.gender&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p1.gender %&gt;&lt;/td&gt;&lt;/tr&gt;
<span class="w"> </span>    &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.create_at&#39;) %&gt;&lt;/th&gt;&lt;td class=&quot;Table__td--date&quot;&gt;&lt;%= p1.created_at %&gt;&lt;/td&gt;&lt;/tr&gt;
<span class="w"> </span>    &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.update_at&#39;)%&gt;&lt;/th&gt;&lt;td class=&quot;Table__td--date&quot;&gt;&lt;%= p1.updated_at %&gt;&lt;/td&gt;&lt;/tr&gt;
<span class="gi">+    &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.personal_phones_1&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p1.personal_phones[0] %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+    &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.personal_phones_2&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p1.personal_phones[1] %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="w"> </span>    &lt;% if @customer.home_address %&gt;
<span class="w"> </span>      &lt;% p2 = Staff::AddressPresenter.new(@customer.home_address, self) %&gt;
<span class="gd">-      &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot; colspan=&quot;2&quot;&gt;&lt;%= t(&#39;.home_address&#39;) %&gt;&lt;/th&gt;&lt;/tr&gt;</span>
<span class="gd">-      &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_postal_code&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.postal_code %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gd">-      &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_prefecture&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.prefecture %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gd">-      &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_city&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.city %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gd">-      &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_address1&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.address1 %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gd">-      &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_address2&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.address2 %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot; colspan=&quot;2&quot;&gt;&lt;%= t(&#39;.home_address&#39;) %&gt;&lt;/th&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_postal_code&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.postal_code %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_prefecture&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.prefecture %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_city&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.city %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_address1&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.address1 %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_address2&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.address2 %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_phones_1&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.phones[0] %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.home_address_phones_2&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p2.phones[1] %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="w"> </span>    &lt;% end %&gt;
<span class="w"> </span>    &lt;% if @customer.work_address %&gt;
<span class="w"> </span>        &lt;% p3 = Staff::AddressPresenter.new(@customer.work_address, self) %&gt;
<span class="gu">@@ -32,6 +36,8 @@</span>
<span class="w"> </span>        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.work_address_city&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p3.city %&gt;&lt;/td&gt;&lt;/tr&gt;
<span class="w"> </span>        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.work_address_address1&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p3.address1 %&gt;&lt;/td&gt;&lt;/tr&gt;
<span class="w"> </span>        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.work_address_address2&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p3.address2 %&gt;&lt;/td&gt;&lt;/tr&gt;
<span class="gd">-    &lt;% end %&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.work_address_phones_1&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p3.phones[0] %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+        &lt;tr class=&quot;Table__tr&quot;&gt;&lt;th class=&quot;Table__th&quot;&gt;&lt;%= t(&#39;.work_address_phones_2&#39;) %&gt;&lt;/th&gt;&lt;td&gt;&lt;%= p3.phones[1] %&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="gi">+  &lt;% end %&gt;</span>
<span class="w"> </span>  &lt;/table&gt;
<span class="w"> </span>&lt;/section&gt;
\ No newline at end of file
<span class="gh">diff --git a/config/locales/views/ja.yml b/config/locales/views/ja.yml</span>
<span class="gh">index a0d1b6b..446ccfa 100644</span>
<span class="gd">--- a/config/locales/views/ja.yml</span>
<span class="gi">+++ b/config/locales/views/ja.yml</span>
<span class="gu">@@ -39,11 +39,15 @@ ja:</span>
<span class="w"> </span>        gender: &#39;性別&#39;
<span class="w"> </span>        create_at: &#39;登録日時&#39;
<span class="w"> </span>        update_at: &#39;更新日時&#39;
<span class="gi">+        personal_phones_1: &#39;個人電話番号（１）&#39;</span>
<span class="gi">+        personal_phones_2: &#39;個人電話番号（２）&#39;</span>
<span class="w"> </span>        home_address_postal_code: &#39;郵便番号&#39;
<span class="w"> </span>        home_address_prefecture: &#39;都道府県&#39;
<span class="w"> </span>        home_address_city: &#39;市区町村&#39;
<span class="w"> </span>        home_address_address1: &#39;町域、番地等&#39;
<span class="w"> </span>        home_address_address2: &#39;建物名、部屋番号&#39;
<span class="gi">+        home_address_phones_1: &#39;自宅電話番号（１）&#39;</span>
<span class="gi">+        home_address_phones_2: &#39;自宅電話番号（２）&#39;</span>
<span class="w"> </span>        work_address_company_name: &#39;会社名&#39;
<span class="w"> </span>        work_address_division_name: &#39;部署名&#39;
<span class="w"> </span>        work_address_postal_code: &#39;郵便番号&#39;
<span class="gu">@@ -51,6 +55,8 @@ ja:</span>
<span class="w"> </span>        work_address_city: &#39;市区町村&#39;
<span class="w"> </span>        work_address_address1: &#39;町域、番地等&#39;
<span class="w"> </span>        work_address_address2: &#39;建物名、部屋番号&#39;
<span class="gi">+        work_address_phones_1: &#39;勤務先電話番号（１）&#39;</span>
<span class="gi">+        work_address_phones_2: &#39;勤務先電話番号（２）&#39;</span>
<span class="w"> </span>      new:
<span class="w"> </span>        title: &#39;顧客の新規登録&#39;
<span class="w"> </span>        basic_info: &#39;基本情報&#39;
</code></pre></div>
<h2 id="c30c834">コミット: c30c834<a class="headerlink" href="#c30c834" title="Permanent link">&para;</a></h2>
<h3 id="_14">メッセージ<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>顧客、自宅住所、勤務先との関連付け #15
</code></pre></div>
<h3 id="_15">変更されたファイル<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/models/address.rb</li>
<li>M app/models/customer.rb</li>
<li>M db/schema.rb</li>
<li>M db/seed/development/customers.rb</li>
</ul>
<h3 id="_16">変更内容<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit c30c834fee5cbcee30a796013bc554bae3ccbac6
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 20:07:05 2017 +0900

<span class="w"> </span>   顧客、自宅住所、勤務先との関連付け #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 8daea5e..55df9b9 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -593,6 +593,7 @@ git push heroku master</span>
<span class="w"> </span>#### 顧客電話番号の管理（１） 
<span class="w"> </span>+ 電話番号管理機能の仕様
<span class="w"> </span>+ phonesテーブルとPhoneモデル
<span class="gi">++ 顧客、自宅住所、勤務先との関連付け</span>

<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="w"> </span>#### 演習問題 
<span class="gh">diff --git a/app/models/address.rb b/app/models/address.rb</span>
<span class="gh">index e4133f5..b8ab123 100644</span>
<span class="gd">--- a/app/models/address.rb</span>
<span class="gi">+++ b/app/models/address.rb</span>
<span class="gu">@@ -25,6 +25,7 @@ class Address &lt; ApplicationRecord</span>
<span class="w"> </span>  include StringNormalizer

<span class="w"> </span>  belongs_to :customer
<span class="gi">+  has_many :phones, -&gt; { order(:id) }, dependent: :destroy, autosave: true</span>

<span class="w"> </span>  before_validation do
<span class="w"> </span>    self.postal_code = normalize_as_postal_code(postal_code)
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index 3a480d3..423e927 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -28,6 +28,8 @@ class Customer &lt; ApplicationRecord</span>

<span class="w"> </span>  has_one :home_address, dependent: :destroy, autosave: true
<span class="w"> </span>  has_one :work_address, dependent: :destroy, autosave: true
<span class="gi">+  has_many :phones, dependent: :destroy</span>
<span class="gi">+  has_many :personal_phones, -&gt; { where(address_id: nil).order(:id) },class_name: &#39;Phone&#39;, autosave: true</span>

<span class="w"> </span>  validates :gender, inclusion: { in: %w(male female), allow_blank: true }
<span class="w"> </span>  validates :birthday, date: {
<span class="gh">diff --git a/db/schema.rb b/db/schema.rb</span>
<span class="gh">index f0ee063..7285822 100644</span>
<span class="gd">--- a/db/schema.rb</span>
<span class="gi">+++ b/db/schema.rb</span>
<span class="gu">@@ -54,14 +54,14 @@ ActiveRecord::Schema.define(version: 20170206085929) do</span>
<span class="w"> </span>    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_family_name_kana_and_given_name_kana&quot;, using: :btree
<span class="w"> </span>  end

<span class="gd">-  create_table &quot;phones&quot;, force: :cascade,  comment: &quot;電話&quot; do |t|</span>
<span class="gd">-    t.integer  &quot;customer_id&quot;,      null: false</span>
<span class="gd">-    t.integer  &quot;address_id&quot;</span>
<span class="gd">-    t.string   &quot;number&quot;,           null: false, comment: &quot;電話番号&quot;</span>
<span class="gd">-    t.string   &quot;number_for_index&quot;, null: false, comment: &quot;索引用電話番号&quot;</span>
<span class="gd">-    t.boolean  &quot;primary&quot;,          null: false, comment: &quot;優先フラグ&quot;</span>
<span class="gd">-    t.datetime &quot;created_at&quot;,       null: false</span>
<span class="gd">-    t.datetime &quot;updated_at&quot;,       null: false</span>
<span class="gi">+  create_table &quot;phones&quot;, force: :cascade, comment: &quot;電話&quot; do |t|</span>
<span class="gi">+    t.integer  &quot;customer_id&quot;,                      null: false, comment: &quot;顧客への外部キー&quot;</span>
<span class="gi">+    t.integer  &quot;address_id&quot;,                                    comment: &quot;住所への外部キー&quot;</span>
<span class="gi">+    t.string   &quot;number&quot;,                           null: false, comment: &quot;電話番号&quot;</span>
<span class="gi">+    t.string   &quot;number_for_index&quot;,                 null: false, comment: &quot;索引用電話番号&quot;</span>
<span class="gi">+    t.boolean  &quot;primary&quot;,          default: false, null: false, comment: &quot;優先フラグ&quot;</span>
<span class="gi">+    t.datetime &quot;created_at&quot;,                       null: false</span>
<span class="gi">+    t.datetime &quot;updated_at&quot;,                       null: false</span>
<span class="w"> </span>    t.index [&quot;address_id&quot;], name: &quot;index_phones_on_address_id&quot;, using: :btree
<span class="w"> </span>    t.index [&quot;customer_id&quot;], name: &quot;index_phones_on_customer_id&quot;, using: :btree
<span class="w"> </span>    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;, using: :btree
<span class="gh">diff --git a/db/seed/development/customers.rb b/db/seed/development/customers.rb</span>
<span class="gh">index 1440187..674ffe3 100644</span>
<span class="gd">--- a/db/seed/development/customers.rb</span>
<span class="gi">+++ b/db/seed/development/customers.rb</span>
<span class="gu">@@ -43,6 +43,9 @@ company_names = %w(OIAX ABC XYZ)</span>
<span class="w"> </span>        birthday: 60.years.ago.advance(seconds: rand(40.years)).to_date,
<span class="w"> </span>        gender: m &lt; 5 ? &#39;male&#39; : &#39;female&#39;
<span class="w"> </span>    )
<span class="gi">+    if m % 2 == 0</span>
<span class="gi">+      c.personal_phones.create!(number: sprintf(&#39;090-0000-%04d&#39;, n * 10 + m))</span>
<span class="gi">+    end</span>
<span class="w"> </span>    c.create_home_address!(
<span class="w"> </span>        postal_code: sprintf(&#39;%07d&#39;, rand(10000000)),
<span class="w"> </span>        prefecture: Address::PREFECTURE_NAMES.sample,
<span class="gu">@@ -50,6 +53,9 @@ company_names = %w(OIAX ABC XYZ)</span>
<span class="w"> </span>        address1: &#39;開発1-2-3&#39;,
<span class="w"> </span>        address2: &#39;レイルズハイツ301号室&#39;
<span class="w"> </span>    )
<span class="gi">+    if m % 10 == 0</span>
<span class="gi">+      c.home_address.phones.create!(number: sprintf(&#39;03-0000-%04d&#39;, n))</span>
<span class="gi">+    end</span>
<span class="w"> </span>    if m % 3 == 0
<span class="w"> </span>      c.create_work_address!(
<span class="w"> </span>          postal_code: sprintf(&#39;%07d&#39;, rand(10000000)),
</code></pre></div>
<h3 id="_17">構造変更<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="72fc059">コミット: 72fc059<a class="headerlink" href="#72fc059" title="Permanent link">&para;</a></h2>
<h3 id="_18">メッセージ<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>phonesテーブルとPhoneモデル #15
</code></pre></div>
<h3 id="_19">変更されたファイル<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/models/concerns/string_normalizer.rb</li>
<li>M db/schema.rb</li>
</ul>
<h3 id="_20">変更内容<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 72fc0598f7a531afcd284d2859ba4cc1614d97c9
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 18:28:21 2017 +0900

<span class="w"> </span>   phonesテーブルとPhoneモデル #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 2bb5293..8daea5e 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -591,6 +591,9 @@ git push heroku master</span>
<span class="w"> </span>+ Capybaraによるテスト

<span class="w"> </span>#### 顧客電話番号の管理（１） 
<span class="gi">++ 電話番号管理機能の仕様</span>
<span class="gi">++ phonesテーブルとPhoneモデル</span>
<span class="gi">+</span>
<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="w"> </span>#### 演習問題 

<span class="gh">diff --git a/app/models/concerns/string_normalizer.rb b/app/models/concerns/string_normalizer.rb</span>
<span class="gh">index f036970..c19131e 100644</span>
<span class="gd">--- a/app/models/concerns/string_normalizer.rb</span>
<span class="gi">+++ b/app/models/concerns/string_normalizer.rb</span>
<span class="gu">@@ -18,4 +18,8 @@ module StringNormalizer</span>
<span class="w"> </span>  def normalize_as_postal_code(text)
<span class="w"> </span>    NKF.nkf(&#39;-w -Z1&#39;, text).strip.gsub(/-/, &#39;&#39;) if text
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  def normalize_as_phone_number(text)</span>
<span class="gi">+    NKF.nkf(&#39;-w -Z1&#39;, text).strip if text</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/db/schema.rb b/db/schema.rb</span>
<span class="gh">index 36cea7d..f0ee063 100644</span>
<span class="gd">--- a/db/schema.rb</span>
<span class="gi">+++ b/db/schema.rb</span>
<span class="gu">@@ -10,7 +10,7 @@</span>
<span class="w"> </span>#
<span class="w"> </span># It&#39;s strongly recommended that you check this file into your version control system.

<span class="gd">-ActiveRecord::Schema.define(version: 20170203051654) do</span>
<span class="gi">+ActiveRecord::Schema.define(version: 20170206085929) do</span>

<span class="w"> </span>  create_table &quot;addresses&quot;, force: :cascade,  comment: &quot;住所&quot; do |t|
<span class="w"> </span>    t.integer  &quot;customer_id&quot;,                null: false, comment: &quot;顧客への外部キー&quot;
<span class="gu">@@ -54,6 +54,19 @@ ActiveRecord::Schema.define(version: 20170203051654) do</span>
<span class="w"> </span>    t.index [&quot;family_name_kana&quot;, &quot;given_name_kana&quot;], name: &quot;index_customers_on_family_name_kana_and_given_name_kana&quot;, using: :btree
<span class="w"> </span>  end

<span class="gi">+  create_table &quot;phones&quot;, force: :cascade,  comment: &quot;電話&quot; do |t|</span>
<span class="gi">+    t.integer  &quot;customer_id&quot;,      null: false</span>
<span class="gi">+    t.integer  &quot;address_id&quot;</span>
<span class="gi">+    t.string   &quot;number&quot;,           null: false, comment: &quot;電話番号&quot;</span>
<span class="gi">+    t.string   &quot;number_for_index&quot;, null: false, comment: &quot;索引用電話番号&quot;</span>
<span class="gi">+    t.boolean  &quot;primary&quot;,          null: false, comment: &quot;優先フラグ&quot;</span>
<span class="gi">+    t.datetime &quot;created_at&quot;,       null: false</span>
<span class="gi">+    t.datetime &quot;updated_at&quot;,       null: false</span>
<span class="gi">+    t.index [&quot;address_id&quot;], name: &quot;index_phones_on_address_id&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;customer_id&quot;], name: &quot;index_phones_on_customer_id&quot;, using: :btree</span>
<span class="gi">+    t.index [&quot;number_for_index&quot;], name: &quot;index_phones_on_number_for_index&quot;, using: :btree</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="w"> </span>  create_table &quot;staff_events&quot;, force: :cascade,  comment: &quot;職員イベント&quot; do |t|
<span class="w"> </span>    t.integer  &quot;staff_member_id&quot;, null: false, comment: &quot;職員レコードへの外部キー&quot;
<span class="w"> </span>    t.string   &quot;type&quot;,            null: false, comment: &quot;イベントタイプ&quot;
<span class="gu">@@ -81,5 +94,7 @@ ActiveRecord::Schema.define(version: 20170203051654) do</span>
<span class="w"> </span>  end

<span class="w"> </span>  add_foreign_key &quot;addresses&quot;, &quot;customers&quot;
<span class="gi">+  add_foreign_key &quot;phones&quot;, &quot;addresses&quot;</span>
<span class="gi">+  add_foreign_key &quot;phones&quot;, &quot;customers&quot;</span>
<span class="w"> </span>  add_foreign_key &quot;staff_events&quot;, &quot;staff_members&quot;
<span class="w"> </span>end
</code></pre></div>
<h3 id="_21">構造変更<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="b31d234">コミット: b31d234<a class="headerlink" href="#b31d234" title="Permanent link">&para;</a></h2>
<h3 id="_22">メッセージ<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Capybaraによるテスト #15
</code></pre></div>
<h3 id="_23">変更されたファイル<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M spec/features/staff/customer_management_spec.rb</li>
</ul>
<h3 id="_24">変更内容<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit b31d2343979641b463fda02113339e5d217a816a
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 17:57:01 2017 +0900

<span class="w"> </span>   Capybaraによるテスト #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 28c33ce..2bb5293 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -588,6 +588,7 @@ git push heroku master</span>
<span class="w"> </span>#### 自宅住所と勤務先の任意入力
<span class="w"> </span>+ フィールドの有効化・無効化
<span class="w"> </span>+ フォームオブジェクトの修正
<span class="gi">++ Capybaraによるテスト</span>

<span class="w"> </span>#### 顧客電話番号の管理（１） 
<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="gh">diff --git a/spec/features/staff/customer_management_spec.rb b/spec/features/staff/customer_management_spec.rb</span>
<span class="gh">index a03060c..0f4ca36 100644</span>
<span class="gd">--- a/spec/features/staff/customer_management_spec.rb</span>
<span class="gi">+++ b/spec/features/staff/customer_management_spec.rb</span>
<span class="gu">@@ -11,6 +11,28 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>    login_as_staff_member(staff_member)
<span class="w"> </span>  end

<span class="gi">+  # 職員が顧客（基本情報のみ）を登録する</span>
<span class="gi">+  scenario &#39;Employees register customers (only basic information)&#39; do</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+    first(&#39;.Table__links&#39;).click_link I18n.t(&#39;staff.customers.index.new&#39;)</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.email&#39;), with: &#39;test@example.jp&#39;</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.hashed_password&#39;), with: &#39;pw&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_family_name&#39;, with: &#39;試験&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_given_name&#39;, with: &#39;花子&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_family_name_kana&#39;, with: &#39;シケン&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_given_name_kana&#39;, with: &#39;ハナコ&#39;</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.birthday&#39;), with: &#39;1970-01-01&#39;</span>
<span class="gi">+    choose &#39;女性&#39;</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.new.create&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    new_customer = Customer.order(:id).last</span>
<span class="gi">+    expect(new_customer.email).to eq(&#39;test@example.jp&#39;)</span>
<span class="gi">+    expect(new_customer.birthday).to eq(Date.new(1970,1,1))</span>
<span class="gi">+    expect(new_customer.gender).to eq(&#39;female&#39;)</span>
<span class="gi">+    expect(new_customer.home_address).to be_nil</span>
<span class="gi">+    expect(new_customer.work_address).to be_nil</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="w"> </span>  # 職員が顧客、自宅住所、勤務先を更新する
<span class="w"> </span>  scenario &#39;Staff update customer, home address, work place&#39; do
<span class="w"> </span>    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)
<span class="gu">@@ -34,7 +56,6 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>  # 職員が顧客、自宅住所、勤務先を登録する
<span class="w"> </span>  scenario &#39;Employees register customer, home address, work place&#39; do
<span class="w"> </span>    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)
<span class="gd">-</span>
<span class="w"> </span>    first(&#39;.Table__links&#39;).click_link I18n.t(&#39;staff.customers.index.new&#39;)

<span class="w"> </span>    fill_in I18n.t(&#39;activerecord.attributes.customer.email&#39;), with: &#39;test@example.jp&#39;
<span class="gu">@@ -45,6 +66,7 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>    fill_in &#39;form_customer_given_name_kana&#39;, with: &#39;ハナコ&#39;
<span class="w"> </span>    fill_in I18n.t(&#39;activerecord.attributes.customer.birthday&#39;), with: &#39;1970-01-01&#39;
<span class="w"> </span>    choose &#39;女性&#39;
<span class="gi">+    check I18n.t(&#39;staff.customers.new.home_address_inputs&#39;)</span>
<span class="w"> </span>    within(&#39;fieldset#home-address-fields&#39;) do
<span class="w"> </span>      fill_in I18n.t(&#39;activerecord.attributes.home_address.postal_code&#39;), with: &#39;1000001&#39;
<span class="w"> </span>      select &#39;東京都&#39;, from: I18n.t(&#39;activerecord.attributes.home_address.prefecture&#39;)
<span class="gu">@@ -52,6 +74,7 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>      fill_in I18n.t(&#39;activerecord.attributes.home_address.address1&#39;), with: &#39;千代田1-1-1&#39;
<span class="w"> </span>      fill_in I18n.t(&#39;activerecord.attributes.home_address.address2&#39;), with: &#39;&#39;
<span class="w"> </span>    end
<span class="gi">+    check I18n.t(&#39;staff.customers.new.work_address_inputs&#39;)</span>
<span class="w"> </span>    within(&#39;fieldset#work-address-fields&#39;) do
<span class="w"> </span>      fill_in I18n.t(&#39;activerecord.attributes.work_address.company_name&#39;), with: &#39;テスト&#39;
<span class="w"> </span>      fill_in I18n.t(&#39;activerecord.attributes.work_address.division_name&#39;), with: &#39;&#39;
</code></pre></div>
<h2 id="4735944">コミット: 4735944<a class="headerlink" href="#4735944" title="Permanent link">&para;</a></h2>
<h3 id="_25">メッセージ<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>フォームオブジェクトの修正 #15
</code></pre></div>
<h3 id="_26">変更されたファイル<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_form.rb</li>
<li>M app/views/staff/customers/_customer_fields.html.erb</li>
</ul>
<h3 id="_27">変更内容<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 4735944789ccf6f18da9f2fc56aec8274e11d6f1
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 17:51:21 2017 +0900

<span class="w"> </span>   フォームオブジェクトの修正 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 72e323f..28c33ce 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -587,6 +587,7 @@ git push heroku master</span>
<span class="w"> </span>### フォームオブジェクト
<span class="w"> </span>#### 自宅住所と勤務先の任意入力
<span class="w"> </span>+ フィールドの有効化・無効化
<span class="gi">++ フォームオブジェクトの修正</span>

<span class="w"> </span>#### 顧客電話番号の管理（１） 
<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index d4f493e..acc92b9 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -15,10 +15,20 @@ class Staff::CustomerForm</span>

<span class="w"> </span>  def assign_attributes(params = {})
<span class="w"> </span>    @params = params
<span class="gi">+    self.inputs_home_address = params[:inputs_home_address] == &#39;1&#39;</span>
<span class="gi">+    self.inputs_work_address = params[:inputs_work_address] == &#39;1&#39;</span>

<span class="w"> </span>    customer.assign_attributes(customer_params)
<span class="gd">-    customer.home_address.assign_attributes(home_address_params)</span>
<span class="gd">-    customer.work_address.assign_attributes(work_address_params)</span>
<span class="gi">+    if inputs_home_address</span>
<span class="gi">+      customer.home_address.assign_attributes(home_address_params)</span>
<span class="gi">+    else</span>
<span class="gi">+      customer.home_address.mark_for_destruction</span>
<span class="gi">+    end</span>
<span class="gi">+    if inputs_work_address</span>
<span class="gi">+      customer.work_address.assign_attributes(work_address_params)</span>
<span class="gi">+    else</span>
<span class="gi">+      customer.work_address.mark_for_destruction</span>
<span class="gi">+    end</span>
<span class="w"> </span>  end

<span class="w"> </span>  private
<span class="gh">diff --git a/app/views/staff/customers/_customer_fields.html.erb b/app/views/staff/customers/_customer_fields.html.erb</span>
<span class="gh">index cb1bc77..ea4eb7f 100644</span>
<span class="gd">--- a/app/views/staff/customers/_customer_fields.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_customer_fields.html.erb</span>
<span class="gu">@@ -5,7 +5,7 @@</span>
<span class="w"> </span>    m &lt;&lt; q.text_field_block(:email, t(&#39;activerecord.attributes.customer.email&#39;), size: 32)
<span class="w"> </span>    m &lt;&lt; q.password_field_block(:password, t(&#39;activerecord.attributes.customer.hashed_password&#39;), size: 32)
<span class="w"> </span>    m &lt;&lt; q.full_name_block(:family_name, :given_name, t(&#39;activerecord.attributes.customer.full_name&#39;))
<span class="gd">-    m &lt;&lt; q.full_name_block(:family_name_kana, :given_name_kana, t(&#39;activerecord.attributes.customer.full_name&#39;))</span>
<span class="gi">+    m &lt;&lt; q.full_name_block(:family_name_kana, :given_name_kana, t(&#39;activerecord.attributes.customer.full_name_kana&#39;))</span>
<span class="w"> </span>  end
<span class="w"> </span>  m &lt;&lt; p.birthday_field_block(:birthday, t(&#39;activerecord.attributes.customer.birthday&#39;))
<span class="w"> </span>  m &lt;&lt; p.gender_field_block
</code></pre></div>
<h2 id="631ce6c">コミット: 631ce6c<a class="headerlink" href="#631ce6c" title="Permanent link">&para;</a></h2>
<h3 id="_28">メッセージ<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>フィールドの有効化・無効化 #15
</code></pre></div>
<h3 id="_29">変更されたファイル<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/assets/javascripts/admin/staff_member_form.coffee</li>
<li>M app/assets/javascripts/staff/customer_form.coffee</li>
<li>M app/forms/staff/customer_form.rb</li>
<li>M app/presenters/user_form_presenter.rb</li>
<li>M app/views/admin/staff_members/edit.html.erb</li>
<li>M app/views/admin/staff_members/new.html.erb</li>
<li>M app/views/staff/customers/_form.html.erb</li>
<li>M app/views/staff/customers/edit.html.erb</li>
<li>M app/views/staff/customers/new.html.erb</li>
<li>M config/locales/views/ja.yml</li>
</ul>
<h3 id="_30">変更内容<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 631ce6c3ae1b205c13d2777c78145e2a8cd1746e
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 17:27:32 2017 +0900

<span class="w"> </span>   フィールドの有効化・無効化 #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 5ad36cd..72e323f 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -586,6 +586,8 @@ git push heroku master</span>

<span class="w"> </span>### フォームオブジェクト
<span class="w"> </span>#### 自宅住所と勤務先の任意入力
<span class="gi">++ フィールドの有効化・無効化</span>
<span class="gi">+</span>
<span class="w"> </span>#### 顧客電話番号の管理（１） 
<span class="w"> </span>#### 顧客電話番号の管理（２）
<span class="w"> </span>#### 演習問題 
<span class="gh">diff --git a/app/assets/javascripts/admin/staff_member_form.coffee b/app/assets/javascripts/admin/staff_member_form.coffee</span>
<span class="gh">index 52b4456..ef60797 100644</span>
<span class="gd">--- a/app/assets/javascripts/admin/staff_member_form.coffee</span>
<span class="gi">+++ b/app/assets/javascripts/admin/staff_member_form.coffee</span>
<span class="gu">@@ -4,19 +4,19 @@ $(document).on &quot;turbolinks:load&quot;, -&gt;</span>

<span class="w"> </span>class StaffMemberForm
<span class="w"> </span>  constructor: -&gt;
<span class="gd">-    $(&#39;#enable-password-field&#39;).on</span>
<span class="gi">+    $(&#39;.AppForm__customer_form #is-enable-password-field&#39;).on</span>
<span class="w"> </span>      &#39;click&#39;: handlePasswordInputFieldOn
<span class="gd">-    $(&#39;#disable-password-field&#39;).on</span>
<span class="gi">+    $(&#39;.AppForm__customer_form #is-disable-password-field&#39;).on</span>
<span class="w"> </span>      &#39;click&#39;: handlePasswordInputFieldOff

<span class="w"> </span>  handlePasswordInputFieldOn = -&gt;
<span class="gd">-    $(&#39;#enable-password-field&#39;).hide()</span>
<span class="gd">-    $(&#39;#disable-password-field&#39;).show()</span>
<span class="gi">+    $(&#39;#is-enable-password-field&#39;).hide()</span>
<span class="gi">+    $(&#39;#is-disable-password-field&#39;).show()</span>
<span class="w"> </span>    $(&#39;#staff_member_password&#39;).removeAttr(&#39;disabled&#39;)
<span class="w"> </span>    $(&#39;label[for=staff_member_password]&#39;).addClass(&#39;required&#39;)

<span class="w"> </span>  handlePasswordInputFieldOff = -&gt;
<span class="gd">-    $(&#39;#disable-password-field&#39;).hide()</span>
<span class="gd">-    $(&#39;#enable-password-field&#39;).show()</span>
<span class="gi">+    $(&#39;#is-disable-password-field&#39;).hide()</span>
<span class="gi">+    $(&#39;#is-enable-password-field&#39;).show()</span>
<span class="w"> </span>    $(&#39;#staff_member_password&#39;).attr(&#39;disabled&#39;,&#39;disabled&#39;)
<span class="w"> </span>    $(&#39;label[for=staff_member_password]&#39;).removeClass(&#39;required&#39;)
<span class="gh">diff --git a/app/assets/javascripts/staff/customer_form.coffee b/app/assets/javascripts/staff/customer_form.coffee</span>
<span class="gh">index 894aed5..1d09d38 100644</span>
<span class="gd">--- a/app/assets/javascripts/staff/customer_form.coffee</span>
<span class="gi">+++ b/app/assets/javascripts/staff/customer_form.coffee</span>
<span class="gu">@@ -4,19 +4,37 @@ $(document).on &quot;turbolinks:load&quot;, -&gt;</span>

<span class="w"> </span>class CustomerForm
<span class="w"> </span>  constructor: -&gt;
<span class="gd">-    $(&#39;button#enable-password-field&#39;).on</span>
<span class="gi">+    $(&#39;.AppForm__customer-form #is-enable-password-field&#39;).on</span>
<span class="w"> </span>      &#39;click&#39;: handlePasswordInputFieldOn
<span class="gd">-    $(&#39;button#disable-password-field&#39;).on</span>
<span class="gi">+    $(&#39;.AppForm__customer-form #is-disable-password-field&#39;).on</span>
<span class="w"> </span>      &#39;click&#39;: handlePasswordInputFieldOff
<span class="gi">+    toggleHomeAddressFields()</span>
<span class="gi">+    toggleWorkAddressFields()</span>
<span class="gi">+    $(&#39;.AppForm__customer-form input#form_inputs_home_address&#39;).on</span>
<span class="gi">+      &#39;click&#39; : handleHomeAddressFields</span>
<span class="gi">+    $(&#39;.AppForm__customer-form input#form_inputs_work_address&#39;).on</span>
<span class="gi">+      &#39;click&#39; : handleWorkAddrssFields</span>

<span class="w"> </span>  handlePasswordInputFieldOn = -&gt;
<span class="gd">-    $(&#39;#enable-password-field&#39;).hide()</span>
<span class="gd">-    $(&#39;#disable-password-field&#39;).show()</span>
<span class="gi">+    $(&#39;#is-enable-password-field&#39;).hide()</span>
<span class="gi">+    $(&#39;#is-disable-password-field&#39;).show()</span>
<span class="w"> </span>    $(&#39;#form_customer_password&#39;).removeAttr(&#39;disabled&#39;)
<span class="w"> </span>    $(&#39;label[for=form_customer_password]&#39;).addClass(&#39;required&#39;)
<span class="gd">-</span>
<span class="w"> </span>  handlePasswordInputFieldOff = -&gt;
<span class="gd">-    $(&#39;#disable-password-field&#39;).hide()</span>
<span class="gd">-    $(&#39;#enable-password-field&#39;).show()</span>
<span class="gi">+    $(&#39;#is-disable-password-field&#39;).hide()</span>
<span class="gi">+    $(&#39;#is-enable-password-field&#39;).show()</span>
<span class="w"> </span>    $(&#39;#form_customer_password&#39;).attr(&#39;disabled&#39;,&#39;disabled&#39;)
<span class="w"> </span>    $(&#39;label[for=form_customer_password]&#39;).removeClass(&#39;required&#39;)
<span class="gi">+  handleHomeAddressFields = -&gt;</span>
<span class="gi">+    toggleHomeAddressFields()</span>
<span class="gi">+  handleWorkAddrssFields = -&gt;</span>
<span class="gi">+    toggleWorkAddressFields()</span>
<span class="gi">+</span>
<span class="gi">+  toggleHomeAddressFields = -&gt;</span>
<span class="gi">+    checked = $(&#39;input#form_inputs_home_address&#39;).prop(&#39;checked&#39;)</span>
<span class="gi">+    $(&#39;fieldset#home-address-fields input&#39;).prop(&#39;disabled&#39;, !checked)</span>
<span class="gi">+    $(&#39;fieldset#home-address-fields select&#39;).prop(&#39;disabled&#39;, !checked)</span>
<span class="gi">+  toggleWorkAddressFields = -&gt;</span>
<span class="gi">+    checked = $(&#39;input#form_inputs_work_address&#39;).prop(&#39;checked&#39;)</span>
<span class="gi">+    $(&#39;fieldset#work-address-fields input&#39;).prop(&#39;disabled&#39;, !checked)</span>
<span class="gi">+    $(&#39;fieldset#work-address-fields select&#39;).prop(&#39;disabled&#39;, !checked)</span>
\ No newline at end of file
<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index 271fd36..d4f493e 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -1,12 +1,14 @@</span>
<span class="w"> </span>class Staff::CustomerForm
<span class="w"> </span>  include ActiveModel::Model

<span class="gd">-  attr_accessor :customer</span>
<span class="gi">+  attr_accessor :customer, :inputs_home_address, :inputs_work_address</span>
<span class="w"> </span>  delegate :persisted?, :save, to: :customer

<span class="w"> </span>  def initialize(customer = nil)
<span class="w"> </span>    @customer = customer
<span class="w"> </span>    @customer ||= Customer.new(gender: &#39;male&#39;)
<span class="gi">+    self.inputs_home_address = @customer.home_address.present?</span>
<span class="gi">+    self.inputs_work_address = @customer.work_address.present?</span>
<span class="w"> </span>    @customer.build_home_address unless @customer.home_address
<span class="w"> </span>    @customer.build_work_address unless @customer.work_address
<span class="w"> </span>  end
<span class="gh">diff --git a/app/presenters/user_form_presenter.rb b/app/presenters/user_form_presenter.rb</span>
<span class="gh">index 1fcf987..1528dfc 100644</span>
<span class="gd">--- a/app/presenters/user_form_presenter.rb</span>
<span class="gi">+++ b/app/presenters/user_form_presenter.rb</span>
<span class="gu">@@ -6,8 +6,8 @@ class UserFormPresenter &lt; FormPresenter</span>
<span class="w"> </span>      markup(:div, class: &#39;AppForm__input-block&#39;) do |m|
<span class="w"> </span>        m &lt;&lt; decorated_label(name, label_text, options.merge(required: false))
<span class="w"> </span>        m &lt;&lt; password_field(name, options.merge(disabled: true).merge(hide_label: true))
<span class="gd">-        m.button(&#39;変更する&#39;,type: &#39;button&#39;, id: &#39;enable-password-field&#39;, class: &#39;btn btn-warning btn-xs&#39;)</span>
<span class="gd">-        m.button(&#39;変更しない&#39;, type: &#39;button&#39;, id: &#39;disable-password-field&#39;,style: &#39;display: none&#39;, class: &#39;btn btn-primary btn-xs&#39;)</span>
<span class="gi">+        m.button(&#39;変更する&#39;,type: &#39;button&#39;, id: &#39;is-enable-password-field&#39;, class: &#39;btn btn-warning btn-xs&#39;)</span>
<span class="gi">+        m.button(&#39;変更しない&#39;, type: &#39;button&#39;, id: &#39;is-disable-password-field&#39;,style: &#39;display: none&#39;, class: &#39;btn btn-primary btn-xs&#39;)</span>
<span class="w"> </span>      end
<span class="w"> </span>    end
<span class="w"> </span>  end
<span class="gh">diff --git a/app/views/admin/staff_members/edit.html.erb b/app/views/admin/staff_members/edit.html.erb</span>
<span class="gh">index 3dedba9..039c1f1 100644</span>
<span class="gd">--- a/app/views/admin/staff_members/edit.html.erb</span>
<span class="gi">+++ b/app/views/admin/staff_members/edit.html.erb</span>
<span class="gu">@@ -4,7 +4,7 @@</span>
<span class="w"> </span>&lt;/section&gt;

<span class="w"> </span>&lt;section class=&quot;Section l-column AppForm&quot;&gt;
<span class="gd">-  &lt;div class=&quot;AppForm__generic-form AdminAppForm__generic-form&quot;&gt;</span>
<span class="gi">+  &lt;div class=&quot;AppForm__generic-form AdminAppForm__generic-form AppForm__customer_form&quot;&gt;</span>
<span class="w"> </span>    &lt;%= bootstrap_form_for [ :admin, @staff_member ] do |f| %&gt;
<span class="w"> </span>        &lt;%= render &#39;form&#39;, f: f %&gt;
<span class="w"> </span>        &lt;div class=&quot;AppForm__buttons&quot;&gt;
<span class="gh">diff --git a/app/views/admin/staff_members/new.html.erb b/app/views/admin/staff_members/new.html.erb</span>
<span class="gh">index fdc2ab3..6f206a5 100644</span>
<span class="gd">--- a/app/views/admin/staff_members/new.html.erb</span>
<span class="gi">+++ b/app/views/admin/staff_members/new.html.erb</span>
<span class="gu">@@ -4,7 +4,7 @@</span>
<span class="w"> </span>&lt;/section&gt;

<span class="w"> </span>&lt;section class=&quot;Section l-column AppForm&quot;&gt;
<span class="gd">-  &lt;div class=&quot;AppForm__generic-form AdminAppForm__generic-form&quot;&gt;</span>
<span class="gi">+  &lt;div class=&quot;AppForm__generic-form AdminAppForm__generic-form AppForm__customer_form&quot;&gt;</span>
<span class="w"> </span>    &lt;%= bootstrap_form_for [ :admin, @staff_member ] do |f| %&gt;
<span class="w"> </span>    &lt;%= render &#39;form&#39;, f: f %&gt;
<span class="w"> </span>        &lt;div class=&quot;AppForm__buttons&quot;&gt;
<span class="gh">diff --git a/app/views/staff/customers/_form.html.erb b/app/views/staff/customers/_form.html.erb</span>
<span class="gh">index 011332c..80eb496 100644</span>
<span class="gd">--- a/app/views/staff/customers/_form.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/_form.html.erb</span>
<span class="gu">@@ -3,10 +3,16 @@</span>
<span class="w"> </span>  &lt;legend&gt;&lt;%= t(&#39;staff.customers.new.basic_info&#39;) %&gt;&lt;/legend&gt;
<span class="w"> </span>  &lt;%= render &#39;customer_fields&#39;, f: f %&gt;
<span class="w"> </span>&lt;/fieldset&gt;
<span class="gi">+&lt;div&gt;</span>
<span class="gi">+  &lt;%= f.check_box :inputs_home_address, label: t(&#39;staff.customers.new.home_address_inputs&#39;)  %&gt;</span>
<span class="gi">+&lt;/div&gt;</span>
<span class="w"> </span>&lt;fieldset id=&quot;home-address-fields&quot;&gt;
<span class="w"> </span>  &lt;legend&gt;&lt;%= t(&#39;staff.customers.new.home_address&#39;) %&gt;&lt;/legend&gt;
<span class="w"> </span>  &lt;%= render &#39;home_address_fields&#39;, f: f %&gt;
<span class="w"> </span>&lt;/fieldset&gt;
<span class="gi">+&lt;div&gt;</span>
<span class="gi">+  &lt;%= f.check_box :inputs_work_address, label: t(&#39;staff.customers.new.work_address_inputs&#39;) %&gt;</span>
<span class="gi">+&lt;/div&gt;</span>
<span class="w"> </span>&lt;fieldset id=&quot;work-address-fields&quot;&gt;
<span class="w"> </span>  &lt;legend&gt;&lt;%= t(&#39;staff.customers.new.work_address&#39;) %&gt;&lt;/legend&gt;
<span class="w"> </span>  &lt;%= render &#39;work_address_fields&#39;, f: f %&gt;
<span class="gh">diff --git a/app/views/staff/customers/edit.html.erb b/app/views/staff/customers/edit.html.erb</span>
<span class="gh">index b534606..9f24172 100644</span>
<span class="gd">--- a/app/views/staff/customers/edit.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/edit.html.erb</span>
<span class="gu">@@ -4,7 +4,7 @@</span>
<span class="w"> </span>&lt;/section&gt;

<span class="w"> </span>&lt;section class=&quot;Section l-column AppForm&quot;&gt;
<span class="gd">-  &lt;div class=&quot;AppForm__generic-form StaffAppForm__generic-form&quot;&gt;</span>
<span class="gi">+  &lt;div class=&quot;AppForm__generic-form StaffAppForm__generic-form AppForm__customer-form&quot;&gt;</span>
<span class="w"> </span>    &lt;%= bootstrap_form_for @customer_form, as: &#39;form&#39;, url: [:staff, @customer_form.customer] do |f| %&gt;
<span class="w"> </span>        &lt;%= render &#39;form&#39;, f: f %&gt;
<span class="w"> </span>        &lt;div class=&quot;AppForm__buttons&quot;&gt;
<span class="gh">diff --git a/app/views/staff/customers/new.html.erb b/app/views/staff/customers/new.html.erb</span>
<span class="gh">index eec2844..4514a82 100644</span>
<span class="gd">--- a/app/views/staff/customers/new.html.erb</span>
<span class="gi">+++ b/app/views/staff/customers/new.html.erb</span>
<span class="gu">@@ -4,7 +4,7 @@</span>
<span class="w"> </span>&lt;/section&gt;

<span class="w"> </span>&lt;section class=&quot;Section l-column AppForm&quot;&gt;
<span class="gd">-  &lt;div class=&quot;AppForm__generic-form StaffAppForm__generic-form&quot;&gt;</span>
<span class="gi">+  &lt;div class=&quot;AppForm__generic-form StaffAppForm__generic-form AppForm__customer-form&quot;&gt;</span>
<span class="w"> </span>    &lt;%= bootstrap_form_for @customer_form, as: &#39;form&#39;, url: :staff_customers do |f| %&gt;
<span class="w"> </span>        &lt;%= render &#39;form&#39;, f: f %&gt;
<span class="w"> </span>        &lt;div class=&quot;AppForm__buttons&quot;&gt;
<span class="gh">diff --git a/config/locales/views/ja.yml b/config/locales/views/ja.yml</span>
<span class="gh">index 398aa73..a0d1b6b 100644</span>
<span class="gd">--- a/config/locales/views/ja.yml</span>
<span class="gi">+++ b/config/locales/views/ja.yml</span>
<span class="gu">@@ -55,7 +55,9 @@ ja:</span>
<span class="w"> </span>        title: &#39;顧客の新規登録&#39;
<span class="w"> </span>        basic_info: &#39;基本情報&#39;
<span class="w"> </span>        home_address: &#39;自宅住所&#39;
<span class="gi">+        home_address_inputs: &#39;自宅住所を入力する&#39;</span>
<span class="w"> </span>        work_address: &#39;勤務先&#39;
<span class="gi">+        work_address_inputs: &#39;勤務先を入力する&#39;</span>
<span class="w"> </span>        create: &#39;登録&#39;
<span class="w"> </span>        cancel: &#39;キャンセル&#39;
<span class="w"> </span>      edit:
</code></pre></div>
<h2 id="ac215c0">コミット: ac215c0<a class="headerlink" href="#ac215c0" title="Permanent link">&para;</a></h2>
<h3 id="_31">メッセージ<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>フォームオブジェクト #15
</code></pre></div>
<h3 id="_32">変更されたファイル<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M baukis-kai.iml</li>
</ul>
<h3 id="_33">変更内容<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit ac215c05f588f52cf2aaf9c83357ec1674653234
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 16:29:44 2017 +0900

<span class="w"> </span>   フォームオブジェクト #15

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 5a8fc26..5ad36cd 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -585,6 +585,11 @@ git push heroku master</span>
<span class="w"> </span>+ PasswordHolderモジュールの抽出

<span class="w"> </span>### フォームオブジェクト
<span class="gi">+#### 自宅住所と勤務先の任意入力</span>
<span class="gi">+#### 顧客電話番号の管理（１） </span>
<span class="gi">+#### 顧客電話番号の管理（２）</span>
<span class="gi">+#### 演習問題 </span>
<span class="gi">+</span>
<span class="w"> </span>### 検索フォーム
<span class="w"> </span>**[⬆ back to top](#構成)**

<span class="gh">diff --git a/baukis-kai.iml b/baukis-kai.iml</span>
<span class="gh">index 008ed4e..7961602 100644</span>
<span class="gd">--- a/baukis-kai.iml</span>
<span class="gi">+++ b/baukis-kai.iml</span>
<span class="gu">@@ -43,9 +43,9 @@</span>
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;builder (v3.2.3, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;bundler (v1.13.7, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;byebug (v9.0.6, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="gd">-    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;capybara (v2.5.0, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;</span>
<span class="gi">+    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;capybara (v2.12.0, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;</span>
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;capybara-screenshot (v1.0.14, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="gd">-    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;capybara-webkit (v1.11.1, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;</span>
<span class="gi">+    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;capybara-webkit (v1.12.0, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;</span>
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;childprocess (v0.5.9, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;choice (v0.2.0, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;coderay (v1.1.1, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
</code></pre></div>
<h2 id="a84aa17">コミット: a84aa17<a class="headerlink" href="#a84aa17" title="Permanent link">&para;</a></h2>
<h3 id="_34">メッセージ<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Merge branch &#39;wip&#39;
</code></pre></div>
<h3 id="_35">変更されたファイル<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<h3 id="_36">変更内容<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit a84aa1792f508a4b7c1e1bb500a16f6effe1b834
Merge: 6d1204e a5f2cd9
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 16:24:58 2017 +0900

<span class="w"> </span>   Merge branch &#39;wip&#39;
</code></pre></div>
<h2 id="a5f2cd9">コミット: a5f2cd9<a class="headerlink" href="#a5f2cd9" title="Permanent link">&para;</a></h2>
<h3 id="_37">メッセージ<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>PasswordHolderモジュールの抽出 #14
</code></pre></div>
<h3 id="_38">変更されたファイル<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>A app/controllers/concerns/password_holder.rb</li>
<li>M app/models/administrator.rb</li>
<li>M app/models/customer.rb</li>
<li>M app/models/staff_member.rb</li>
</ul>
<h3 id="_39">変更内容<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit a5f2cd901f08389aefbfb843baa841afcd4498b7
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 16:24:24 2017 +0900

<span class="w"> </span>   PasswordHolderモジュールの抽出 #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index c7e684d..5a8fc26 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -582,6 +582,7 @@ git push heroku master</span>
<span class="w"> </span>#### ActiveSupport::Concernによるコード共有
<span class="w"> </span>+ PersonalNameHolderモジュールの抽出
<span class="w"> </span>+ EmailHolderモジュールの抽出
<span class="gi">++ PasswordHolderモジュールの抽出</span>

<span class="w"> </span>### フォームオブジェクト
<span class="w"> </span>### 検索フォーム
<span class="gh">diff --git a/app/controllers/concerns/password_holder.rb b/app/controllers/concerns/password_holder.rb</span>
new file mode 100644
<span class="gh">index 0000000..560a1fd</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/app/controllers/concerns/password_holder.rb</span>
<span class="gu">@@ -0,0 +1,11 @@</span>
<span class="gi">+module PasswordHolder</span>
<span class="gi">+  extend ActiveSupport::Concern</span>
<span class="gi">+</span>
<span class="gi">+  def password=(raw_password)</span>
<span class="gi">+    if raw_password.kind_of?(String)</span>
<span class="gi">+      self.hashed_password = BCrypt::Password.create(raw_password)</span>
<span class="gi">+    elsif raw_password.nil?</span>
<span class="gi">+      self.hashed_password = nil</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
\ No newline at end of file
<span class="gh">diff --git a/app/models/administrator.rb b/app/models/administrator.rb</span>
<span class="gh">index f88be8b..a6d32d4 100644</span>
<span class="gd">--- a/app/models/administrator.rb</span>
<span class="gi">+++ b/app/models/administrator.rb</span>
<span class="gu">@@ -17,14 +17,7 @@</span>

<span class="w"> </span>class Administrator &lt; ApplicationRecord
<span class="w"> </span>  include EmailHolder
<span class="gd">-</span>
<span class="gd">-  def password=(raw_password)</span>
<span class="gd">-    if raw_password.kind_of?(String)</span>
<span class="gd">-      self.hashed_password = BCrypt::Password.create(raw_password)</span>
<span class="gd">-    elsif raw_password.nil?</span>
<span class="gd">-      self.hashed_password = nil</span>
<span class="gd">-    end</span>
<span class="gd">-  end</span>
<span class="gi">+  include PasswordHolder</span>

<span class="w"> </span>  def active?
<span class="w"> </span>    !suspended?
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index 12dc7d5..3a480d3 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -24,6 +24,7 @@</span>
<span class="w"> </span>class Customer &lt; ApplicationRecord
<span class="w"> </span>  include EmailHolder
<span class="w"> </span>  include PersonalNameHolder
<span class="gi">+  include PasswordHolder</span>

<span class="w"> </span>  has_one :home_address, dependent: :destroy, autosave: true
<span class="w"> </span>  has_one :work_address, dependent: :destroy, autosave: true
<span class="gu">@@ -34,12 +35,4 @@ class Customer &lt; ApplicationRecord</span>
<span class="w"> </span>      before: -&gt;(obj) { Date.today },
<span class="w"> </span>      allow_blank: true
<span class="w"> </span>  }
<span class="gd">-</span>
<span class="gd">-  def password=(raw_password)</span>
<span class="gd">-    if raw_password.kind_of?(String)</span>
<span class="gd">-      self.hashed_password = BCrypt::Password.create(raw_password)</span>
<span class="gd">-    elsif raw_password.nil?</span>
<span class="gd">-      self.hashed_password = nil</span>
<span class="gd">-    end</span>
<span class="gd">-  end</span>
<span class="w"> </span>end
<span class="gh">diff --git a/app/models/staff_member.rb b/app/models/staff_member.rb</span>
<span class="gh">index 956375b..a6f0230 100644</span>
<span class="gd">--- a/app/models/staff_member.rb</span>
<span class="gi">+++ b/app/models/staff_member.rb</span>
<span class="gu">@@ -25,6 +25,7 @@</span>
<span class="w"> </span>class StaffMember &lt; ApplicationRecord
<span class="w"> </span>  include EmailHolder
<span class="w"> </span>  include PersonalNameHolder
<span class="gi">+  include PasswordHolder</span>

<span class="w"> </span>  has_many :events, class_name: &#39;StaffEvent&#39;, dependent: :destroy

<span class="gu">@@ -39,14 +40,6 @@ class StaffMember &lt; ApplicationRecord</span>
<span class="w"> </span>      allow_blank: true
<span class="w"> </span>  }

<span class="gd">-  def password=(raw_password)</span>
<span class="gd">-    if raw_password.kind_of?(String)</span>
<span class="gd">-      self.hashed_password = BCrypt::Password.create(raw_password)</span>
<span class="gd">-    elsif raw_password.nil?</span>
<span class="gd">-      self.hashed_password = nil</span>
<span class="gd">-    end</span>
<span class="gd">-  end</span>
<span class="gd">-</span>
<span class="w"> </span>  def active?
<span class="w"> </span>    !suspended? &amp;&amp; start_date &lt;= Date.today &amp;&amp;
<span class="w"> </span>        (end_date.nil? || end_date &gt; Date.today)
</code></pre></div>
<h3 id="_40">構造変更<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="b69c01b">コミット: b69c01b<a class="headerlink" href="#b69c01b" title="Permanent link">&para;</a></h2>
<h3 id="_41">メッセージ<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>EmailHolderモジュールの抽出 #14
</code></pre></div>
<h3 id="_42">変更されたファイル<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>A app/controllers/concerns/email_holder.rb</li>
<li>M app/models/administrator.rb</li>
<li>M app/models/customer.rb</li>
<li>M app/models/staff_member.rb</li>
</ul>
<h3 id="_43">変更内容<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit b69c01b5e2237461335b22a86f4fd81d15b2a357
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 16:19:58 2017 +0900

<span class="w"> </span>   EmailHolderモジュールの抽出 #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index e4dd7bc..c7e684d 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -581,6 +581,7 @@ git push heroku master</span>

<span class="w"> </span>#### ActiveSupport::Concernによるコード共有
<span class="w"> </span>+ PersonalNameHolderモジュールの抽出
<span class="gi">++ EmailHolderモジュールの抽出</span>

<span class="w"> </span>### フォームオブジェクト
<span class="w"> </span>### 検索フォーム
<span class="gh">diff --git a/app/controllers/concerns/email_holder.rb b/app/controllers/concerns/email_holder.rb</span>
new file mode 100644
<span class="gh">index 0000000..8f636f7</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/app/controllers/concerns/email_holder.rb</span>
<span class="gu">@@ -0,0 +1,22 @@</span>
<span class="gi">+module EmailHolder</span>
<span class="gi">+  extend ActiveSupport::Concern</span>
<span class="gi">+</span>
<span class="gi">+  included do</span>
<span class="gi">+    include StringNormalizer</span>
<span class="gi">+</span>
<span class="gi">+    before_validation do</span>
<span class="gi">+      self.email = normalize_as_email(email)</span>
<span class="gi">+      self.email_for_index = email.downcase if email</span>
<span class="gi">+    end</span>
<span class="gi">+</span>
<span class="gi">+    validates :email, presence: true, email: { alllow_blank: true }</span>
<span class="gi">+    validates :email_for_index, uniqueness: { allow_blank: true }</span>
<span class="gi">+</span>
<span class="gi">+    after_validation do</span>
<span class="gi">+      if errors.include?(:email_for_index)</span>
<span class="gi">+        errors.add(:email, :taken)</span>
<span class="gi">+        errors.delete(:email_for_index)</span>
<span class="gi">+      end</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
\ No newline at end of file
<span class="gh">diff --git a/app/models/administrator.rb b/app/models/administrator.rb</span>
<span class="gh">index 52332d4..f88be8b 100644</span>
<span class="gd">--- a/app/models/administrator.rb</span>
<span class="gi">+++ b/app/models/administrator.rb</span>
<span class="gu">@@ -16,9 +16,7 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class Administrator &lt; ApplicationRecord
<span class="gd">-  before_validation do</span>
<span class="gd">-    self.email_for_index = email.downcase if email</span>
<span class="gd">-  end</span>
<span class="gi">+  include EmailHolder</span>

<span class="w"> </span>  def password=(raw_password)
<span class="w"> </span>    if raw_password.kind_of?(String)
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index 67ff67a..12dc7d5 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -22,13 +22,11 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class Customer &lt; ApplicationRecord
<span class="gi">+  include EmailHolder</span>
<span class="w"> </span>  include PersonalNameHolder

<span class="w"> </span>  has_one :home_address, dependent: :destroy, autosave: true
<span class="w"> </span>  has_one :work_address, dependent: :destroy, autosave: true
<span class="gd">-  before_validation do</span>
<span class="gd">-    self.email_for_index = email.downcase if email</span>
<span class="gd">-  end</span>

<span class="w"> </span>  validates :gender, inclusion: { in: %w(male female), allow_blank: true }
<span class="w"> </span>  validates :birthday, date: {
<span class="gh">diff --git a/app/models/staff_member.rb b/app/models/staff_member.rb</span>
<span class="gh">index 35c13e5..956375b 100644</span>
<span class="gd">--- a/app/models/staff_member.rb</span>
<span class="gi">+++ b/app/models/staff_member.rb</span>
<span class="gu">@@ -23,17 +23,11 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class StaffMember &lt; ApplicationRecord
<span class="gd">-  include StringNormalizer</span>
<span class="gi">+  include EmailHolder</span>
<span class="w"> </span>  include PersonalNameHolder

<span class="w"> </span>  has_many :events, class_name: &#39;StaffEvent&#39;, dependent: :destroy

<span class="gd">-  before_validation do</span>
<span class="gd">-    self.email = normalize_as_email(email)</span>
<span class="gd">-    self.email_for_index = email.downcase if email</span>
<span class="gd">-  end</span>
<span class="gd">-</span>
<span class="gd">-  validates :email, presence: true, email: { alllow_blank: true }</span>
<span class="w"> </span>  validates :start_date, presence: true, date: {
<span class="w"> </span>      after_or_equal_to: Date.new(2000, 1, 1),
<span class="w"> </span>      before: -&gt; (obj) { 1.year.from_now.to_date },
<span class="gu">@@ -45,14 +39,6 @@ class StaffMember &lt; ApplicationRecord</span>
<span class="w"> </span>      allow_blank: true
<span class="w"> </span>  }

<span class="gd">-  validates :email_for_index, uniqueness: { allow_blank: true }</span>
<span class="gd">-  after_validation do</span>
<span class="gd">-    if errors.include?(:email_for_index)</span>
<span class="gd">-      errors.add(:email, :taken)</span>
<span class="gd">-      errors.delete(:email_for_index)</span>
<span class="gd">-    end</span>
<span class="gd">-  end</span>
<span class="gd">-</span>
<span class="w"> </span>  def password=(raw_password)
<span class="w"> </span>    if raw_password.kind_of?(String)
<span class="w"> </span>      self.hashed_password = BCrypt::Password.create(raw_password)
</code></pre></div>
<h3 id="_44">構造変更<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="1ce0a35">コミット: 1ce0a35<a class="headerlink" href="#1ce0a35" title="Permanent link">&para;</a></h2>
<h3 id="_45">メッセージ<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>PersonalNameHolderモジュールの抽出 #14
</code></pre></div>
<h3 id="_46">変更されたファイル<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>A app/controllers/concerns/personal_name_holder.rb</li>
<li>M app/models/customer.rb</li>
<li>M app/models/staff_member.rb</li>
</ul>
<h3 id="_47">変更内容<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 1ce0a3568f8a901910f656ef578792265972a2b7
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 16:10:11 2017 +0900

<span class="w"> </span>   PersonalNameHolderモジュールの抽出 #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 2acd2cf..e4dd7bc 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -580,6 +580,7 @@ git push heroku master</span>
<span class="w"> </span>+ autosaveオプションによる処理の簡素化

<span class="w"> </span>#### ActiveSupport::Concernによるコード共有
<span class="gi">++ PersonalNameHolderモジュールの抽出</span>

<span class="w"> </span>### フォームオブジェクト
<span class="w"> </span>### 検索フォーム
<span class="gh">diff --git a/app/controllers/concerns/personal_name_holder.rb b/app/controllers/concerns/personal_name_holder.rb</span>
new file mode 100644
<span class="gh">index 0000000..9c1a472</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/app/controllers/concerns/personal_name_holder.rb</span>
<span class="gu">@@ -0,0 +1,20 @@</span>
<span class="gi">+module PersonalNameHolder</span>
<span class="gi">+  extend ActiveSupport::Concern</span>
<span class="gi">+</span>
<span class="gi">+  HUMAN_NAME_REGEXP = /\A[p{han}\p{hiragana}\p{katakana}\u{30fc}\p{alpha}]+\z/</span>
<span class="gi">+  KATAKANA_REGEXP = /\A[\p{katakana}\u{30fc}]+\z/</span>
<span class="gi">+</span>
<span class="gi">+  included do</span>
<span class="gi">+    include StringNormalizer</span>
<span class="gi">+</span>
<span class="gi">+    before_validation do</span>
<span class="gi">+      self.family_name = normalize_as_name(family_name)</span>
<span class="gi">+      self.given_name = normalize_as_name(given_name)</span>
<span class="gi">+      self.family_name_kana = normalize_as_furigana(family_name_kana)</span>
<span class="gi">+      self.given_name_kana = normalize_as_furigana(given_name_kana)</span>
<span class="gi">+    end</span>
<span class="gi">+</span>
<span class="gi">+    validates :family_name, :given_name, presence: true, format: { with: HUMAN_NAME_REGEXP, allow_blank: true }</span>
<span class="gi">+    validates :family_name_kana, :given_name_kana, presence: true, format: { with: KATAKANA_REGEXP, allow_blank: true }</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
\ No newline at end of file
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index f91be55..67ff67a 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -22,6 +22,8 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class Customer &lt; ApplicationRecord
<span class="gi">+  include PersonalNameHolder</span>
<span class="gi">+</span>
<span class="w"> </span>  has_one :home_address, dependent: :destroy, autosave: true
<span class="w"> </span>  has_one :work_address, dependent: :destroy, autosave: true
<span class="w"> </span>  before_validation do
<span class="gh">diff --git a/app/models/staff_member.rb b/app/models/staff_member.rb</span>
<span class="gh">index e9c0e92..35c13e5 100644</span>
<span class="gd">--- a/app/models/staff_member.rb</span>
<span class="gi">+++ b/app/models/staff_member.rb</span>
<span class="gu">@@ -24,24 +24,16 @@</span>

<span class="w"> </span>class StaffMember &lt; ApplicationRecord
<span class="w"> </span>  include StringNormalizer
<span class="gi">+  include PersonalNameHolder</span>

<span class="w"> </span>  has_many :events, class_name: &#39;StaffEvent&#39;, dependent: :destroy

<span class="w"> </span>  before_validation do
<span class="w"> </span>    self.email = normalize_as_email(email)
<span class="w"> </span>    self.email_for_index = email.downcase if email
<span class="gd">-    self.family_name = normalize_as_name(family_name)</span>
<span class="gd">-    self.given_name = normalize_as_name(given_name)</span>
<span class="gd">-    self.family_name_kana = normalize_as_furigana(family_name_kana)</span>
<span class="gd">-    self.given_name_kana = normalize_as_furigana(given_name_kana)</span>
<span class="w"> </span>  end

<span class="gd">-  HUMAN_NAME_REGEXP = /\A[p{han}\p{hiragana}\p{katakana}\u{30fc}\p{alpha}]+\z/</span>
<span class="gd">-  KATAKANA_REGEXP = /\A[\p{katakana}\u{30fc}]+\z/</span>
<span class="gd">-</span>
<span class="w"> </span>  validates :email, presence: true, email: { alllow_blank: true }
<span class="gd">-  validates :family_name, :given_name, presence: true, format: { with: HUMAN_NAME_REGEXP, allow_blank: true }</span>
<span class="gd">-  validates :family_name_kana, :given_name_kana, presence: true, format: { with: KATAKANA_REGEXP, allow_blank: true }</span>
<span class="w"> </span>  validates :start_date, presence: true, date: {
<span class="w"> </span>      after_or_equal_to: Date.new(2000, 1, 1),
<span class="w"> </span>      before: -&gt; (obj) { 1.year.from_now.to_date },
</code></pre></div>
<h3 id="_48">構造変更<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="f01cc5c">コミット: f01cc5c<a class="headerlink" href="#f01cc5c" title="Permanent link">&para;</a></h2>
<h3 id="_49">メッセージ<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>autosaveオプションによる処理の簡素化 #14
</code></pre></div>
<h3 id="_50">変更されたファイル<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_form.rb</li>
<li>M app/models/customer.rb</li>
</ul>
<h3 id="_51">変更内容<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit f01cc5c394dd8defaf1a1f7a2251b9f2959be9c9
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 15:57:58 2017 +0900

<span class="w"> </span>   autosaveオプションによる処理の簡素化 #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index a8ac2bc..2acd2cf 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -577,6 +577,7 @@ git push heroku master</span>
<span class="w"> </span>+ モデルオブジェクトにおける値の正規化とバリデーション
<span class="w"> </span>+ フォームオブジェクトにおけるバリエーションの実施
<span class="w"> </span>+ バリデーションのテスト
<span class="gi">++ autosaveオプションによる処理の簡素化</span>

<span class="w"> </span>#### ActiveSupport::Concernによるコード共有

<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index 351a5ce..271fd36 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -2,7 +2,7 @@ class Staff::CustomerForm</span>
<span class="w"> </span>  include ActiveModel::Model

<span class="w"> </span>  attr_accessor :customer
<span class="gd">-  delegate :persisted?, to: :customer</span>
<span class="gi">+  delegate :persisted?, :save, to: :customer</span>

<span class="w"> </span>  def initialize(customer = nil)
<span class="w"> </span>    @customer = customer
<span class="gu">@@ -19,20 +19,6 @@ class Staff::CustomerForm</span>
<span class="w"> </span>    customer.work_address.assign_attributes(work_address_params)
<span class="w"> </span>  end

<span class="gd">-  def valid?</span>
<span class="gd">-    [ customer, customer.home_address, customer.work_address ].map(&amp;:valid?).all?</span>
<span class="gd">-  end</span>
<span class="gd">-</span>
<span class="gd">-  def save</span>
<span class="gd">-    ActiveRecord::Base.transaction do</span>
<span class="gd">-      if valid?</span>
<span class="gd">-        customer.save!</span>
<span class="gd">-        customer.home_address.save!</span>
<span class="gd">-        customer.work_address.save!</span>
<span class="gd">-      end</span>
<span class="gd">-    end</span>
<span class="gd">-  end</span>
<span class="gd">-</span>
<span class="w"> </span>  private
<span class="w"> </span>  def customer_params
<span class="w"> </span>    @params.require(:customer).permit(
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index e8c43a8..f91be55 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -22,8 +22,8 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class Customer &lt; ApplicationRecord
<span class="gd">-  has_one :home_address, dependent: :destroy</span>
<span class="gd">-  has_one :work_address, dependent: :destroy</span>
<span class="gi">+  has_one :home_address, dependent: :destroy, autosave: true</span>
<span class="gi">+  has_one :work_address, dependent: :destroy, autosave: true</span>
<span class="w"> </span>  before_validation do
<span class="w"> </span>    self.email_for_index = email.downcase if email
<span class="w"> </span>  end
</code></pre></div>
<h3 id="_52">構造変更<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="014dfb6">コミット: 014dfb6<a class="headerlink" href="#014dfb6" title="Permanent link">&para;</a></h2>
<h3 id="_53">メッセージ<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>バリデーションのテスト #14
</code></pre></div>
<h3 id="_54">変更されたファイル<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
</ul>
<h3 id="_55">変更内容<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 014dfb67b3c5d6e4c269255fcd2c7694cea1efca
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 15:52:02 2017 +0900

<span class="w"> </span>   バリデーションのテスト #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index bb05cb2..a8ac2bc 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -576,6 +576,7 @@ git push heroku master</span>
<span class="w"> </span>#### 顧客アカウント新規登録・更新機能の改良
<span class="w"> </span>+ モデルオブジェクトにおける値の正規化とバリデーション
<span class="w"> </span>+ フォームオブジェクトにおけるバリエーションの実施
<span class="gi">++ バリデーションのテスト</span>

<span class="w"> </span>#### ActiveSupport::Concernによるコード共有

<span class="gh">diff --git a/spec/features/staff/customer_nanagement_spec.rb b/spec/features/staff/customer_management_spec.rb</span>
similarity index 83%
rename from spec/features/staff/customer_nanagement_spec.rb
rename to spec/features/staff/customer_management_spec.rb
<span class="gh">index 1d853aa..a03060c 100644</span>
<span class="gd">--- a/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gi">+++ b/spec/features/staff/customer_management_spec.rb</span>
<span class="gu">@@ -14,7 +14,6 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>  # 職員が顧客、自宅住所、勤務先を更新する
<span class="w"> </span>  scenario &#39;Staff update customer, home address, work place&#39; do
<span class="w"> </span>    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)
<span class="gd">-</span>
<span class="w"> </span>    first(&#39;table.Table__body--listing&#39;).click_link I18n.t(&#39;staff.customers.index.edit&#39;)

<span class="w"> </span>    fill_in I18n.t(&#39;activerecord.attributes.customer.email&#39;), with: &#39;test@example.jp&#39;
<span class="gu">@@ -71,4 +70,19 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>    expect(new_customer.home_address.postal_code).to eq(&#39;1000001&#39;)
<span class="w"> </span>    expect(new_customer.work_address.company_name).to eq(&#39;テスト&#39;)
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  # 職員が生年月日と自宅の郵便番号に無効な値を入力する</span>
<span class="gi">+  scenario &#39;Employees enter invalid values for birth date and home postal code&#39; do</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+    first(&#39;table.Table__body--listing&#39;).click_link I18n.t(&#39;staff.customers.index.edit&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.birthday&#39;), with: &#39;2100-01-01&#39;</span>
<span class="gi">+    within(&#39;fieldset#home-address-fields&#39;) do</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.home_address.postal_code&#39;), with: &#39;XYZ&#39;</span>
<span class="gi">+    end</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.edit.update&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    expect(page).to have_css(&#39;header span.Flash__alert&#39;)</span>
<span class="gi">+    expect(page).to have_css(&#39;.has-error span.help-block&#39;)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
</code></pre></div>
<h2 id="23f580b">コミット: 23f580b<a class="headerlink" href="#23f580b" title="Permanent link">&para;</a></h2>
<h3 id="_56">メッセージ<a class="headerlink" href="#_56" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>フォームオブジェクトにおけるバリエーションの実施 #14
</code></pre></div>
<h3 id="_57">変更されたファイル<a class="headerlink" href="#_57" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/forms/staff/customer_form.rb</li>
</ul>
<h3 id="_58">変更内容<a class="headerlink" href="#_58" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 23f580bdf6e7dcc1873398615dd839b051094d94
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 15:37:09 2017 +0900

<span class="w"> </span>   フォームオブジェクトにおけるバリエーションの実施 #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 1a6a544..bb05cb2 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -575,6 +575,7 @@ git push heroku master</span>

<span class="w"> </span>#### 顧客アカウント新規登録・更新機能の改良
<span class="w"> </span>+ モデルオブジェクトにおける値の正規化とバリデーション
<span class="gi">++ フォームオブジェクトにおけるバリエーションの実施</span>

<span class="w"> </span>#### ActiveSupport::Concernによるコード共有

<span class="gh">diff --git a/app/forms/staff/customer_form.rb b/app/forms/staff/customer_form.rb</span>
<span class="gh">index 69dc6e2..351a5ce 100644</span>
<span class="gd">--- a/app/forms/staff/customer_form.rb</span>
<span class="gi">+++ b/app/forms/staff/customer_form.rb</span>
<span class="gu">@@ -19,11 +19,17 @@ class Staff::CustomerForm</span>
<span class="w"> </span>    customer.work_address.assign_attributes(work_address_params)
<span class="w"> </span>  end

<span class="gi">+  def valid?</span>
<span class="gi">+    [ customer, customer.home_address, customer.work_address ].map(&amp;:valid?).all?</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="w"> </span>  def save
<span class="w"> </span>    ActiveRecord::Base.transaction do
<span class="gd">-      customer.save!</span>
<span class="gd">-      customer.home_address.save!</span>
<span class="gd">-      customer.work_address.save!</span>
<span class="gi">+      if valid?</span>
<span class="gi">+        customer.save!</span>
<span class="gi">+        customer.home_address.save!</span>
<span class="gi">+        customer.work_address.save!</span>
<span class="gi">+      end</span>
<span class="w"> </span>    end
<span class="w"> </span>  end
</code></pre></div>
<h2 id="621abf2">コミット: 621abf2<a class="headerlink" href="#621abf2" title="Permanent link">&para;</a></h2>
<h3 id="_59">メッセージ<a class="headerlink" href="#_59" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>モデルオブジェクトにおける値の正規化とバリデーション #14
</code></pre></div>
<h3 id="_60">変更されたファイル<a class="headerlink" href="#_60" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M app/models/address.rb</li>
<li>M app/models/concerns/string_normalizer.rb</li>
<li>M app/models/customer.rb</li>
<li>M app/models/home_address.rb</li>
<li>M app/models/work_address.rb</li>
<li>M config/locales/models/ja.yml</li>
<li>M spec/factories/addresses.rb</li>
<li>M spec/features/staff/customer_nanagement_spec.rb</li>
</ul>
<h3 id="_61">変更内容<a class="headerlink" href="#_61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit 621abf2875583495da05d1fd27a6d236536e7521
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 15:02:41 2017 +0900

<span class="w"> </span>   モデルオブジェクトにおける値の正規化とバリデーション #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 6a4246f..1a6a544 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -574,6 +574,8 @@ git push heroku master</span>
<span class="w"> </span>+ 顧客アカウント新規登録機能のテスト

<span class="w"> </span>#### 顧客アカウント新規登録・更新機能の改良
<span class="gi">++ モデルオブジェクトにおける値の正規化とバリデーション</span>
<span class="gi">+</span>
<span class="w"> </span>#### ActiveSupport::Concernによるコード共有

<span class="w"> </span>### フォームオブジェクト
<span class="gh">diff --git a/app/models/address.rb b/app/models/address.rb</span>
<span class="gh">index fd01b80..e4133f5 100644</span>
<span class="gd">--- a/app/models/address.rb</span>
<span class="gi">+++ b/app/models/address.rb</span>
<span class="gu">@@ -22,8 +22,17 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class Address &lt; ApplicationRecord
<span class="gi">+  include StringNormalizer</span>
<span class="gi">+</span>
<span class="w"> </span>  belongs_to :customer

<span class="gi">+  before_validation do</span>
<span class="gi">+    self.postal_code = normalize_as_postal_code(postal_code)</span>
<span class="gi">+    self.city = normalize_as_name(city)</span>
<span class="gi">+    self.address1 = normalize_as_name(address1)</span>
<span class="gi">+    self.address2 = normalize_as_name(address2)</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="w"> </span>  PREFECTURE_NAMES = %w(
<span class="w"> </span>    北海道
<span class="w"> </span>    青森県 岩手県 宮城県 秋田県 山形県 福島県
<span class="gu">@@ -36,4 +45,7 @@ class Address &lt; ApplicationRecord</span>
<span class="w"> </span>    沖縄県
<span class="w"> </span>    日本国外
<span class="w"> </span>  )
<span class="gi">+</span>
<span class="gi">+  validates :postal_code, format: { with: /\A\d{7}\z/, allow_blank: true }</span>
<span class="gi">+  validates :prefecture, inclusion: { in: PREFECTURE_NAMES, allow_blank: true }</span>
<span class="w"> </span>end
<span class="gh">diff --git a/app/models/concerns/string_normalizer.rb b/app/models/concerns/string_normalizer.rb</span>
<span class="gh">index 13a558b..f036970 100644</span>
<span class="gd">--- a/app/models/concerns/string_normalizer.rb</span>
<span class="gi">+++ b/app/models/concerns/string_normalizer.rb</span>
<span class="gu">@@ -14,4 +14,8 @@ module StringNormalizer</span>
<span class="w"> </span>  def normalize_as_furigana(text)
<span class="w"> </span>    NKF.nkf(&#39;-w -Z1 --katakana&#39;, text).strip if text
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  def normalize_as_postal_code(text)</span>
<span class="gi">+    NKF.nkf(&#39;-w -Z1&#39;, text).strip.gsub(/-/, &#39;&#39;) if text</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
<span class="gh">diff --git a/app/models/customer.rb b/app/models/customer.rb</span>
<span class="gh">index 04386e3..e8c43a8 100644</span>
<span class="gd">--- a/app/models/customer.rb</span>
<span class="gi">+++ b/app/models/customer.rb</span>
<span class="gu">@@ -28,6 +28,13 @@ class Customer &lt; ApplicationRecord</span>
<span class="w"> </span>    self.email_for_index = email.downcase if email
<span class="w"> </span>  end

<span class="gi">+  validates :gender, inclusion: { in: %w(male female), allow_blank: true }</span>
<span class="gi">+  validates :birthday, date: {</span>
<span class="gi">+      after: Date.new(1900,1,1),</span>
<span class="gi">+      before: -&gt;(obj) { Date.today },</span>
<span class="gi">+      allow_blank: true</span>
<span class="gi">+  }</span>
<span class="gi">+</span>
<span class="w"> </span>  def password=(raw_password)
<span class="w"> </span>    if raw_password.kind_of?(String)
<span class="w"> </span>      self.hashed_password = BCrypt::Password.create(raw_password)
<span class="gh">diff --git a/app/models/home_address.rb b/app/models/home_address.rb</span>
<span class="gh">index 0dc6aa5..fd3aa3e 100644</span>
<span class="gd">--- a/app/models/home_address.rb</span>
<span class="gi">+++ b/app/models/home_address.rb</span>
<span class="gu">@@ -22,4 +22,6 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class HomeAddress &lt; Address
<span class="gi">+  validates :postal_code, :prefecture, :city, :address1, presence: true</span>
<span class="gi">+  validates :company_name, :division_name, absence: true</span>
<span class="w"> </span>end
<span class="gh">diff --git a/app/models/work_address.rb b/app/models/work_address.rb</span>
<span class="gh">index 93e332b..de8d396 100644</span>
<span class="gd">--- a/app/models/work_address.rb</span>
<span class="gi">+++ b/app/models/work_address.rb</span>
<span class="gu">@@ -22,4 +22,10 @@</span>
<span class="w"> </span>#

<span class="w"> </span>class WorkAddress &lt; Address
<span class="gi">+  before_validation do</span>
<span class="gi">+    self.company_name = normalize_as_name(company_name)</span>
<span class="gi">+    self.division_name = normalize_as_name(division_name)</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  validates :company_name, presence: true</span>
<span class="w"> </span>end
<span class="gh">diff --git a/config/locales/models/ja.yml b/config/locales/models/ja.yml</span>
<span class="gh">index b4eafec..cf31ec0 100644</span>
<span class="gd">--- a/config/locales/models/ja.yml</span>
<span class="gi">+++ b/config/locales/models/ja.yml</span>
<span class="gu">@@ -90,6 +90,15 @@ ja:</span>
<span class="w"> </span>                after_or_equal_to: には2000年1月1日以降の日付を指定してください。
<span class="w"> </span>                before: には1年後の日付より前の日付を指定してください。
<span class="w"> </span>                after: には開始日より後の日付を指定してください。
<span class="gi">+                after: には開始日より後の日付を指定してください。</span>
<span class="gi">+</span>
<span class="gi">+        customer:</span>
<span class="gi">+          attributes:</span>
<span class="gi">+            email:</span>
<span class="gi">+              taken: が他の顧客と重複しています</span>
<span class="gi">+              birthday:</span>
<span class="gi">+                after_or_equal_to: には1900年1月1日以降の日時を指定してください。</span>
<span class="gi">+                before: が未来の日付です。</span>

<span class="w"> </span>  activemodel:
<span class="w"> </span>    models:
<span class="gh">diff --git a/spec/factories/addresses.rb b/spec/factories/addresses.rb</span>
<span class="gh">index 2a866b7..076c809 100644</span>
<span class="gd">--- a/spec/factories/addresses.rb</span>
<span class="gi">+++ b/spec/factories/addresses.rb</span>
<span class="gu">@@ -23,7 +23,7 @@</span>

<span class="w"> </span>FactoryGirl.define do
<span class="w"> </span>  factory :home_address do
<span class="gd">-    postal_code &#39;10000000&#39;</span>
<span class="gi">+    postal_code &#39;1000000&#39;</span>
<span class="w"> </span>    prefecture &#39;東京都&#39;
<span class="w"> </span>    city &#39;千代田区&#39;
<span class="w"> </span>    address1 &#39;試験1-1-1&#39;
<span class="gu">@@ -33,7 +33,7 @@ FactoryGirl.define do</span>
<span class="w"> </span>  factory :work_address do
<span class="w"> </span>    company_name &#39;テスト&#39;
<span class="w"> </span>    division_name &#39;開発部&#39;
<span class="gd">-    postal_code &#39;10500000&#39;</span>
<span class="gi">+    postal_code &#39;1050000&#39;</span>
<span class="w"> </span>    prefecture &#39;東京都&#39;
<span class="w"> </span>    city &#39;港区&#39;
<span class="w"> </span>    address1 &#39;試験1-1-1&#39;
<span class="gh">diff --git a/spec/features/staff/customer_nanagement_spec.rb b/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gh">index ae8a741..1d853aa 100644</span>
<span class="gd">--- a/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gi">+++ b/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gu">@@ -19,7 +19,7 @@ feature &#39;Customer management by staff&#39; do</span>

<span class="w"> </span>    fill_in I18n.t(&#39;activerecord.attributes.customer.email&#39;), with: &#39;test@example.jp&#39;
<span class="w"> </span>    within(&#39;fieldset#home-address-fields&#39;) do
<span class="gd">-      fill_in I18n.t(&#39;activerecord.attributes.home_address.postal_code&#39;), with: &#39;99999999&#39;</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.home_address.postal_code&#39;), with: &#39;9999999&#39;</span>
<span class="w"> </span>    end
<span class="w"> </span>    within(&#39;fieldset#work-address-fields&#39;) do
<span class="w"> </span>      fill_in I18n.t(&#39;activerecord.attributes.work_address.company_name&#39;), with: &#39;テスト&#39;
<span class="gu">@@ -28,7 +28,7 @@ feature &#39;Customer management by staff&#39; do</span>

<span class="w"> </span>    customer.reload
<span class="w"> </span>    expect(customer.email).to eq(&#39;test@example.jp&#39;)
<span class="gd">-    expect(customer.home_address.postal_code).to eq(&#39;99999999&#39;)</span>
<span class="gi">+    expect(customer.home_address.postal_code).to eq(&#39;9999999&#39;)</span>
<span class="w"> </span>    expect(customer.work_address.company_name).to eq(&#39;テスト&#39;)
<span class="w"> </span>  end
</code></pre></div>
<h3 id="_62">構造変更<a class="headerlink" href="#_62" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNTdweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjU4N3B4O2hlaWdodDoyNTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1ODcgMjU3IiB3aWR0aD0iNTg3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjkxNDEiIHg9IjUiIHk9IjE2LjEzODciPldlbGNvbWUgdG8gUGxhbnRVTUwhPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMzAuMTA3NCI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ny4xMDc0IiB4PSI1IiB5PSI0NC4wNzYyIj5Zb3UgY2FuIHN0YXJ0IHdpdGggYSBzaW1wbGUgVU1MIERpYWdyYW0gbGlrZTo8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSI1OC4wNDQ5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjIuODE4NCIgeD0iNSIgeT0iNzIuMDEzNyI+Qm9iLSZndDtBbGljZTomIzE2MDtIZWxsbzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9Ijg1Ljk4MjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNC4zNzg5IiB4PSI1IiB5PSI5OS45NTEyIj5PcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjExMy45MTk5Ij4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My45MTk5IiB4PSI1IiB5PSIxMjcuODg4NyI+Y2xhc3MmIzE2MDtFeGFtcGxlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTQxLjg1NzQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNDEuOTUzMSIgeD0iNSIgeT0iMTU1LjgyNjIiPllvdSB3aWxsIGZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBQbGFudFVNTCBzeW50YXggb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjEyNS43MDEyIiB4PSIzNTAuNzY3NiIgeT0iMTU1LjgyNjIiPmh0dHBzOi8vcGxhbnR1bWwuY29tPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTY5Ljc5NDkiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjExMyIgeD0iNSIgeT0iMTgzLjc2MzciPihEZXRhaWxzIGJ5IHR5cGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwLjU3MjMiIHg9IjExNS40MjU4IiB5PSIxODMuNzYzNyI+bGljZW5zZTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS44MjIzIiB4PSIxNjkuODEyNSIgeT0iMTgzLjc2MzciPmtleXdvcmQpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMTk3LjczMjQiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjIxMS43MDEyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMy44MTQ1IiB4PSI1IiB5PSIyMjUuNjY5OSI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMuODE0NSIgeD0iNSIgeT0iMjM5LjYzODciPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzLjgxNDUiIHg9IjUiIHk9IjI1My42MDc0Ij4mIzE2MDs8L3RleHQ+PGltYWdlIGhlaWdodD0iNzEiIHdpZHRoPSI4MCIgeD0iNTA2LjQ2ODgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCSENBTUFBQUNuSERDOEFBQURBRkJNVkVYLy8vK0JwYnZEM3UvZjd2ZlB6OCtueitnM2tzdVpFRGtXQURyL3VqbHZzZHBUb2RMQ3dzT0x3T0ViZzhULy92NnBxYW1aRVRuTHlzdlQwOVRvNStqcUxTNFZBVGo5L2YyN3U3dkR3OE1UZnNLK3Y3L2o0K1NPd2VKcHJkakw0L0t4c2JFcmk4ams4UGdYYTU3YzI5dVVFVGV6MXV0UW9OSjF0TnRFbWM5Y3B0V0J1dDZheU9XLzNPNllFRGpZNnZVZmhjWEJ3Y0hzN096dzkvdjgzdDc5dVRuNysvdlgxOWVob2FIeDhmRzJ0TFhIeDhmdVZsZnJOVFlhQmpuL3ZVSDUrZm1rbzZXWGw1Zi8rZm45NXViKzlQVCs4UEQzcUtpZG1hTXhJVXJucURXY0ZqN241ZVgwOVBUdTd1MlNrcEtmblo2cnE2ejBsSlRtNHR6SnJIVWZEVDMzOS9lRkdEbjZ0amNyRXpPdnJiQnVaM2w0ZW9tU01TN0h6OVNtcHFhc3U4U0ZpWXVRRVRmYTJkdTFtNk9PTTA1MUowTldUV0w1eHNlNHVMajZ6YzMzcjYvNHZiN3lkSFhxTGkvNzJkbnRURTN0UjBpamJuNWpXM0MrdThOQU5WUXJHMFhGdWJxUlZHWnphNEdRR1QyVmFTN2EwTlBKdEk2SUpqL3pzenJmcWtYWHpyL0h3OGNnQzBMVXFsdE9RMkpzU0M1YlRHak9wRmFmU2kyK2lER3R5dDE0bTdUSmhUQ1BKVVN3b0lHL3FhK2lrSGlJZ3BDUkhqSTlqOEtYYm5hUUgwRkxmNkZHUGxwMGNuWXlLRTJyZzQ5V2o3ZEZYSG1jd3RycDZ1dSt4TWp2WVdMdlcxejk3ZTNzUEQzc1AwRHVVbFA3MDlQWXpkRFBtenFaV1d5U1JWeWdmSEhkMXNtV2taK1BnbmliRVRxc2wyNjBxNWZMdXBwSkxDL2RwajJIUEZMVHRIdi91anJUd0p5NXM2aVdqSWkwaUQzam9UVENtVTN0cmp1dlpTMnpsRnZqcTBIU3lMYllwMHFSdHMxMFhHeEVLQzl5UFZCUVpJT1BkbE52TWsyTmVZTnFSbHVqdGNDVnJyM2o1ZVkxZ0s5UW45R0xwN2xiZUpYUnhyQ2tpWkRhb3p5dWtvSitIMEIzcmMrT1l5K2lwckprWVhkaG1yNmVlMGFmczc5eHE5QmlrckdLakkzRm9tRWlMRk8wYXk2bmZJbTRwWlhSalRGdWhaU1pXbTB6Y1p5Sk4wS05UazRlZWJOZmRJR0dsWjkzaDVrY0VENW5PVll5UldiemlJazlkSjRrZXJFNVpZeFJVbkxHMWQ3cDhQVHZZMlB0VGsvMW5aMXljVi9iQUFBRngwbEVRVlI0WHUxWWUxQlVWUmcvZTNkaGw0Y3NLeXhxUGxCSlFWRVRGMmljQVkxM0dvZ2tFRnFpenFSUnBvQnBUQ0lhcGFVT2hXTmpVZE9NU0JwcUpZWlRnNEtpZ0ZLQUR6U0lWWjRxRDVWRmx1WGhMZ3ZiUGVlK3I0OVI3djJ6Myt6Y2M3N2ZPZlBiN3p2ZlBkODV1d0NJaHdUNHdQaXNBTndQQXVJS0huYkhIMUkrS3dBWERBMThTaERXNThDbmVDRW5YbDhKR3dtZkh5bENQU3ZsWi9GV3hoOFlJUkl4VFdrWkFFb2ZrVHo4c05xN3RBcUUyZ09ET0I2R1lab2JWYUgyMFNWWjRvUWNkbVhWMEw3YzRiOE9GdkpIUm9Zd2RWSW95UFgzZ3h0RkRBK1Y4ZTZtTThwQm9DamlqNHdRaVdvL0FMelYva3BraWZCaTEzcDR3YVp1R3JKRUVDeWNpeGNFVlNiWWdGd1Vvemc0L3FTcmFPeHJQN084RW9najJIRHh5TVdtenBrNjgyMyt5SWpodlI3ZkxPcERzQ3VHaHdDMFdmYmtqUXE4QTBNV0MwRWdJWXpQQ1lNeW1NOEl3Y3Z6Nks0SVd3OHNrVHJncTNpUE1JUW54ZGZLcnZ5ZWRweXZiU3N5QlF0NnpjSDZPeFhtanFZeGc5UGJnWEJCdmVLNmFSQVhORWwxU3NjK2h6N0JnbnR5b2hiL2dnUWxOcnJkemZJdW9ZS1NiNzkwNjdQclJvTG1HbzI1U2VnaEpSbjF5TXJTYlBUcHRaYW9CbHd0bFdiQkhzcHhpVyttVzgrNDZlcmVWbk1YR3hiRlErbWpvZmlIWlRyY2xKbjVFMTRVRWdkck85dFJWcGgwSERKbFlsUnNMdjRYRkE3UkJBMWtLNW9nQmI3Z3RuMDhBdnhXeW1jMmIrWXpMSEMzbm5PQ05IdmRheVVzWnBubnduUHFHZit5R0tjUEtsdjkydnRKQzIwOXpHeVJXSm1neWQxNnNTR0dUL0FtTTJyZEtaS1pIeHdDejdLVW9kTHpKT084dGg0T0JxeGRvMGMydGZVa05yM1FsSmtaUVdXTUJQMHV3Qkh2bVFRYjN6UlZDTW5zTU82QVRhemYzZjBra3phMEhUYVBDZElocHlUa25xUDYxVGUxZVYyZ1JwcjFGVW40eHR4UlQ3MnBESGhqMDkvVW5CTGppdjcycDRkOEZFdGxMaWJCZDdRZzB4SzUrWGZTOXEyQXp4U1ZIUG5OSU1CUzhCUVB3OE4xVzRnbFFXajBtdHA0K25TSGh2S1lPTTRHTDZ2SDFqR1RjRFEzcDE5NzlBUVBJNWFnWEVEWXd1UzVhd2tuSjczckhVNTZSeUxBcjZBQ3BPNWlNUkd2cDNYeWtqSW1nczRGZ20yLzdVUmM4ZGhiZUQ5amRoWVZOb24wbWRGY0FqVElYYm1DNzVWcm1WSGNRK0pESVhidU5tWVVZbFpvWXg2WGNXaktUV2F2WVhkMVd6VTlPRWg5d0xGZkVWRnphNVBFaFZoREF2Zkx4NjBjV00zZVBNYTloeVpHNUROcjZEYlFpQ1VjWVUwQUtHekd5WXhsa2Yrd3huQ2srd2R3Q2JBL1RrV0g3RGJnb3E4ZGNtS05zc1FRM0YvSm1NeGxJai9mem8vN3M5T0l3VU1lYmJZemJoMnpMZms3ZWhCR3pJYXU2T2VPK3h6R0tsQlJ3Q0dBWE5hQ0ZnWWJSb0tHK2hNVGZNZmY0TTZoMExZeHBtdi85MnltOXRJeGM0dVJ6YXd5bkNFV0dodW03b2RmOS83NXZoOHpnMGJLaWpYNUFNeGhNYWNzSzhwQnhhSmlodG5RcXIxS0c4eUZNenEvZHV0SjJpS3dOQ2JYQTdZYW1zbTJYbjBYdGd0b3dZM1h5OHJwWWM0Tk5xb244ZU00OWsrTnR6VTU1R3RNbGVHQWtOUjZvbGRETWhIK2U5RVgwSkIrVVlLdjRXZ0xackxDakhWN3dueVlsekpadllWNkE2ZDF3NnhFcGg4NDJVVXlUa2pHSWJ6d1JBL0pJT0JKS1N0ODh5Z2xxTkQxaDZUcGlRcVFWOTl3bUo3bmtuUWNnSUlIcWQwMEV3U3pndWRpZ0dZUVVIRTRxRk1jR0piMjJrcDdsTm9wOHA2em5TdHZnNVMyZTFUVlJ0aTU2dy96ajhmWnpLTGlEYTMxN01xQlFGYnMrSjNkY2JTZ28rSDREMGtMT29rSjgyL05SOEtaYnA5ZUlaZ2xsd0tSOEVjMWVqSVg4MjdQT2svMDZIcFlmZkdkNWRrb1pKWE1xREFWWGQxTmJoYXZseDRPeXVBaVBjeUFGM0ljazhmYVhBdUU1V1RvQXBrTXh5a0wxUGJOUko5MVNEa1hPeXltUEZSMVVNbHc5R2pSUEtDclBzUlN2VW5iemJrRUxqMlBTU1JrUUxpSDFBdlJPVHV0bHByeUxIUUFvQ0QrQzJCQlA0bnBNd2Q5enNJZ3pnYURzSytiY3RtVnczaGV0YWk1dDlSUzRQRXF1YjRRbkN2eHRlR3pPWnlRWHhqc2N4a2hIaXNXS01pNzIrVDBwMWR4R2VHWWtHMGV6K2VlRzdJbi9uL29OT2V4QzlmeklpTHZQeFZ0S3A4NGl6YStBQUFBQUVsRlRrU3VRbUNDIiB5PSIxODUuNDM3NSIvPjwhLS1TUkM9W0tyVHV0M1p2U1VFd25xc1I3cFZGVnpwU19CWXZ1dDdad2lURDdPLVJrZnlqeHR4UGlFM2ZhaXZkaXhTeVJmaHFPazZBbnVxcDdwU3RGNnZReWhYZnFVRWMzTy1STHB2a05XMkswWGkySEFqVnhEX3hqNmwxdXlSZlpua05GTXhpVnptOFA0enp0RFoyZlF4bVA1LXQ1UDFBcGFhaUJiUm1Jb3J0MVo3VzBndUxjU0tiY05kZkM1Nk8wV0xUTkpqS0lHMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h2 id="d5c3d36">コミット: d5c3d36<a class="headerlink" href="#d5c3d36" title="Permanent link">&para;</a></h2>
<h3 id="_63">メッセージ<a class="headerlink" href="#_63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>顧客アカウント新規登録機能のテスト #14
</code></pre></div>
<h3 id="_64">変更されたファイル<a class="headerlink" href="#_64" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M spec/features/staff/customer_nanagement_spec.rb</li>
</ul>
<h3 id="_65">変更内容<a class="headerlink" href="#_65" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit d5c3d36235d0bd14a007afd2aad6c91acc406de7
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 14:39:27 2017 +0900

<span class="w"> </span>   顧客アカウント新規登録機能のテスト #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index effb203..6a4246f 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -571,6 +571,7 @@ git push heroku master</span>
<span class="w"> </span>+ Capybaraとは
<span class="w"> </span>+ 準備作業
<span class="w"> </span>+ 顧客アカウント更新機能のテスト
<span class="gi">++ 顧客アカウント新規登録機能のテスト</span>

<span class="w"> </span>#### 顧客アカウント新規登録・更新機能の改良
<span class="w"> </span>#### ActiveSupport::Concernによるコード共有
<span class="gh">diff --git a/spec/features/staff/customer_nanagement_spec.rb b/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gh">index fc8c27b..ae8a741 100644</span>
<span class="gd">--- a/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gi">+++ b/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gu">@@ -31,4 +31,44 @@ feature &#39;Customer management by staff&#39; do</span>
<span class="w"> </span>    expect(customer.home_address.postal_code).to eq(&#39;99999999&#39;)
<span class="w"> </span>    expect(customer.work_address.company_name).to eq(&#39;テスト&#39;)
<span class="w"> </span>  end
<span class="gi">+</span>
<span class="gi">+  # 職員が顧客、自宅住所、勤務先を登録する</span>
<span class="gi">+  scenario &#39;Employees register customer, home address, work place&#39; do</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    first(&#39;.Table__links&#39;).click_link I18n.t(&#39;staff.customers.index.new&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.email&#39;), with: &#39;test@example.jp&#39;</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.hashed_password&#39;), with: &#39;pw&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_family_name&#39;, with: &#39;試験&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_given_name&#39;, with: &#39;花子&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_family_name_kana&#39;, with: &#39;シケン&#39;</span>
<span class="gi">+    fill_in &#39;form_customer_given_name_kana&#39;, with: &#39;ハナコ&#39;</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.birthday&#39;), with: &#39;1970-01-01&#39;</span>
<span class="gi">+    choose &#39;女性&#39;</span>
<span class="gi">+    within(&#39;fieldset#home-address-fields&#39;) do</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.home_address.postal_code&#39;), with: &#39;1000001&#39;</span>
<span class="gi">+      select &#39;東京都&#39;, from: I18n.t(&#39;activerecord.attributes.home_address.prefecture&#39;)</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.home_address.city&#39;), with: &#39;千代田区&#39;</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.home_address.address1&#39;), with: &#39;千代田1-1-1&#39;</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.home_address.address2&#39;), with: &#39;&#39;</span>
<span class="gi">+    end</span>
<span class="gi">+    within(&#39;fieldset#work-address-fields&#39;) do</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.company_name&#39;), with: &#39;テスト&#39;</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.division_name&#39;), with: &#39;&#39;</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.postal_code&#39;), with: &#39;&#39;</span>
<span class="gi">+      select &#39;&#39;, from: I18n.t(&#39;activerecord.attributes.work_address.prefecture&#39;)</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.city&#39;), with: &#39;&#39;</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.address1&#39;), with: &#39;&#39;</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.address2&#39;), with: &#39;&#39;</span>
<span class="gi">+    end</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.new.create&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    new_customer = Customer.order(:id).last</span>
<span class="gi">+    expect(new_customer.email).to eq(&#39;test@example.jp&#39;)</span>
<span class="gi">+    expect(new_customer.birthday).to eq(Date.new(1970,1,1))</span>
<span class="gi">+    expect(new_customer.gender).to eq(&#39;female&#39;)</span>
<span class="gi">+    expect(new_customer.home_address.postal_code).to eq(&#39;1000001&#39;)</span>
<span class="gi">+    expect(new_customer.work_address.company_name).to eq(&#39;テスト&#39;)</span>
<span class="gi">+  end</span>
<span class="w"> </span>end
\ No newline at end of file
</code></pre></div>
<h2 id="b002a0a">コミット: b002a0a<a class="headerlink" href="#b002a0a" title="Permanent link">&para;</a></h2>
<h3 id="_66">メッセージ<a class="headerlink" href="#_66" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>顧客アカウント更新機能のテスト #14
</code></pre></div>
<h3 id="_67">変更されたファイル<a class="headerlink" href="#_67" title="Permanent link">&para;</a></h3>
<ul>
<li>M .idea/.generators</li>
<li>M .idea/.rakeTasks</li>
<li>M Gemfile</li>
<li>M Gemfile.lock</li>
<li>M README.md</li>
<li>M baukis-kai.iml</li>
<li>M config/locales/views/ja.yml</li>
<li>A spec/features/staff/customer_nanagement_spec.rb</li>
<li>M spec/rails_helper.rb</li>
<li>M spec/support/features_spec_helper.rb</li>
</ul>
<h3 id="_68">変更内容<a class="headerlink" href="#_68" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit b002a0a6b1d65e55b3fdb1c827cf8e055ed93167
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 14:13:18 2017 +0900

<span class="w"> </span>   顧客アカウント更新機能のテスト #14

<span class="gh">diff --git a/.idea/.generators b/.idea/.generators</span>
<span class="gh">index a68204b..1618976 100644</span>
<span class="gd">--- a/.idea/.generators</span>
<span class="gi">+++ b/.idea/.generators</span>
<span class="gu">@@ -5,4 +5,4 @@ You are allowed to:</span>
<span class="w"> </span>2. Remove generators
<span class="w"> </span>3. Add installed generators
<span class="w"> </span>To add new installed generators automatically delete this file and reload the project.
<span class="gd">---&gt;&lt;GeneratorsGroup&gt;&lt;Generator name=&quot;annotate:install&quot; /&gt;&lt;Generator name=&quot;assets&quot; /&gt;&lt;Generator name=&quot;channel&quot; /&gt;&lt;Generator name=&quot;coffee:assets&quot; /&gt;&lt;Generator name=&quot;controller&quot; /&gt;&lt;Generator name=&quot;erd:install&quot; /&gt;&lt;Generator name=&quot;factory_girl:model&quot; /&gt;&lt;Generator name=&quot;generator&quot; /&gt;&lt;Generator name=&quot;helper&quot; /&gt;&lt;Generator name=&quot;i18n&quot; /&gt;&lt;Generator name=&quot;i18n_locale&quot; /&gt;&lt;Generator name=&quot;i18n_translation&quot; /&gt;&lt;Generator name=&quot;integration_test&quot; /&gt;&lt;Generator name=&quot;jbuilder&quot; /&gt;&lt;Generator name=&quot;job&quot; /&gt;&lt;Generator name=&quot;js:assets&quot; /&gt;&lt;Generator name=&quot;kaminari:config&quot; /&gt;&lt;Generator name=&quot;kaminari:views&quot; /&gt;&lt;Generator name=&quot;mailer&quot; /&gt;&lt;Generator name=&quot;migration&quot; /&gt;&lt;Generator name=&quot;model&quot; /&gt;&lt;Generator name=&quot;rack:dev-mark:install&quot; /&gt;&lt;Generator name=&quot;resource&quot; /&gt;&lt;Generator name=&quot;rspec:controller&quot; /&gt;&lt;Generator name=&quot;rspec:feature&quot; /&gt;&lt;Generator name=&quot;rspec:helper&quot; /&gt;&lt;Generator name=&quot;rspec:install&quot; /&gt;&lt;Generator name=&quot;rspec:integration&quot; /&gt;&lt;Generator name=&quot;rspec:job&quot; /&gt;&lt;Generator name=&quot;rspec:mailer&quot; /&gt;&lt;Generator name=&quot;rspec:model&quot; /&gt;&lt;Generator name=&quot;rspec:observer&quot; /&gt;&lt;Generator name=&quot;rspec:request&quot; /&gt;&lt;Generator name=&quot;rspec:scaffold&quot; /&gt;&lt;Generator name=&quot;rspec:view&quot; /&gt;&lt;Generator name=&quot;scaffold&quot; /&gt;&lt;Generator name=&quot;scaffold_controller&quot; /&gt;&lt;Generator name=&quot;task&quot; /&gt;&lt;Generator name=&quot;test_unit:controller&quot; /&gt;&lt;Generator name=&quot;test_unit:generator&quot; /&gt;&lt;Generator name=&quot;test_unit:helper&quot; /&gt;&lt;Generator name=&quot;test_unit:integration&quot; /&gt;&lt;Generator name=&quot;test_unit:job&quot; /&gt;&lt;Generator name=&quot;test_unit:mailer&quot; /&gt;&lt;Generator name=&quot;test_unit:model&quot; /&gt;&lt;Generator name=&quot;test_unit:plugin&quot; /&gt;&lt;Generator name=&quot;test_unit:scaffold&quot; /&gt;&lt;/GeneratorsGroup&gt;&lt;/Settings&gt;</span>
<span class="gi">+--&gt;&lt;GeneratorsGroup&gt;&lt;Generator name=&quot;active_record:migration&quot; /&gt;&lt;Generator name=&quot;active_record:model&quot; /&gt;&lt;Generator name=&quot;active_record:observer&quot; /&gt;&lt;Generator name=&quot;active_record:session_migration&quot; /&gt;&lt;Generator name=&quot;controller&quot; /&gt;&lt;Generator name=&quot;erb:controller&quot; /&gt;&lt;Generator name=&quot;erb:mailer&quot; /&gt;&lt;Generator name=&quot;erb:scaffold&quot; /&gt;&lt;Generator name=&quot;generator&quot; /&gt;&lt;Generator name=&quot;helper&quot; /&gt;&lt;Generator name=&quot;integration_test&quot; /&gt;&lt;Generator name=&quot;mailer&quot; /&gt;&lt;Generator name=&quot;metal&quot; /&gt;&lt;Generator name=&quot;migration&quot; /&gt;&lt;Generator name=&quot;model&quot; /&gt;&lt;Generator name=&quot;model_subclass&quot; /&gt;&lt;Generator name=&quot;observer&quot; /&gt;&lt;Generator name=&quot;performance_test&quot; /&gt;&lt;Generator name=&quot;plugin&quot; /&gt;&lt;Generator name=&quot;resource&quot; /&gt;&lt;Generator name=&quot;scaffold&quot; /&gt;&lt;Generator name=&quot;scaffold_controller&quot; /&gt;&lt;Generator name=&quot;session_migration&quot; /&gt;&lt;Generator name=&quot;stylesheets&quot; /&gt;&lt;Generator name=&quot;test_unit:controller&quot; /&gt;&lt;Generator name=&quot;test_unit:helper&quot; /&gt;&lt;Generator name=&quot;test_unit:integration&quot; /&gt;&lt;Generator name=&quot;test_unit:mailer&quot; /&gt;&lt;Generator name=&quot;test_unit:model&quot; /&gt;&lt;Generator name=&quot;test_unit:observer&quot; /&gt;&lt;Generator name=&quot;test_unit:performance&quot; /&gt;&lt;Generator name=&quot;test_unit:plugin&quot; /&gt;&lt;Generator name=&quot;test_unit:scaffold&quot; /&gt;&lt;/GeneratorsGroup&gt;&lt;/Settings&gt;</span>
<span class="gh">diff --git a/.idea/.rakeTasks b/.idea/.rakeTasks</span>
<span class="gh">index fdc289b..435f846 100644</span>
<span class="gd">--- a/.idea/.rakeTasks</span>
<span class="gi">+++ b/.idea/.rakeTasks</span>
<span class="gu">@@ -4,4 +4,4 @@ You are allowed to:</span>
<span class="w"> </span>1. Remove rake task
<span class="w"> </span>2. Add existing rake tasks
<span class="w"> </span>To add existing rake tasks automatically delete this file and reload the project.
<span class="gd">---&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;rake&quot;&gt;&lt;RakeTask description=&quot;List versions of all Rails frameworks and the environment&quot; fullCmd=&quot;about&quot; taksId=&quot;about&quot; /&gt;&lt;RakeTask description=&quot;Add schema information (as comments) to model and fixture files&quot; fullCmd=&quot;annotate_models&quot; taksId=&quot;annotate_models&quot; /&gt;&lt;RakeTask description=&quot;Adds the route map to routes.rb&quot; fullCmd=&quot;annotate_routes&quot; taksId=&quot;annotate_routes&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;app&quot;&gt;&lt;RakeTask description=&quot;Applies the template supplied by LOCATION=(/path/to/template) or URL&quot; fullCmd=&quot;app:template&quot; taksId=&quot;template&quot; /&gt;&lt;RakeTask description=&quot;Update configs and some other initially generated files (or use just update:configs or update:bin)&quot; fullCmd=&quot;app:update&quot; taksId=&quot;update&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;templates&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:templates:copy&quot; taksId=&quot;copy&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;update&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:update:bin&quot; taksId=&quot;bin&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:update:configs&quot; taksId=&quot;configs&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:update:upgrade_guide_info&quot; taksId=&quot;upgrade_guide_info&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;assets&quot;&gt;&lt;RakeTask description=&quot;Remove old compiled assets&quot; fullCmd=&quot;assets:clean[keep]&quot; taksId=&quot;clean[keep]&quot; /&gt;&lt;RakeTask description=&quot;Remove compiled assets&quot; fullCmd=&quot;assets:clobber&quot; taksId=&quot;clobber&quot; /&gt;&lt;RakeTask description=&quot;Load asset compile environment&quot; fullCmd=&quot;assets:environment&quot; taksId=&quot;environment&quot; /&gt;&lt;RakeTask description=&quot;Compile all the assets named in config.assets.precompile&quot; fullCmd=&quot;assets:precompile&quot; taksId=&quot;precompile&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;assets:clean&quot; taksId=&quot;clean&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;cache_digests&quot;&gt;&lt;RakeTask description=&quot;Lookup first-level dependencies for TEMPLATE (like messages/show or comments/_comment.html)&quot; fullCmd=&quot;cache_digests:dependencies&quot; taksId=&quot;dependencies&quot; /&gt;&lt;RakeTask description=&quot;Lookup nested dependencies for TEMPLATE (like messages/show or comments/_comment.html)&quot; fullCmd=&quot;cache_digests:nested_dependencies&quot; taksId=&quot;nested_dependencies&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;db&quot;&gt;&lt;RakeTask description=&quot;Creates the database from DATABASE_URL or config/database.yml for the current RAILS_ENV (use db:create:all to create all databases in the config). Without RAILS_ENV or when RAILS_ENV is development, it defaults to creating the development and test databases&quot; fullCmd=&quot;db:create&quot; taksId=&quot;create&quot; /&gt;&lt;RakeTask description=&quot;Drops the database from DATABASE_URL or config/database.yml for the current RAILS_ENV (use db:drop:all to drop all databases in the config). Without RAILS_ENV or when RAILS_ENV is development, it defaults to dropping the development and test databases&quot; fullCmd=&quot;db:drop&quot; taksId=&quot;drop&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;environment&quot;&gt;&lt;RakeTask description=&quot;Set the environment value for the database&quot; fullCmd=&quot;db:environment:set&quot; taksId=&quot;set&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;fixtures&quot;&gt;&lt;RakeTask description=&quot;Loads fixtures into the current environment&#39;s database&quot; fullCmd=&quot;db:fixtures:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:fixtures:identify&quot; taksId=&quot;identify&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Migrate the database (options: VERSION=x, VERBOSE=false, SCOPE=blog)&quot; fullCmd=&quot;db:migrate&quot; taksId=&quot;migrate&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;migrate&quot;&gt;&lt;RakeTask description=&quot;Display status of migrations&quot; fullCmd=&quot;db:migrate:status&quot; taksId=&quot;status&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:change&quot; taksId=&quot;change&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:down&quot; taksId=&quot;down&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:redo&quot; taksId=&quot;redo&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:reset&quot; taksId=&quot;reset&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:up&quot; taksId=&quot;up&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Rolls the schema back to the previous version (specify steps w/ STEP=n)&quot; fullCmd=&quot;db:rollback&quot; taksId=&quot;rollback&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;schema&quot;&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;cache&quot;&gt;&lt;RakeTask description=&quot;Clears a db/schema_cache.dump file&quot; fullCmd=&quot;db:schema:cache:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;RakeTask description=&quot;Creates a db/schema_cache.dump file&quot; fullCmd=&quot;db:schema:cache:dump&quot; taksId=&quot;dump&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Creates a db/schema.rb file that is portable against any DB supported by Active Record&quot; fullCmd=&quot;db:schema:dump&quot; taksId=&quot;dump&quot; /&gt;&lt;RakeTask description=&quot;Loads a schema.rb file into the database&quot; fullCmd=&quot;db:schema:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:schema:load_if_ruby&quot; taksId=&quot;load_if_ruby&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Loads the seed data from db/seeds.rb&quot; fullCmd=&quot;db:seed&quot; taksId=&quot;seed&quot; /&gt;&lt;RakeTask description=&quot;Creates the database, loads the schema, and initializes with the seed data (use db:reset to also drop the database first)&quot; fullCmd=&quot;db:setup&quot; taksId=&quot;setup&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;structure&quot;&gt;&lt;RakeTask description=&quot;Dumps the database structure to db/structure.sql&quot; fullCmd=&quot;db:structure:dump&quot; taksId=&quot;dump&quot; /&gt;&lt;RakeTask description=&quot;Recreates the databases from the structure.sql file&quot; fullCmd=&quot;db:structure:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:structure:load_if_sql&quot; taksId=&quot;load_if_sql&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Retrieves the current schema version number&quot; fullCmd=&quot;db:version&quot; taksId=&quot;version&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:_dump&quot; taksId=&quot;_dump&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:abort_if_pending_migrations&quot; taksId=&quot;abort_if_pending_migrations&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:charset&quot; taksId=&quot;charset&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:check_protected_environments&quot; taksId=&quot;check_protected_environments&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:collation&quot; taksId=&quot;collation&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;create&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:create:all&quot; taksId=&quot;all&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;drop&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:drop:_unsafe&quot; taksId=&quot;_unsafe&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:drop:all&quot; taksId=&quot;all&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:forward&quot; taksId=&quot;forward&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:load_config&quot; taksId=&quot;load_config&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:purge&quot; taksId=&quot;purge&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;purge&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:purge:all&quot; taksId=&quot;all&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:reset&quot; taksId=&quot;reset&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;test&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:clone&quot; taksId=&quot;clone&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:clone_schema&quot; taksId=&quot;clone_schema&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:clone_structure&quot; taksId=&quot;clone_structure&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:deprecated&quot; taksId=&quot;deprecated&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:load_schema&quot; taksId=&quot;load_schema&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:load_structure&quot; taksId=&quot;load_structure&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:prepare&quot; taksId=&quot;prepare&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:purge&quot; taksId=&quot;purge&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;dev&quot;&gt;&lt;RakeTask description=&quot;Toggle development mode caching on/off&quot; fullCmd=&quot;dev:cache&quot; taksId=&quot;cache&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Generate an Entity-Relationship Diagram based on your models&quot; fullCmd=&quot;erd&quot; taksId=&quot;erd&quot; /&gt;&lt;RakeTask description=&quot;Print out all defined initializers in the order they are invoked by Rails&quot; fullCmd=&quot;initializers&quot; taksId=&quot;initializers&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;log&quot;&gt;&lt;RakeTask description=&quot;Truncates all/specified *.log files in log/ to zero bytes (specify which logs with LOGS=test,development)&quot; fullCmd=&quot;log:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Prints out your Rack middleware stack&quot; fullCmd=&quot;middleware&quot; taksId=&quot;middleware&quot; /&gt;&lt;RakeTask description=&quot;Enumerate all annotations (use notes:optimize, :fixme, :todo for focus)&quot; fullCmd=&quot;notes&quot; taksId=&quot;notes&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;notes&quot;&gt;&lt;RakeTask description=&quot;Enumerate a custom annotation, specify with ANNOTATION=CUSTOM&quot; fullCmd=&quot;notes:custom&quot; taksId=&quot;custom&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;notes:fixme&quot; taksId=&quot;fixme&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;notes:optimize&quot; taksId=&quot;optimize&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;notes:todo&quot; taksId=&quot;todo&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Remove schema information from model and fixture files&quot; fullCmd=&quot;remove_annotation&quot; taksId=&quot;remove_annotation&quot; /&gt;&lt;RakeTask description=&quot;Removes the route map from routes.rb&quot; fullCmd=&quot;remove_routes&quot; taksId=&quot;remove_routes&quot; /&gt;&lt;RakeTask description=&quot;Restart app by touching tmp/restart.txt&quot; fullCmd=&quot;restart&quot; taksId=&quot;restart&quot; /&gt;&lt;RakeTask description=&quot;Print out all defined routes in match order, with names&quot; fullCmd=&quot;routes&quot; taksId=&quot;routes&quot; /&gt;&lt;RakeTask description=&quot;Generate a cryptographically secure secret key (this is typically used to generate a secret for cookie sessions)&quot; fullCmd=&quot;secret&quot; taksId=&quot;secret&quot; /&gt;&lt;RakeTask description=&quot;Run all specs in spec directory (excluding plugin specs)&quot; fullCmd=&quot;spec&quot; taksId=&quot;spec&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;spec&quot;&gt;&lt;RakeTask description=&quot;Run the code examples in spec/controllers&quot; fullCmd=&quot;spec:controllers&quot; taksId=&quot;controllers&quot; /&gt;&lt;RakeTask description=&quot;Run the code examples in spec/models&quot; fullCmd=&quot;spec:models&quot; taksId=&quot;models&quot; /&gt;&lt;RakeTask description=&quot;Run the code examples in spec/routing&quot; fullCmd=&quot;spec:routing&quot; taksId=&quot;routing&quot; /&gt;&lt;RakeTask description=&quot;Run the code examples in spec/services&quot; fullCmd=&quot;spec:services&quot; taksId=&quot;services&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;spec:prepare&quot; taksId=&quot;prepare&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;spec:statsetup&quot; taksId=&quot;statsetup&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Report code statistics (KLOCs, etc) from the application or engine&quot; fullCmd=&quot;stats&quot; taksId=&quot;stats&quot; /&gt;&lt;RakeTask description=&quot;Runs all tests in test folder&quot; fullCmd=&quot;test&quot; taksId=&quot;test&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;test&quot;&gt;&lt;RakeTask description=&quot;Run tests quickly, but also reset db&quot; fullCmd=&quot;test:db&quot; taksId=&quot;db&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:controllers&quot; taksId=&quot;controllers&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:functionals&quot; taksId=&quot;functionals&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:generators&quot; taksId=&quot;generators&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:helpers&quot; taksId=&quot;helpers&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:integration&quot; taksId=&quot;integration&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:jobs&quot; taksId=&quot;jobs&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:mailers&quot; taksId=&quot;mailers&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:models&quot; taksId=&quot;models&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:prepare&quot; taksId=&quot;prepare&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:run&quot; taksId=&quot;run&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:units&quot; taksId=&quot;units&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;time&quot;&gt;&lt;RakeTask description=&quot;List all time zones, list by two-letter country code (`rails time:zones[US]`), or list by UTC offset (`rails time:zones[-8]`)&quot; fullCmd=&quot;time:zones[country_or_offset]&quot; taksId=&quot;zones[country_or_offset]&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones&quot; taksId=&quot;zones&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;zones&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones:all&quot; taksId=&quot;all&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones:local&quot; taksId=&quot;local&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones:us&quot; taksId=&quot;us&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;tmp&quot;&gt;&lt;RakeTask description=&quot;Clear cache and socket files from tmp/ (narrow w/ tmp:cache:clear, tmp:sockets:clear)&quot; fullCmd=&quot;tmp:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;RakeTask description=&quot;Creates tmp directories for cache, sockets, and pids&quot; fullCmd=&quot;tmp:create&quot; taksId=&quot;create&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;cache&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp:cache:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;pids&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp:pids:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;sockets&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp:sockets:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;default&quot; taksId=&quot;default&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;environment&quot; taksId=&quot;environment&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;erd&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;erd:generate&quot; taksId=&quot;generate&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;erd:load_models&quot; taksId=&quot;load_models&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;erd:options&quot; taksId=&quot;options&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;rails&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:template&quot; taksId=&quot;template&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;templates&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:templates:copy&quot; taksId=&quot;copy&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:update&quot; taksId=&quot;update&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;update&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:update:bin&quot; taksId=&quot;bin&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:update:configs&quot; taksId=&quot;configs&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;railties&quot;&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;install&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;railties:install:migrations&quot; taksId=&quot;migrations&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;set_annotation_options&quot; taksId=&quot;set_annotation_options&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp&quot; taksId=&quot;tmp&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/cache&quot; taksId=&quot;tmp/cache&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/cache/assets&quot; taksId=&quot;tmp/cache/assets&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/pids&quot; taksId=&quot;tmp/pids&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/sockets&quot; taksId=&quot;tmp/sockets&quot; /&gt;&lt;/RakeGroup&gt;&lt;/Settings&gt;</span>
<span class="gi">+--&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;rake&quot;&gt;&lt;RakeTask description=&quot;List versions of all Rails frameworks and the environment&quot; fullCmd=&quot;about&quot; taksId=&quot;about&quot; /&gt;&lt;RakeTask description=&quot;Add schema information (as comments) to model and fixture files&quot; fullCmd=&quot;annotate_models&quot; taksId=&quot;annotate_models&quot; /&gt;&lt;RakeTask description=&quot;Adds the route map to routes.rb&quot; fullCmd=&quot;annotate_routes&quot; taksId=&quot;annotate_routes&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;app&quot;&gt;&lt;RakeTask description=&quot;Applies the template supplied by LOCATION=(/path/to/template) or URL&quot; fullCmd=&quot;app:template&quot; taksId=&quot;template&quot; /&gt;&lt;RakeTask description=&quot;Update configs and some other initially generated files (or use just update:configs or update:bin)&quot; fullCmd=&quot;app:update&quot; taksId=&quot;update&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;templates&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:templates:copy&quot; taksId=&quot;copy&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;update&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:update:bin&quot; taksId=&quot;bin&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:update:configs&quot; taksId=&quot;configs&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;app:update:upgrade_guide_info&quot; taksId=&quot;upgrade_guide_info&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;assets&quot;&gt;&lt;RakeTask description=&quot;Remove old compiled assets&quot; fullCmd=&quot;assets:clean[keep]&quot; taksId=&quot;clean[keep]&quot; /&gt;&lt;RakeTask description=&quot;Remove compiled assets&quot; fullCmd=&quot;assets:clobber&quot; taksId=&quot;clobber&quot; /&gt;&lt;RakeTask description=&quot;Load asset compile environment&quot; fullCmd=&quot;assets:environment&quot; taksId=&quot;environment&quot; /&gt;&lt;RakeTask description=&quot;Compile all the assets named in config.assets.precompile&quot; fullCmd=&quot;assets:precompile&quot; taksId=&quot;precompile&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;assets:clean&quot; taksId=&quot;clean&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;cache_digests&quot;&gt;&lt;RakeTask description=&quot;Lookup first-level dependencies for TEMPLATE (like messages/show or comments/_comment.html)&quot; fullCmd=&quot;cache_digests:dependencies&quot; taksId=&quot;dependencies&quot; /&gt;&lt;RakeTask description=&quot;Lookup nested dependencies for TEMPLATE (like messages/show or comments/_comment.html)&quot; fullCmd=&quot;cache_digests:nested_dependencies&quot; taksId=&quot;nested_dependencies&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;db&quot;&gt;&lt;RakeTask description=&quot;Creates the database from DATABASE_URL or config/database.yml for the current RAILS_ENV (use db:create:all to create all databases in the config). Without RAILS_ENV or when RAILS_ENV is development, it defaults to creating the development and test databases&quot; fullCmd=&quot;db:create&quot; taksId=&quot;create&quot; /&gt;&lt;RakeTask description=&quot;Drops the database from DATABASE_URL or config/database.yml for the current RAILS_ENV (use db:drop:all to drop all databases in the config). Without RAILS_ENV or when RAILS_ENV is development, it defaults to dropping the development and test databases&quot; fullCmd=&quot;db:drop&quot; taksId=&quot;drop&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;environment&quot;&gt;&lt;RakeTask description=&quot;Set the environment value for the database&quot; fullCmd=&quot;db:environment:set&quot; taksId=&quot;set&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;fixtures&quot;&gt;&lt;RakeTask description=&quot;Loads fixtures into the current environment&#39;s database&quot; fullCmd=&quot;db:fixtures:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:fixtures:identify&quot; taksId=&quot;identify&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Migrate the database (options: VERSION=x, VERBOSE=false, SCOPE=blog)&quot; fullCmd=&quot;db:migrate&quot; taksId=&quot;migrate&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;migrate&quot;&gt;&lt;RakeTask description=&quot;Display status of migrations&quot; fullCmd=&quot;db:migrate:status&quot; taksId=&quot;status&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:change&quot; taksId=&quot;change&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:down&quot; taksId=&quot;down&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:redo&quot; taksId=&quot;redo&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:reset&quot; taksId=&quot;reset&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:migrate:up&quot; taksId=&quot;up&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Rolls the schema back to the previous version (specify steps w/ STEP=n)&quot; fullCmd=&quot;db:rollback&quot; taksId=&quot;rollback&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;schema&quot;&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;cache&quot;&gt;&lt;RakeTask description=&quot;Clears a db/schema_cache.dump file&quot; fullCmd=&quot;db:schema:cache:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;RakeTask description=&quot;Creates a db/schema_cache.dump file&quot; fullCmd=&quot;db:schema:cache:dump&quot; taksId=&quot;dump&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Creates a db/schema.rb file that is portable against any DB supported by Active Record&quot; fullCmd=&quot;db:schema:dump&quot; taksId=&quot;dump&quot; /&gt;&lt;RakeTask description=&quot;Loads a schema.rb file into the database&quot; fullCmd=&quot;db:schema:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:schema:load_if_ruby&quot; taksId=&quot;load_if_ruby&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Loads the seed data from db/seeds.rb&quot; fullCmd=&quot;db:seed&quot; taksId=&quot;seed&quot; /&gt;&lt;RakeTask description=&quot;Creates the database, loads the schema, and initializes with the seed data (use db:reset to also drop the database first)&quot; fullCmd=&quot;db:setup&quot; taksId=&quot;setup&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;structure&quot;&gt;&lt;RakeTask description=&quot;Dumps the database structure to db/structure.sql&quot; fullCmd=&quot;db:structure:dump&quot; taksId=&quot;dump&quot; /&gt;&lt;RakeTask description=&quot;Recreates the databases from the structure.sql file&quot; fullCmd=&quot;db:structure:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:structure:load_if_sql&quot; taksId=&quot;load_if_sql&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Retrieves the current schema version number&quot; fullCmd=&quot;db:version&quot; taksId=&quot;version&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:_dump&quot; taksId=&quot;_dump&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:abort_if_pending_migrations&quot; taksId=&quot;abort_if_pending_migrations&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:charset&quot; taksId=&quot;charset&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:check_protected_environments&quot; taksId=&quot;check_protected_environments&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:collation&quot; taksId=&quot;collation&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;create&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:create:all&quot; taksId=&quot;all&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;drop&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:drop:_unsafe&quot; taksId=&quot;_unsafe&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:drop:all&quot; taksId=&quot;all&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:forward&quot; taksId=&quot;forward&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:load_config&quot; taksId=&quot;load_config&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:purge&quot; taksId=&quot;purge&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;purge&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:purge:all&quot; taksId=&quot;all&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:reset&quot; taksId=&quot;reset&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;test&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:clone&quot; taksId=&quot;clone&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:clone_schema&quot; taksId=&quot;clone_schema&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:clone_structure&quot; taksId=&quot;clone_structure&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:deprecated&quot; taksId=&quot;deprecated&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:load&quot; taksId=&quot;load&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:load_schema&quot; taksId=&quot;load_schema&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:load_structure&quot; taksId=&quot;load_structure&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:prepare&quot; taksId=&quot;prepare&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;db:test:purge&quot; taksId=&quot;purge&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;dev&quot;&gt;&lt;RakeTask description=&quot;Toggle development mode caching on/off&quot; fullCmd=&quot;dev:cache&quot; taksId=&quot;cache&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Generate an Entity-Relationship Diagram based on your models&quot; fullCmd=&quot;erd&quot; taksId=&quot;erd&quot; /&gt;&lt;RakeTask description=&quot;Print out all defined initializers in the order they are invoked by Rails&quot; fullCmd=&quot;initializers&quot; taksId=&quot;initializers&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;log&quot;&gt;&lt;RakeTask description=&quot;Truncates all/specified *.log files in log/ to zero bytes (specify which logs with LOGS=test,development)&quot; fullCmd=&quot;log:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Prints out your Rack middleware stack&quot; fullCmd=&quot;middleware&quot; taksId=&quot;middleware&quot; /&gt;&lt;RakeTask description=&quot;Enumerate all annotations (use notes:optimize, :fixme, :todo for focus)&quot; fullCmd=&quot;notes&quot; taksId=&quot;notes&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;notes&quot;&gt;&lt;RakeTask description=&quot;Enumerate a custom annotation, specify with ANNOTATION=CUSTOM&quot; fullCmd=&quot;notes:custom&quot; taksId=&quot;custom&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;notes:fixme&quot; taksId=&quot;fixme&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;notes:optimize&quot; taksId=&quot;optimize&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;notes:todo&quot; taksId=&quot;todo&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Remove schema information from model and fixture files&quot; fullCmd=&quot;remove_annotation&quot; taksId=&quot;remove_annotation&quot; /&gt;&lt;RakeTask description=&quot;Removes the route map from routes.rb&quot; fullCmd=&quot;remove_routes&quot; taksId=&quot;remove_routes&quot; /&gt;&lt;RakeTask description=&quot;Restart app by touching tmp/restart.txt&quot; fullCmd=&quot;restart&quot; taksId=&quot;restart&quot; /&gt;&lt;RakeTask description=&quot;Print out all defined routes in match order, with names&quot; fullCmd=&quot;routes&quot; taksId=&quot;routes&quot; /&gt;&lt;RakeTask description=&quot;Generate a cryptographically secure secret key (this is typically used to generate a secret for cookie sessions)&quot; fullCmd=&quot;secret&quot; taksId=&quot;secret&quot; /&gt;&lt;RakeTask description=&quot;Run all specs in spec directory (excluding plugin specs)&quot; fullCmd=&quot;spec&quot; taksId=&quot;spec&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;spec&quot;&gt;&lt;RakeTask description=&quot;Run the code examples in spec/controllers&quot; fullCmd=&quot;spec:controllers&quot; taksId=&quot;controllers&quot; /&gt;&lt;RakeTask description=&quot;Run the code examples in spec/features&quot; fullCmd=&quot;spec:features&quot; taksId=&quot;features&quot; /&gt;&lt;RakeTask description=&quot;Run the code examples in spec/models&quot; fullCmd=&quot;spec:models&quot; taksId=&quot;models&quot; /&gt;&lt;RakeTask description=&quot;Run the code examples in spec/routing&quot; fullCmd=&quot;spec:routing&quot; taksId=&quot;routing&quot; /&gt;&lt;RakeTask description=&quot;Run the code examples in spec/services&quot; fullCmd=&quot;spec:services&quot; taksId=&quot;services&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;spec:prepare&quot; taksId=&quot;prepare&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;spec:statsetup&quot; taksId=&quot;statsetup&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;Report code statistics (KLOCs, etc) from the application or engine&quot; fullCmd=&quot;stats&quot; taksId=&quot;stats&quot; /&gt;&lt;RakeTask description=&quot;Runs all tests in test folder&quot; fullCmd=&quot;test&quot; taksId=&quot;test&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;test&quot;&gt;&lt;RakeTask description=&quot;Run tests quickly, but also reset db&quot; fullCmd=&quot;test:db&quot; taksId=&quot;db&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:controllers&quot; taksId=&quot;controllers&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:functionals&quot; taksId=&quot;functionals&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:generators&quot; taksId=&quot;generators&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:helpers&quot; taksId=&quot;helpers&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:integration&quot; taksId=&quot;integration&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:jobs&quot; taksId=&quot;jobs&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:mailers&quot; taksId=&quot;mailers&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:models&quot; taksId=&quot;models&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:prepare&quot; taksId=&quot;prepare&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:run&quot; taksId=&quot;run&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;test:units&quot; taksId=&quot;units&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;time&quot;&gt;&lt;RakeTask description=&quot;List all time zones, list by two-letter country code (`rails time:zones[US]`), or list by UTC offset (`rails time:zones[-8]`)&quot; fullCmd=&quot;time:zones[country_or_offset]&quot; taksId=&quot;zones[country_or_offset]&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones&quot; taksId=&quot;zones&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;zones&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones:all&quot; taksId=&quot;all&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones:local&quot; taksId=&quot;local&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;time:zones:us&quot; taksId=&quot;us&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;tmp&quot;&gt;&lt;RakeTask description=&quot;Clear cache and socket files from tmp/ (narrow w/ tmp:cache:clear, tmp:sockets:clear)&quot; fullCmd=&quot;tmp:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;RakeTask description=&quot;Creates tmp directories for cache, sockets, and pids&quot; fullCmd=&quot;tmp:create&quot; taksId=&quot;create&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;cache&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp:cache:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;pids&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp:pids:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;sockets&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp:sockets:clear&quot; taksId=&quot;clear&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;default&quot; taksId=&quot;default&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;environment&quot; taksId=&quot;environment&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;erd&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;erd:generate&quot; taksId=&quot;generate&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;erd:load_models&quot; taksId=&quot;load_models&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;erd:options&quot; taksId=&quot;options&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;rails&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:template&quot; taksId=&quot;template&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;templates&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:templates:copy&quot; taksId=&quot;copy&quot; /&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:update&quot; taksId=&quot;update&quot; /&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;update&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:update:bin&quot; taksId=&quot;bin&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;rails:update:configs&quot; taksId=&quot;configs&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;railties&quot;&gt;&lt;RakeGroup description=&quot;&quot; fullCmd=&quot;&quot; taksId=&quot;install&quot;&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;railties:install:migrations&quot; taksId=&quot;migrations&quot; /&gt;&lt;/RakeGroup&gt;&lt;/RakeGroup&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;set_annotation_options&quot; taksId=&quot;set_annotation_options&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp&quot; taksId=&quot;tmp&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/cache&quot; taksId=&quot;tmp/cache&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/cache/assets&quot; taksId=&quot;tmp/cache/assets&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/pids&quot; taksId=&quot;tmp/pids&quot; /&gt;&lt;RakeTask description=&quot;&quot; fullCmd=&quot;tmp/sockets&quot; taksId=&quot;tmp/sockets&quot; /&gt;&lt;/RakeGroup&gt;&lt;/Settings&gt;</span>
<span class="gh">diff --git a/Gemfile b/Gemfile</span>
<span class="gh">index f932a45..4da1b83 100644</span>
<span class="gd">--- a/Gemfile</span>
<span class="gi">+++ b/Gemfile</span>
<span class="gu">@@ -68,7 +68,7 @@ end</span>

<span class="w"> </span>group :test do
<span class="w"> </span>  gem &#39;faker&#39;, &#39;~&gt; 1.4.3&#39;
<span class="gd">-  gem &#39;capybara&#39;, &#39;~&gt; 2.5.0&#39;</span>
<span class="gi">+  gem &#39;capybara&#39;, &#39;~&gt; 2.8&#39;</span>
<span class="w"> </span>  gem &#39;capybara-webkit&#39;
<span class="w"> </span>  gem &#39;database_cleaner&#39;, &#39;~&gt; 1.3.0&#39;
<span class="w"> </span>  gem &#39;launchy&#39;, &#39;~&gt; 2.4.2&#39;
<span class="gh">diff --git a/Gemfile.lock b/Gemfile.lock</span>
<span class="gh">index ca95700..2610cc3 100644</span>
<span class="gd">--- a/Gemfile.lock</span>
<span class="gi">+++ b/Gemfile.lock</span>
<span class="gu">@@ -61,7 +61,8 @@ GEM</span>
<span class="w"> </span>    bootstrap_form (2.5.3)
<span class="w"> </span>    builder (3.2.3)
<span class="w"> </span>    byebug (9.0.6)
<span class="gd">-    capybara (2.5.0)</span>
<span class="gi">+    capybara (2.12.0)</span>
<span class="gi">+      addressable</span>
<span class="w"> </span>      mime-types (&gt;= 1.16)
<span class="w"> </span>      nokogiri (&gt;= 1.3.3)
<span class="w"> </span>      rack (&gt;= 1.0.0)
<span class="gu">@@ -70,8 +71,8 @@ GEM</span>
<span class="w"> </span>    capybara-screenshot (1.0.14)
<span class="w"> </span>      capybara (&gt;= 1.0, &lt; 3)
<span class="w"> </span>      launchy
<span class="gd">-    capybara-webkit (1.11.1)</span>
<span class="gd">-      capybara (&gt;= 2.3.0, &lt; 2.8.0)</span>
<span class="gi">+    capybara-webkit (1.12.0)</span>
<span class="gi">+      capybara (&gt;= 2.3.0, &lt; 2.13.0)</span>
<span class="w"> </span>      json
<span class="w"> </span>    childprocess (0.5.9)
<span class="w"> </span>      ffi (~&gt; 1.0, &gt;= 1.0.11)
<span class="gu">@@ -148,7 +149,7 @@ GEM</span>
<span class="w"> </span>      thor (&gt;= 0.14, &lt; 2.0)
<span class="w"> </span>    jquery-ui-rails (5.0.5)
<span class="w"> </span>      railties (&gt;= 3.2.16)
<span class="gd">-    json (2.0.2)</span>
<span class="gi">+    json (2.0.3)</span>
<span class="w"> </span>    kaminari (0.17.0)
<span class="w"> </span>      actionpack (&gt;= 3.0.0)
<span class="w"> </span>      activesupport (&gt;= 3.0.0)
<span class="gu">@@ -320,7 +321,7 @@ DEPENDENCIES</span>
<span class="w"> </span>  bootstrap3-datetimepicker-rails
<span class="w"> </span>  bootstrap_form
<span class="w"> </span>  byebug
<span class="gd">-  capybara (~&gt; 2.5.0)</span>
<span class="gi">+  capybara (~&gt; 2.8)</span>
<span class="w"> </span>  capybara-screenshot
<span class="w"> </span>  capybara-webkit
<span class="w"> </span>  coffee-rails (~&gt; 4.2)
<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index 98acbab..effb203 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -570,6 +570,7 @@ git push heroku master</span>
<span class="w"> </span>#### Capybara
<span class="w"> </span>+ Capybaraとは
<span class="w"> </span>+ 準備作業
<span class="gi">++ 顧客アカウント更新機能のテスト</span>

<span class="w"> </span>#### 顧客アカウント新規登録・更新機能の改良
<span class="w"> </span>#### ActiveSupport::Concernによるコード共有
<span class="gh">diff --git a/baukis-kai.iml b/baukis-kai.iml</span>
<span class="gh">index 7df2722..008ed4e 100644</span>
<span class="gd">--- a/baukis-kai.iml</span>
<span class="gi">+++ b/baukis-kai.iml</span>
<span class="gu">@@ -83,6 +83,7 @@</span>
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;jbuilder (v2.6.1, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;jquery-rails (v4.2.2, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;jquery-ui-rails (v5.0.5, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="gi">+    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;json (v2.0.3, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;</span>
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;kaminari (v0.17.0, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;launchy (v2.4.3, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="w"> </span>    &lt;orderEntry type=&quot;library&quot; scope=&quot;PROVIDED&quot; name=&quot;listen (v3.0.8, rbenv: 2.4.0) [gem]&quot; level=&quot;application&quot; /&gt;
<span class="gh">diff --git a/config/locales/views/ja.yml b/config/locales/views/ja.yml</span>
<span class="gh">index 01db59a..398aa73 100644</span>
<span class="gd">--- a/config/locales/views/ja.yml</span>
<span class="gi">+++ b/config/locales/views/ja.yml</span>
<span class="gu">@@ -60,7 +60,7 @@ ja:</span>
<span class="w"> </span>        cancel: &#39;キャンセル&#39;
<span class="w"> </span>      edit:
<span class="w"> </span>        title: &#39;顧客アカウントの編集&#39;
<span class="gd">-        update: &#39;登録&#39;</span>
<span class="gi">+        update: &#39;更新&#39;</span>
<span class="w"> </span>        cancel: &#39;キャンセル&#39;
<span class="w"> </span>    accounts:
<span class="w"> </span>      show:
<span class="gh">diff --git a/spec/features/staff/customer_nanagement_spec.rb b/spec/features/staff/customer_nanagement_spec.rb</span>
new file mode 100644
<span class="gh">index 0000000..fc8c27b</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/spec/features/staff/customer_nanagement_spec.rb</span>
<span class="gu">@@ -0,0 +1,34 @@</span>
<span class="gi">+require &#39;rails_helper&#39;</span>
<span class="gi">+</span>
<span class="gi">+# 職員による顧客管理</span>
<span class="gi">+feature &#39;Customer management by staff&#39; do</span>
<span class="gi">+  include FeaturesSpecHelper</span>
<span class="gi">+  let(:staff_member) { create(:staff_member) }</span>
<span class="gi">+  let!(:customer) { create(:customer) }</span>
<span class="gi">+</span>
<span class="gi">+  before do</span>
<span class="gi">+    switch_namespace(:staff)</span>
<span class="gi">+    login_as_staff_member(staff_member)</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  # 職員が顧客、自宅住所、勤務先を更新する</span>
<span class="gi">+  scenario &#39;Staff update customer, home address, work place&#39; do</span>
<span class="gi">+    click_link I18n.t(&#39;staff.top.dashboard.staff_customers&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    first(&#39;table.Table__body--listing&#39;).click_link I18n.t(&#39;staff.customers.index.edit&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    fill_in I18n.t(&#39;activerecord.attributes.customer.email&#39;), with: &#39;test@example.jp&#39;</span>
<span class="gi">+    within(&#39;fieldset#home-address-fields&#39;) do</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.home_address.postal_code&#39;), with: &#39;99999999&#39;</span>
<span class="gi">+    end</span>
<span class="gi">+    within(&#39;fieldset#work-address-fields&#39;) do</span>
<span class="gi">+      fill_in I18n.t(&#39;activerecord.attributes.work_address.company_name&#39;), with: &#39;テスト&#39;</span>
<span class="gi">+    end</span>
<span class="gi">+    click_button I18n.t(&#39;staff.customers.edit.update&#39;)</span>
<span class="gi">+</span>
<span class="gi">+    customer.reload</span>
<span class="gi">+    expect(customer.email).to eq(&#39;test@example.jp&#39;)</span>
<span class="gi">+    expect(customer.home_address.postal_code).to eq(&#39;99999999&#39;)</span>
<span class="gi">+    expect(customer.work_address.company_name).to eq(&#39;テスト&#39;)</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
\ No newline at end of file
<span class="gh">diff --git a/spec/rails_helper.rb b/spec/rails_helper.rb</span>
<span class="gh">index 975dc23..8e3f5b2 100644</span>
<span class="gd">--- a/spec/rails_helper.rb</span>
<span class="gi">+++ b/spec/rails_helper.rb</span>
<span class="gu">@@ -22,6 +22,8 @@ require &#39;rspec/rails&#39;</span>
<span class="w"> </span>#
<span class="w"> </span>Dir[Rails.root.join(&#39;spec/support/**/*.rb&#39;)].each { |f| require f }

<span class="gi">+Capybara.javascript_driver = :webkit</span>
<span class="gi">+</span>
<span class="w"> </span># Checks for pending migration and applies them before tests are run.
<span class="w"> </span># If you are not using ActiveRecord, you can remove this line.
<span class="w"> </span>ActiveRecord::Migration.maintain_test_schema!
<span class="gh">diff --git a/spec/support/features_spec_helper.rb b/spec/support/features_spec_helper.rb</span>
<span class="gh">index d993975..54314d5 100644</span>
<span class="gd">--- a/spec/support/features_spec_helper.rb</span>
<span class="gi">+++ b/spec/support/features_spec_helper.rb</span>
<span class="gu">@@ -1,12 +1,12 @@</span>
<span class="w"> </span>module FeaturesSpecHelper
<span class="gd">-  def swith_namespace(namespace)</span>
<span class="gi">+  def switch_namespace(namespace)</span>
<span class="w"> </span>    config = Rails.application.config.baukis_kai
<span class="gd">-    Capybara.app_host = &#39;http://&#39; + config[:namespace][:host]</span>
<span class="gi">+    Capybara.app_host = &#39;http://&#39; + config[namespace][:host]</span>
<span class="w"> </span>  end

<span class="w"> </span>  def login_as_staff_member(staff_member, password = &#39;pw&#39;)
<span class="w"> </span>    visit staff_login_path
<span class="gd">-    within(&#39;#Login--staff&#39;) do</span>
<span class="gi">+    within(&#39;.Login--staff&#39;) do</span>
<span class="w"> </span>      fill_in I18n.t(&#39;activemodel.attributes.staff/login_form.email&#39;), with: staff_member.email
<span class="w"> </span>      fill_in I18n.t(&#39;activemodel.attributes.staff/login_form.password&#39;), with: password
<span class="w"> </span>      click_button I18n.t(&#39;staff.sessions.new.submit&#39;)
</code></pre></div>
<h2 id="ce1c09a">コミット: ce1c09a<a class="headerlink" href="#ce1c09a" title="Permanent link">&para;</a></h2>
<h3 id="_69">メッセージ<a class="headerlink" href="#_69" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>準備作業 #14
</code></pre></div>
<h3 id="_70">変更されたファイル<a class="headerlink" href="#_70" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
<li>M spec/factories/addresses.rb</li>
<li>M spec/factories/customers.rb</li>
<li>A spec/support/features_spec_helper.rb</li>
</ul>
<h3 id="_71">変更内容<a class="headerlink" href="#_71" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit ce1c09aab7f7c9217b5e2db416b4b7e0ebef5805
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 13:19:39 2017 +0900

<span class="w"> </span>   準備作業 #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index fb9bb3f..98acbab 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -568,6 +568,9 @@ git push heroku master</span>

<span class="w"> </span>### Capybara
<span class="w"> </span>#### Capybara
<span class="gi">++ Capybaraとは</span>
<span class="gi">++ 準備作業</span>
<span class="gi">+</span>
<span class="w"> </span>#### 顧客アカウント新規登録・更新機能の改良
<span class="w"> </span>#### ActiveSupport::Concernによるコード共有

<span class="gh">diff --git a/spec/factories/addresses.rb b/spec/factories/addresses.rb</span>
<span class="gh">index 8b961d6..2a866b7 100644</span>
<span class="gd">--- a/spec/factories/addresses.rb</span>
<span class="gi">+++ b/spec/factories/addresses.rb</span>
<span class="gu">@@ -22,7 +22,21 @@</span>
<span class="w"> </span>#

<span class="w"> </span>FactoryGirl.define do
<span class="gd">-  factory :address do</span>
<span class="gd">-    </span>
<span class="gi">+  factory :home_address do</span>
<span class="gi">+    postal_code &#39;10000000&#39;</span>
<span class="gi">+    prefecture &#39;東京都&#39;</span>
<span class="gi">+    city &#39;千代田区&#39;</span>
<span class="gi">+    address1 &#39;試験1-1-1&#39;</span>
<span class="gi">+    address2 &#39;&#39;</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  factory :work_address do</span>
<span class="gi">+    company_name &#39;テスト&#39;</span>
<span class="gi">+    division_name &#39;開発部&#39;</span>
<span class="gi">+    postal_code &#39;10500000&#39;</span>
<span class="gi">+    prefecture &#39;東京都&#39;</span>
<span class="gi">+    city &#39;港区&#39;</span>
<span class="gi">+    address1 &#39;試験1-1-1&#39;</span>
<span class="gi">+    address2 &#39;&#39;</span>
<span class="w"> </span>  end
<span class="w"> </span>end
<span class="gh">diff --git a/spec/factories/customers.rb b/spec/factories/customers.rb</span>
<span class="gh">index 98d55fd..9cec838 100644</span>
<span class="gd">--- a/spec/factories/customers.rb</span>
<span class="gi">+++ b/spec/factories/customers.rb</span>
<span class="gu">@@ -23,6 +23,15 @@</span>

<span class="w"> </span>FactoryGirl.define do
<span class="w"> </span>  factory :customer do
<span class="gd">-    </span>
<span class="gi">+    sequence(:email) { |n| &quot;member#{n}@example.jp&quot;}</span>
<span class="gi">+    family_name &#39;山田&#39;</span>
<span class="gi">+    given_name &#39;太郎&#39;</span>
<span class="gi">+    family_name_kana &#39;ヤマダ&#39;</span>
<span class="gi">+    given_name_kana &#39;タロウ&#39;</span>
<span class="gi">+    password &#39;pw&#39;</span>
<span class="gi">+    birthday Date.new(1970,1,1)</span>
<span class="gi">+    gender &#39;male&#39;</span>
<span class="gi">+    association :home_address, strategy: :build</span>
<span class="gi">+    association :work_address, strategy: :build</span>
<span class="w"> </span>  end
<span class="w"> </span>end
<span class="gh">diff --git a/spec/support/features_spec_helper.rb b/spec/support/features_spec_helper.rb</span>
new file mode 100644
<span class="gh">index 0000000..d993975</span>
<span class="gd">--- /dev/null</span>
<span class="gi">+++ b/spec/support/features_spec_helper.rb</span>
<span class="gu">@@ -0,0 +1,15 @@</span>
<span class="gi">+module FeaturesSpecHelper</span>
<span class="gi">+  def swith_namespace(namespace)</span>
<span class="gi">+    config = Rails.application.config.baukis_kai</span>
<span class="gi">+    Capybara.app_host = &#39;http://&#39; + config[:namespace][:host]</span>
<span class="gi">+  end</span>
<span class="gi">+</span>
<span class="gi">+  def login_as_staff_member(staff_member, password = &#39;pw&#39;)</span>
<span class="gi">+    visit staff_login_path</span>
<span class="gi">+    within(&#39;#Login--staff&#39;) do</span>
<span class="gi">+      fill_in I18n.t(&#39;activemodel.attributes.staff/login_form.email&#39;), with: staff_member.email</span>
<span class="gi">+      fill_in I18n.t(&#39;activemodel.attributes.staff/login_form.password&#39;), with: password</span>
<span class="gi">+      click_button I18n.t(&#39;staff.sessions.new.submit&#39;)</span>
<span class="gi">+    end</span>
<span class="gi">+  end</span>
<span class="gi">+end</span>
\ No newline at end of file
</code></pre></div>
<h2 id="a15c7f3">コミット: a15c7f3<a class="headerlink" href="#a15c7f3" title="Permanent link">&para;</a></h2>
<h3 id="_72">メッセージ<a class="headerlink" href="#_72" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Capybara #14
</code></pre></div>
<h3 id="_73">変更されたファイル<a class="headerlink" href="#_73" title="Permanent link">&para;</a></h3>
<ul>
<li>M README.md</li>
</ul>
<h3 id="_74">変更内容<a class="headerlink" href="#_74" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>commit a15c7f3653a460a2fdec8b7fb9c317b21e5228e0
Author: k2works &lt;kakimomokuri@gmail.com&gt;
Date:   Mon Feb 6 12:59:23 2017 +0900

<span class="w"> </span>   Capybara #14

<span class="gh">diff --git a/README.md b/README.md</span>
<span class="gh">index ef5ff0b..fb9bb3f 100644</span>
<span class="gd">--- a/README.md</span>
<span class="gi">+++ b/README.md</span>
<span class="gu">@@ -567,6 +567,10 @@ git push heroku master</span>
<span class="w"> </span>+ destroyアクションの実装

<span class="w"> </span>### Capybara
<span class="gi">+#### Capybara</span>
<span class="gi">+#### 顧客アカウント新規登録・更新機能の改良</span>
<span class="gi">+#### ActiveSupport::Concernによるコード共有</span>
<span class="gi">+</span>
<span class="w"> </span>### フォームオブジェクト
<span class="w"> </span>### 検索フォーム
<span class="w"> </span>**[⬆ back to top](#構成)**
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works/baukis-kai" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>